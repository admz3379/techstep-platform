<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TechStep - Complete Cybersecurity Training Platform with Payment System</title>
    <meta name="description" content="From Beginner to Cybersecurity Professional in 6 Months - TechStep Training Platform">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://js.stripe.com/v3/"></script>
    <script src="https://www.paypal.com/sdk/js?client-id=YOUR_PAYPAL_CLIENT_ID&currency=USD&components=buttons,marks"></script>
    <style>
        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }
        
        .logo-icon::before {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            background: linear-gradient(45deg, #60a5fa 0%, #3b82f6 100%);
            border-radius: 4px;
            transform: rotate(45deg);
        }
        
        .logo-icon::after {
            content: '';
            position: absolute;
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 2px;
            z-index: 2;
        }
        
        .logo-text {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.5px;
        }

        .hero-bg {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
        }
        
        .stats-card {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.2);
            backdrop-filter: blur(10px);
        }
        
        .payment-plan-option input[type="radio"]:checked + .payment-option-card {
            border-color: #3b82f6 !important;
            background-color: rgba(59, 130, 246, 0.2) !important;
        }
        
        .payment-plan-option input[type="radio"]:checked + .payment-option-card .option-check {
            opacity: 1 !important;
        }
        
        .payment-option-card {
            transition: all 0.3s ease;
        }
        
        .course-selection {
            background: rgba(31, 41, 55, 0.6);
            border: 1px solid rgba(75, 85, 99, 0.3);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        
        .course-selection:hover {
            background: rgba(59, 130, 246, 0.1);
            border-color: rgba(59, 130, 246, 0.3);
        }
        
        .course-checkbox:checked + .course-selection {
            background: rgba(59, 130, 246, 0.2);
            border-color: #3b82f6;
        }
        
        /* Mobile-friendly touch targets and interactions */
        @media (max-width: 768px) {
            .add-to-cart-btn {
                min-height: 48px;
                font-size: 16px;
                touch-action: manipulation;
                -webkit-tap-highlight-color: rgba(0, 0, 0, 0.2);
            }
            
            .payment-plan-option {
                min-height: 60px;
                touch-action: manipulation;
            }
            
            .payment-option-card {
                padding: 16px;
                border-width: 2px;
            }
            
            /* Ensure modal content is scrollable on mobile */
            .modal-content {
                max-height: 90vh;
                overflow-y: auto;
                -webkit-overflow-scrolling: touch;
            }
            
            /* Larger touch targets for checkboxes on mobile */
            input[type="checkbox"] {
                min-width: 20px;
                min-height: 20px;
            }
            
            /* Better spacing for mobile navigation */
            #mobileCoursesDropdown {
                padding: 8px 0;
            }
            
            #mobileCoursesDropdown a {
                min-height: 44px;
                display: flex;
                align-items: center;
            }
        }
        
        .course-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        
        .course-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(59, 130, 246, 0.3);
        }
        
        .mentor-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        
        .mentor-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.08);
        }
        
        .testimonial-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        
        .testimonial-card:hover {
            transform: translateY(-3px);
            background: rgba(255, 255, 255, 0.08);
        }
        
        .career-pro-card {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(29, 78, 216, 0.1) 100%);
            border: 1px solid rgba(59, 130, 246, 0.2);
            backdrop-filter: blur(10px);
        }
        
        .course-selection {
            opacity: 0.7;
            transition: all 0.3s ease;
        }
        
        .course-selection.selected {
            opacity: 1;
            transform: scale(1.02);
            border-color: rgba(59, 130, 246, 0.5);
        }
        
        .mentor-booking {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .mentor-booking.show {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            backdrop-filter: blur(4px);
        }

        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: linear-gradient(135deg, #1f2937 0%, #374151 100%);
            border-radius: 20px;
            padding: 2rem;
            width: 90%;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            transform: scale(0.9) translateY(20px);
            transition: all 0.3s ease;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        .modal-overlay.show .modal-content {
            transform: scale(1) translateY(0);
        }

        /* Dashboard Styles */
        .dashboard-progress-bar {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            overflow: hidden;
            height: 12px;
        }

        .dashboard-progress-fill {
            height: 100%;
            border-radius: 12px;
            transition: width 1.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            background: linear-gradient(90deg, #3b82f6, #60a5fa);
        }

        .dashboard-action-btn {
            padding: 1rem 1.5rem;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-align: center;
            cursor: pointer;
            border: none;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .dashboard-action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .btn-continue {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
        }

        .btn-schedule {
            background: linear-gradient(135deg, #10b981, #047857);
        }

        .btn-certificates {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
        }

        .btn-podcast {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }

        .session-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1rem;
            transition: all 0.3s ease;
        }

        .session-card:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-2px);
        }

        .welcome-text {
            background: linear-gradient(135deg, #60a5fa, #3b82f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Payment Agreement Styles */
        .agreement-content {
            max-height: 60vh;
            overflow-y: auto;
            padding-right: 10px;
        }

        .agreement-content::-webkit-scrollbar {
            width: 6px;
        }

        .agreement-content::-webkit-scrollbar-track {
            background: #374151;
            border-radius: 3px;
        }

        .agreement-content::-webkit-scrollbar-thumb {
            background: #6b7280;
            border-radius: 3px;
        }

        .agreement-content::-webkit-scrollbar-thumb:hover {
            background: #9ca3af;
        }

        .agreement-text h4,
        .agreement-text h5 {
            color: #f3f4f6;
        }

        .agreement-text strong {
            color: #60a5fa;
        }

        .payment-plan-locked {
            opacity: 0.5;
            pointer-events: none;
        }

        /* Notification Styles */
        .notification {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 9999;
            padding: 1rem 1.5rem;
            border-radius: 0.5rem;
            color: white;
            font-weight: 500;
            max-width: 400px;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: linear-gradient(135deg, #10b981, #047857);
        }

        .notification.error {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }

        .notification.warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }

        .notification.info {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
        }

        /* Payment Button Styles */
        .payment-button {
            width: 100%;
            padding: 12px 16px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            border: none;
            cursor: pointer;
        }

        .payment-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .stripe-button {
            background: linear-gradient(135deg, #635bff, #4c46d6);
            color: white;
        }

        .apple-pay-button {
            background: #000;
            color: white;
        }

        .google-pay-button {
            background: #4285f4;
            color: white;
        }

        /* Payment Plan Agreement Specific Styles */
        .payment-plan-agreement {
            z-index: 1100;
        }

        .agreement-section {
            margin-bottom: 1.5rem;
        }

        .agreement-highlight {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 8px;
            padding: 1rem;
        }

        .agreement-warning {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 8px;
            padding: 1rem;
        }

        .agreement-info {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid rgba(245, 158, 11, 0.3);
            border-radius: 8px;
            padding: 1rem;
        }
        
        /* User Media Integration Styles */
        .hero-bg {
            position: relative;
            background: linear-gradient(135deg, #1e3a8a 0%, #7c3aed 100%);
        }
        
        .user-video-container {
            position: relative;
            border: 2px solid #3b82f6;
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .user-video-container:hover {
            border-color: #60a5fa;
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
        }
        
        .video-fallback {
            background: linear-gradient(135deg, #374151 0%, #1f2937 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 200px;
        }
    </style>
</head>
<body class="bg-gray-900 text-white">
    <!-- Navigation -->
    <nav class="bg-gray-800 shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="logo-container">
                    <div class="logo-icon"></div>
                    <span class="logo-text">TechStep</span>
                </div>
                <div class="hidden md:flex items-center space-x-8">
                    <div class="relative group">
                        <button class="text-gray-300 hover:text-blue-400 transition duration-300 flex items-center">
                            Courses
                            <i class="fas fa-chevron-down ml-1 text-xs"></i>
                        </button>
                        <div class="absolute top-full left-0 mt-2 w-72 bg-gray-800 rounded-lg shadow-xl border border-gray-700 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 z-50">
                            <div class="p-2">
                                <a href="#courses" class="block px-4 py-3 text-gray-300 hover:text-blue-400 hover:bg-gray-700 rounded-lg transition duration-300">
                                    <i class="fas fa-shield-alt mr-3 text-blue-400"></i>Cybersecurity Operations
                                </a>
                                <a href="#courses" class="block px-4 py-3 text-gray-300 hover:text-blue-400 hover:bg-gray-700 rounded-lg transition duration-300">
                                    <i class="fas fa-lock mr-3 text-green-400"></i>Information Security
                                </a>
                                <a href="#courses" class="block px-4 py-3 text-gray-300 hover:text-blue-400 hover:bg-gray-700 rounded-lg transition duration-300">
                                    <i class="fas fa-search mr-3 text-purple-400"></i>Cybersecurity Intelligence
                                </a>
                                <a href="#courses" class="block px-4 py-3 text-gray-300 hover:text-blue-400 hover:bg-gray-700 rounded-lg transition duration-300">
                                    <i class="fas fa-balance-scale mr-3 text-red-400"></i>Cybersecurity Risk
                                </a>
                                <div class="border-t border-gray-700 mt-2 pt-2">
                                    <a href="demo/" class="block px-4 py-3 text-blue-400 hover:text-white hover:bg-blue-600 rounded-lg transition duration-300 font-semibold">
                                        <i class="fas fa-play mr-3"></i>Try Free Demo
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <a href="#mentors" class="text-gray-300 hover:text-blue-400 transition duration-300">Mentors</a>
                    <a href="#podcast" class="text-gray-300 hover:text-blue-400 transition duration-300">Podcast</a>
                    <a href="#testimonials" class="text-gray-300 hover:text-blue-400 transition duration-300">Reviews</a>
                    <button onclick="window.location.href='demo/'" class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-2 rounded-lg hover:from-blue-700 hover:to-purple-700 transition duration-300">
                        <i class="fas fa-play mr-2"></i>Free Demo
                    </button>
                    <button id="adminLoginBtn" class="bg-gray-600 text-white px-6 py-2 rounded-lg hover:bg-gray-700 transition duration-300">
                        <i class="fas fa-lock mr-2"></i>Mentee Login
                    </button>
                </div>
                <div class="md:hidden">
                    <button id="mobileMenuBtn" class="text-gray-300 hover:text-white">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile Menu (Hidden by default) -->
        <div id="mobileMenu" class="md:hidden bg-gray-700 border-t border-gray-600 hidden">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <!-- Mobile Courses Dropdown -->
                <div class="relative">
                    <button onclick="toggleMobileCourses()" class="flex items-center justify-between w-full px-3 py-2 text-gray-300 hover:text-blue-400 hover:bg-gray-600 rounded-md transition duration-300">
                        <span>Courses</span>
                        <i class="fas fa-chevron-down text-xs" id="mobileCourseChevron"></i>
                    </button>
                    <div id="mobileCoursesDropdown" class="hidden mt-1 ml-4 space-y-1">
                        <a href="#courses" class="block px-3 py-2 text-sm text-gray-400 hover:text-blue-400 hover:bg-gray-600 rounded-md transition duration-300">
                            <i class="fas fa-shield-alt mr-2 text-blue-400"></i>Cybersecurity Operations
                        </a>
                        <a href="#courses" class="block px-3 py-2 text-sm text-gray-400 hover:text-blue-400 hover:bg-gray-600 rounded-md transition duration-300">
                            <i class="fas fa-lock mr-2 text-green-400"></i>Information Security
                        </a>
                        <a href="#courses" class="block px-3 py-2 text-sm text-gray-400 hover:text-blue-400 hover:bg-gray-600 rounded-md transition duration-300">
                            <i class="fas fa-search mr-2 text-purple-400"></i>Cybersecurity Intelligence
                        </a>
                        <a href="#courses" class="block px-3 py-2 text-sm text-gray-400 hover:text-blue-400 hover:bg-gray-600 rounded-md transition duration-300">
                            <i class="fas fa-balance-scale mr-2 text-red-400"></i>Cybersecurity Risk
                        </a>
                    </div>
                </div>
                <a href="#mentors" class="block px-3 py-2 text-gray-300 hover:text-blue-400 hover:bg-gray-600 rounded-md transition duration-300">Mentors</a>
                <a href="#podcast" class="block px-3 py-2 text-gray-300 hover:text-blue-400 hover:bg-gray-600 rounded-md transition duration-300">Podcast</a>
                <a href="#testimonials" class="block px-3 py-2 text-gray-300 hover:text-blue-400 hover:bg-gray-600 rounded-md transition duration-300">Reviews</a>
                <button onclick="window.location.href='demo/'" class="block w-full text-left px-3 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-md hover:from-blue-700 hover:to-purple-700 transition duration-300 mt-2">
                    <i class="fas fa-play mr-2"></i>Free Demo
                </button>
                <button id="mobileAdminLoginBtn" class="block w-full text-left px-3 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition duration-300 mt-2">
                    <i class="fas fa-lock mr-2"></i>Mentee Login
                </button>
            </div>
        </div>
    </nav>

    <!-- Dashboard Modal -->
    <div id="dashboardModal" class="modal-overlay" style="display: none !important;">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h2 class="text-3xl font-bold welcome-text">Welcome back, Alex!</h2>
                    <p class="text-gray-300 mt-1">Continue your cybersecurity journey</p>
                </div>
                <button id="closeModal" class="text-gray-400 hover:text-white text-2xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="grid lg:grid-cols-3 gap-6">
                <!-- Learning Progress Section -->
                <div class="lg:col-span-2">
                    <div class="bg-gray-800 rounded-lg p-6 mb-6">
                        <h3 class="text-xl font-semibold mb-4 flex items-center">
                            <i class="fas fa-chart-line text-blue-400 mr-2"></i>
                            Learning Progress
                        </h3>
                        
                        <div class="space-y-4">
                            <div>
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-gray-300">SOC Analyst Foundations</span>
                                    <span class="text-blue-400 font-semibold">75%</span>
                                </div>
                                <div class="dashboard-progress-bar">
                                    <div class="dashboard-progress-fill" data-progress="75" style="width: 0%"></div>
                                </div>
                                <p class="text-xs text-gray-400 mt-1">12 of 16 modules completed</p>
                            </div>

                            <div>
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-gray-300">GRC Essentials</span>
                                    <span class="text-blue-400 font-semibold">45%</span>
                                </div>
                                <div class="dashboard-progress-bar">
                                    <div class="dashboard-progress-fill" data-progress="45" style="width: 0%"></div>
                                </div>
                                <p class="text-xs text-gray-400 mt-1">9 of 20 modules completed</p>
                            </div>

                            <div>
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-gray-300">Cloud Security Fundamentals</span>
                                    <span class="text-blue-400 font-semibold">20%</span>
                                </div>
                                <div class="dashboard-progress-bar">
                                    <div class="dashboard-progress-fill" data-progress="20" style="width: 0%"></div>
                                </div>
                                <p class="text-xs text-gray-400 mt-1">3 of 15 modules completed</p>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="grid grid-cols-2 gap-4">
                        <button class="dashboard-action-btn btn-continue">
                            <i class="fas fa-play"></i>
                            Continue Learning
                        </button>
                        <button class="dashboard-action-btn btn-schedule">
                            <i class="fas fa-calendar-plus"></i>
                            Schedule Session
                        </button>
                        <button class="dashboard-action-btn btn-certificates">
                            <i class="fas fa-certificate"></i>
                            View Certificates
                        </button>
                        <button class="dashboard-action-btn btn-podcast">
                            <i class="fas fa-podcast"></i>
                            Latest Podcast
                        </button>
                    </div>
                </div>

                <!-- Upcoming Sessions Section -->
                <div>
                    <div class="bg-gray-800 rounded-lg p-6">
                        <h3 class="text-xl font-semibold mb-4 flex items-center">
                            <i class="fas fa-calendar text-green-400 mr-2"></i>
                            Upcoming Sessions
                        </h3>
                        
                        <div class="space-y-3">
                            <div class="session-card">
                                <div class="flex items-center mb-2">
                                    <img src="https://www.shutterstock.com/image-photo/closeup-headshot-face-portrait-beautiful-260nw-2491646077.jpg" 
                                         alt="Dr. Rebecca Chen" class="w-10 h-10 rounded-full mr-3 object-cover">
                                    <div>
                                        <h4 class="font-semibold text-sm">Dr. Rebecca Chen</h4>
                                        <p class="text-xs text-gray-400">SOC Strategy Review</p>
                                    </div>
                                </div>
                                <div class="text-xs text-blue-400 flex items-center">
                                    <i class="fas fa-clock mr-1"></i>
                                    Tomorrow, 2:00 PM EST
                                </div>
                                <div class="text-xs text-gray-400 mt-1">60 minutes • Virtual</div>
                            </div>

                            <div class="session-card">
                                <div class="flex items-center mb-2">
                                    <img src="https://www.shutterstock.com/image-photo/cheerful-handsome-young-african-man-260nw-2432719403.jpg" 
                                         alt="Marcus Johnson" class="w-10 h-10 rounded-full mr-3 object-cover">
                                    <div>
                                        <h4 class="font-semibold text-sm">Marcus Johnson</h4>
                                        <p class="text-xs text-gray-400">GRC Deep Dive</p>
                                    </div>
                                </div>
                                <div class="text-xs text-blue-400 flex items-center">
                                    <i class="fas fa-clock mr-1"></i>
                                    Friday, 10:00 AM EST
                                </div>
                                <div class="text-xs text-gray-400 mt-1">90 minutes • Virtual</div>
                            </div>

                            <div class="session-card opacity-60">
                                <div class="flex items-center mb-2">
                                    <img src="https://www.shutterstock.com/image-photo/successful-indian-authoritative-confident-young-260nw-2274331045.jpg" 
                                         alt="David Thompson" class="w-10 h-10 rounded-full mr-3 object-cover">
                                    <div>
                                        <h4 class="font-semibold text-sm">David Thompson</h4>
                                        <p class="text-xs text-gray-400">Cloud Security Basics</p>
                                    </div>
                                </div>
                                <div class="text-xs text-gray-400 flex items-center">
                                    <i class="fas fa-clock mr-1"></i>
                                    Next Week • TBD
                                </div>
                                <div class="text-xs text-gray-400 mt-1">Pending scheduling</div>
                            </div>
                        </div>

                        <button class="w-full mt-4 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg transition duration-300 text-sm">
                            <i class="fas fa-plus mr-2"></i>Book New Session
                        </button>
                    </div>

                    <!-- Recent Activity -->
                    <div class="bg-gray-800 rounded-lg p-6 mt-6">
                        <h3 class="text-lg font-semibold mb-3 flex items-center">
                            <i class="fas fa-history text-purple-400 mr-2"></i>
                            Recent Activity
                        </h3>
                        
                        <div class="space-y-2 text-sm">
                            <div class="flex items-center justify-between">
                                <span class="text-gray-300">Completed: SIEM Logs Analysis</span>
                                <span class="text-xs text-gray-400">2 hours ago</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-gray-300">Started: Risk Assessment Lab</span>
                                <span class="text-xs text-gray-400">1 day ago</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-gray-300">Earned: SOC Analyst Badge</span>
                                <span class="text-xs text-gray-400">3 days ago</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Trial App Container -->

    <!-- Hero Section -->
    <section class="hero-bg py-20 relative overflow-hidden">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center relative z-10">
            <h1 class="text-5xl md:text-6xl font-bold mb-6">
                Accelerate Your <span class="text-blue-400">Cybersecurity Career</span>
            </h1>
            <p class="text-xl text-gray-300 mb-8 max-w-3xl mx-auto">
                Master cybersecurity through expert-led training, hands-on labs, and personalized mentoring. From SOC Analyst to GRC Expert — we'll guide you every step of the way. All backgrounds welcome. No experience required. 
            </p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center mb-12">
                <button id="mainProgramBtn" class="bg-blue-600 text-white px-8 py-4 rounded-lg text-lg font-semibold hover:bg-blue-700 transition duration-300 transform hover:scale-105">
                    <i class="fas fa-graduation mr-2"></i>From Beginner to Cybersecurity Professional in 6 Months
                </button>
                <button onclick="window.location.href='demo/'" class="border border-blue-400 text-blue-400 px-8 py-4 rounded-lg text-lg font-semibold hover:bg-blue-600 hover:text-white transition duration-300">
                    <i class="fas fa-play mr-2"></i>Try Free Demo
                </button>
            </div>
            
            <!-- Stats -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-6 max-w-4xl mx-auto">
                <div class="stats-card p-6 rounded-lg text-center">
                    <div class="text-3xl font-bold mb-2">100+</div>
                    <div class="text-gray-200">Students Trained</div>
                </div>
                <div class="stats-card p-6 rounded-lg text-center">
                    <div class="text-3xl font-bold mb-2">92%</div>
                    <div class="text-gray-200">Certification Pass Rate</div>
                </div>
                <div class="stats-card p-6 rounded-lg text-center">
                    <div class="text-3xl font-bold mb-2">15+</div>
                    <div class="text-gray-200">Industry Courses</div>
                </div>
                <div class="stats-card p-6 rounded-lg text-center">
                    <div class="text-3xl font-bold mb-2">24/7</div>
                    <div class="text-gray-200">Support Available</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Interactive Course Selection -->
    <section id="courses" class="py-20 bg-gray-800">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-4xl font-bold mb-4">Choose Your Learning Path</h2>
                <p class="text-xl text-gray-300 max-w-3xl mx-auto">
                    Select from our comprehensive cybersecurity courses. Choose self-paced learning or add live mentor support.
                </p>
            </div>

            <!-- Learning Type Selector -->
            <div class="bg-gray-700 p-6 rounded-lg mb-8 max-w-2xl mx-auto">
                <h3 class="text-xl font-semibold mb-4 text-center">Select Learning Type</h3>
                <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
                    <div class="flex items-center gap-3">
                        <input type="radio" id="self-paced" name="learning-type" value="self-paced" checked 
                               class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500">
                        <label for="self-paced" class="text-lg">Self-Paced Learning</label>
                    </div>
                    <div class="flex items-center gap-3">
                        <input type="radio" id="with-mentor" name="learning-type" value="with-mentor"
                               class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500">
                        <label for="with-mentor" class="text-lg">With Live Mentor</label>
                    </div>
                </div>
            </div>

            <!-- Courses Grid -->
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 mb-8">
                <!-- SOC Analyst Course -->
                <div class="course-card p-6 rounded-lg course-selection" data-course="soc-analyst" 
                     data-full-price="2849" 
                     data-down-payment="750" 
                     data-monthly-payment="375"
                     data-stripe-full-price="price_1S5j8SHdhxmQz9FjYDWLFpyd"
                     data-stripe-down-price="price_1S5j8SHdhxmQz9FjK5KQc0HG"
                     data-stripe-monthly-price="price_1S5j8SHdhxmQz9FjxZR4DjJS">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-xl font-semibold">SOC Analyst Foundations</h3>
                        <span class="bg-blue-600 text-white text-sm px-3 py-1 rounded-full">Foundation Level</span>
                    </div>
                    <p class="text-gray-300 mb-4">Master security operations center fundamentals, threat detection, and incident response procedures.</p>
                    <div class="price-display">
                        <div class="pricing-options space-y-2">
                            <div class="full-pay-option">
                                <div class="text-2xl font-bold text-green-400">$2,849 <span class="text-sm font-normal text-green-300">(Best Value - 5% off)</span></div>
                                <div class="text-sm text-gray-400">One-time payment • Full course access</div>
                            </div>
                            <div class="monthly-plan-option mt-2">
                                <div class="text-xl font-bold text-blue-400">$750 down + $375/month</div>
                                <div class="text-sm text-gray-400">6 monthly payments • Start today</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Enroll Button -->
                    <div class="mt-4">
                        <button class="enroll-btn w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300" 
                                data-course-id="soc-analyst" 
                                data-course-name="SOC Analyst Foundations" 
                                data-price="2849"
                                onclick="startEnrollment('soc-analyst', 'SOC Analyst Foundations', 2849)">
                            <i class="fas fa-graduation-cap mr-2"></i>Enroll Now
                        </button>
                    </div>
                    

                </div>

                <!-- Threat Detection Course -->
                <div class="course-card p-6 rounded-lg course-selection" data-course="threat-detection">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-xl font-semibold">Cyber Threat Analyst & Incident Response</h3>
                        <span class="bg-orange-600 text-white text-sm px-3 py-1 rounded-full">Intermediate</span>
                    </div>
                    <p class="text-gray-300 mb-4">Advanced threat hunting, malware analysis, and comprehensive incident response strategies.</p>
                    <div class="price-display">
                        <div class="self-paced-price text-2xl font-bold text-blue-400">$2,999</div>
                        <div class="mentor-price text-2xl font-bold text-blue-400 hidden">$4,999</div>
                    </div>
                    <div class="text-sm text-gray-400 mt-2">
                        <div class="self-paced-desc">Self-paced learning decks, labs, virtual internship & certificate</div>
                        <div class="mentor-desc hidden">Includes live mentor sessions</div>
                    </div>
                    <!-- Enroll Button -->
                    <div class="mt-4">
                        <button class="enroll-btn w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300" 
                                data-course-id="threat-detection" 
                                data-course-name="Cyber Threat Analyst & Incident Response" 
                                data-price="2999"
                                onclick="startEnrollment('threat-detection', 'Cyber Threat Analyst & Incident Response', 2999)">
                            <i class="fas fa-graduation-cap mr-2"></i>Enroll Now
                        </button>
                    </div>
                </div>

                <!-- Splunk Course -->
                <div class="course-card p-6 rounded-lg course-selection" data-course="splunk-siem">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-xl font-semibold">SIEM Engineering - Splunk Specialization</h3>
                        <span class="bg-purple-600 text-white text-sm px-3 py-1 rounded-full">Advanced</span>
                    </div>
                    <p class="text-gray-300 mb-4">Master Splunk administration, SIEM deployment, and security monitoring infrastructure.</p>
                    <div class="price-display">
                        <div class="self-paced-price text-2xl font-bold text-blue-400">$2,999</div>
                        <div class="mentor-price text-2xl font-bold text-blue-400 hidden">$4,999</div>
                    </div>
                    <div class="text-sm text-gray-400 mt-2">
                        <div class="self-paced-desc">Self-paced learning decks, labs, virtual internship & certificate</div>
                        <div class="mentor-desc hidden">Includes live mentor sessions</div>
                    </div>
                    <!-- Enroll Button -->
                    <div class="mt-4">
                        <button class="enroll-btn w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300" 
                                data-course-id="splunk-siem" 
                                data-course-name="SIEM Engineering - Splunk Specialization" 
                                data-price="2999"
                                onclick="startEnrollment('splunk-siem', 'SIEM Engineering - Splunk Specialization', 2999)">
                            <i class="fas fa-graduation-cap mr-2"></i>Enroll Now
                        </button>
                    </div>
                </div>

                <!-- Cloud Security Course -->
                <div class="course-card p-6 rounded-lg course-selection" data-course="cloud-security">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-xl font-semibold">Cloud Security Analyst (AWS, Azure, GCP)</h3>
                        <span class="bg-green-600 text-white text-sm px-3 py-1 rounded-full">Intermediate</span>
                    </div>
                    <p class="text-gray-300 mb-4">AWS, Azure, and GCP security architecture, compliance, and best practices.</p>
                    <div class="price-display">
                        <div class="self-paced-price text-2xl font-bold text-blue-400">$2,999</div>
                        <div class="mentor-price text-2xl font-bold text-blue-400 hidden">$4,999</div>
                    </div>
                    <div class="text-sm text-gray-400 mt-2">
                        <div class="self-paced-desc">Self-paced learning decks, labs, virtual internship & certificate</div>
                        <div class="mentor-desc hidden">Includes live mentor sessions</div>
                    </div>
                    <!-- Enroll Button -->
                    <div class="mt-4">
                        <button class="enroll-btn w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300" 
                                data-course-id="cloud-security" 
                                data-course-name="Cloud Security Analyst (AWS, Azure, GCP)" 
                                data-price="2999"
                                onclick="startEnrollment('cloud-security', 'Cloud Security Analyst (AWS, Azure, GCP)', 2999)">
                            <i class="fas fa-graduation-cap mr-2"></i>Enroll Now
                        </button>
                    </div>
                </div>

                <!-- Malware Analysis Course -->
                <div class="course-card p-6 rounded-lg course-selection" data-course="malware-analysis">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-xl font-semibold">Malware Analyst & Network Defense</h3>
                        <span class="bg-red-600 text-white text-sm px-3 py-1 rounded-full">Advanced</span>
                    </div>
                    <p class="text-gray-300 mb-4">Reverse engineering, dynamic analysis, and advanced network security techniques.</p>
                    <div class="price-display">
                        <div class="self-paced-price text-2xl font-bold text-blue-400">$2,999</div>
                        <div class="mentor-price text-2xl font-bold text-blue-400 hidden">$4,999</div>
                    </div>
                    <div class="text-sm text-gray-400 mt-2">
                        <div class="self-paced-desc">Self-paced learning decks, labs, virtual internship & certificate</div>
                        <div class="mentor-desc hidden">Includes live mentor sessions</div>
                    </div>
                    <!-- Enroll Button -->
                    <div class="mt-4">
                        <button class="enroll-btn w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300" 
                                data-course-id="malware-analysis" 
                                data-course-name="Malware Analyst & Network Defense" 
                                data-price="2999"
                                onclick="startEnrollment('malware-analysis', 'Malware Analyst & Network Defense', 2999)">
                            <i class="fas fa-graduation-cap mr-2"></i>Enroll Now
                        </button>
                    </div>
                </div>

                <!-- GRC Course -->
                <div class="course-card p-6 rounded-lg course-selection" data-course="grc-essentials">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-xl font-semibold">Risk & Compliance Analyst - GRC Fundamentals</h3>
                        <span class="bg-indigo-600 text-white text-sm px-3 py-1 rounded-full">Intermediate</span>
                    </div>
                    <p class="text-gray-300 mb-4">Governance frameworks, risk management, and regulatory compliance strategies.</p>
                    <div class="price-display">
                        <div class="self-paced-price text-2xl font-bold text-blue-400">$2,999</div>
                        <div class="mentor-price text-2xl font-bold text-blue-400 hidden">$4,999</div>
                    </div>
                    <div class="text-sm text-gray-400 mt-2">
                        <div class="self-paced-desc">Self-paced learning decks, labs, virtual internship & certificate</div>
                        <div class="mentor-desc hidden">Includes live mentor sessions</div>
                    </div>
                    <!-- Enroll Button -->
                    <div class="mt-4">
                        <button class="enroll-btn w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300" 
                                data-course-id="grc-essentials" 
                                data-course-name="Risk & Compliance Analyst - GRC Fundamentals" 
                                data-price="2999"
                                onclick="startEnrollment('grc-essentials', 'Risk & Compliance Analyst - GRC Fundamentals', 2999)">
                            <i class="fas fa-graduation-cap mr-2"></i>Enroll Now
                        </button>
                    </div>
                </div>
            </div>

            <!-- Mentor Booking Section (Conditional) -->
            <div id="mentor-booking-section" class="mentor-booking bg-gray-700 p-6 rounded-lg mb-8">
                <h3 class="text-2xl font-semibold mb-4 text-center">
                    <i class="fas fa-user-tie mr-2 text-blue-400"></i>Book Your Mentor Sessions
                </h3>
                <div class="grid md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium mb-2">Select Preferred Mentor</label>
                        <select class="w-full p-3 bg-gray-600 rounded-lg text-white">
                            <option>Dr. Rebecca Chen - Chief Security Officer</option>
                            <option>Marcus Johnson - Senior GRC Manager</option>
                            <option>David Thompson - Cloud Security Architect</option>
                            <option>Sarah Martinez - SOC Operations Director</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Session Duration</label>
                        <select class="w-full p-3 bg-gray-600 rounded-lg text-white">
                            <option>30 minutes - Quick consultation</option>
                            <option>60 minutes - In-depth session</option>
                            <option>90 minutes - Comprehensive review</option>
                        </select>
                    </div>
                </div>
                <div class="mt-4">
                    <button class="w-full bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 transition duration-300">
                        <i class="fas fa-calendar-plus mr-2"></i>Schedule Mentor Session
                    </button>
                </div>
            </div>

            <!-- Enhanced Cart Summary -->
            <div class="bg-gray-700 p-6 rounded-lg max-w-md mx-auto">
                <h3 class="text-xl font-semibold mb-4">Order Summary</h3>
                <div id="cart-items" class="space-y-2 mb-4">
                    <p id="no-courses-message" class="text-gray-400">Select SOC Analyst course below to see pricing</p>
                </div>
                <div class="border-t border-gray-600 pt-4">
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-lg font-semibold">Total:</span>
                        <span id="total-price" class="text-2xl font-bold text-blue-400">$0</span>
                    </div>
                    
                    <!-- Payment Plan Selection -->
                    <div id="payment-plan-selector" class="mb-6 hidden">
                        <h4 class="font-semibold mb-4 text-center">Choose Your Payment Option</h4>
                        <div class="space-y-3">
                            <label class="payment-plan-option cursor-pointer block">
                                <input type="radio" name="payment-plan" value="full" checked class="sr-only">
                                <div class="payment-option-card border-2 border-green-500 bg-green-900 bg-opacity-20 rounded-lg p-4 transition-all hover:border-green-400">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <div class="text-lg font-bold text-green-400">Best Value - Pay Once</div>
                                            <div class="text-2xl font-bold text-white">$2,849 <span class="text-sm text-green-300">(5% savings)</span></div>
                                            <div class="text-sm text-gray-300">Full course access • No monthly payments</div>
                                        </div>
                                        <div class="text-green-400">
                                            <i class="fas fa-check-circle text-2xl"></i>
                                        </div>
                                    </div>
                                </div>
                            </label>
                            <label class="payment-plan-option cursor-pointer block">
                                <input type="radio" name="payment-plan" value="monthly" class="sr-only">
                                <div class="payment-option-card border-2 border-gray-600 bg-gray-800 bg-opacity-30 rounded-lg p-4 transition-all hover:border-blue-400">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <div class="text-lg font-bold text-blue-400">Start Today - Monthly Plan</div>
                                            <div class="text-2xl font-bold text-white">$750 down + $375/month</div>
                                            <div class="text-sm text-gray-300">6 payments • Start immediately</div>
                                        </div>
                                        <div class="text-blue-400 opacity-0 option-check">
                                            <i class="fas fa-check-circle text-2xl"></i>
                                        </div>
                                    </div>
                                </div>
                            </label>
                        </div>
                        
                        <!-- Enhanced Payment Agreement Section -->
                        <div class="mt-6 p-5 bg-gradient-to-r from-gray-800 to-gray-700 border border-gray-600 rounded-lg">
                            <div class="mb-3">
                                <h4 class="text-white font-semibold mb-2 flex items-center">
                                    <i class="fas fa-shield-alt text-blue-400 mr-2"></i>
                                    Terms & Payment Authorization
                                </h4>
                            </div>
                            
                            <label class="flex items-start cursor-pointer group">
                                <input type="checkbox" id="payment-agreement" class="mt-1.5 mr-4 w-5 h-5 text-blue-600 border-2 border-gray-500 rounded focus:ring-blue-500 focus:ring-2" required>
                                <div class="text-sm text-gray-300 leading-relaxed">
                                    <p class="mb-2">
                                        I acknowledge that I have read and agree to the 
                                        <button onclick="showTermsOfService(); return false;" 
                                                class="text-blue-400 hover:text-blue-300 underline font-medium transition-colors">
                                            Terms of Service
                                        </button> and 
                                        <button onclick="showPaymentTerms(); return false;" 
                                                class="text-blue-400 hover:text-blue-300 underline font-medium transition-colors">
                                            Payment Terms
                                        </button>.
                                    </p>
                                    
                                    <div id="payment-authorization-text" class="mt-3 p-3 bg-blue-900/20 border border-blue-500/30 rounded-lg">
                                        <p class="text-blue-200 text-xs font-medium mb-1">Payment Authorization:</p>
                                        <p class="text-blue-100 text-xs" id="dynamic-payment-text">
                                            By proceeding, I authorize TechStep Foundation to process my selected payment option.
                                        </p>
                                    </div>
                                    
                                    <div class="mt-3 flex items-center text-xs text-gray-400">
                                        <i class="fas fa-lock mr-1"></i>
                                        <span>Secure payment processing • 7-day money-back guarantee • Cancel anytime</span>
                                    </div>
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- Payment Buttons Container -->
                    <div id="payment-buttons-container" class="space-y-3 hidden">
                        <!-- Stripe Payment Button -->
                        <button id="stripe-button" class="payment-button stripe-button" disabled>
                            <i class="fas fa-credit-card"></i>
                            Pay with Card
                        </button>

                        <!-- PayPal Button Container -->
                        <div id="paypal-button-container"></div>

                        <!-- Apple Pay Button -->
                        <button id="apple-pay-button" class="payment-button apple-pay-button hidden">
                            <i class="fab fa-apple"></i>
                            Pay with Apple Pay
                        </button>

                        <!-- Google Pay Button -->
                        <div id="google-pay-button-container"></div>
                    </div>

                    <!-- Secure Payment Notice -->
                    <div id="security-notice" class="mt-4 text-xs text-gray-400 text-center">
                        <div class="bg-gray-800 rounded-lg p-4">
                            <div class="flex items-center justify-center mb-2">
                                <i class="fas fa-shield-alt text-green-400 mr-2"></i>
                                <span class="font-semibold text-gray-300">Secure Checkout</span>
                            </div>
                            <p class="text-gray-400 mb-2">
                                <i class="fas fa-lock mr-1"></i>
                                256-bit SSL encryption • PCI DSS compliant • Powered by Stripe
                            </p>
                            <div class="space-y-1 text-xs">
                                <p>✓ 7-day money-back guarantee</p>
                                <p>✓ Instant course access after payment</p>
                                <p>✓ Email support: support@techstepfoundation.org</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Success Stories Section -->
    <section class="py-20 bg-gradient-to-r from-blue-900 to-purple-900">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-4xl font-bold text-white mb-4">Real Career Transformations</h2>
                <p class="text-xl text-gray-300 max-w-3xl mx-auto">
                    See how TechStep has helped professionals successfully transition into cybersecurity careers
                </p>
            </div>
            
            <div class="max-w-6xl mx-auto">
                <div class="bg-gray-800 rounded-2xl p-8 md:p-12 shadow-2xl">
                    <div class="grid lg:grid-cols-2 gap-12 items-center">
                        <!-- Video with Image Poster Side -->
                        <div class="order-2 lg:order-1">
                            <div class="relative">
                                <!-- Video Player with Image as Poster -->
                                <video 
                                    id="successStoryVideo"
                                    class="w-full h-auto rounded-lg shadow-xl cursor-pointer transform hover:scale-105 transition-transform duration-300"
                                    style="max-height: 400px; object-fit: cover;"
                                    poster="media/log_added.png"
                                    preload="metadata"
                                    onclick="this.play(); this.controls=true; this.onclick=null;"
                                    onended="this.controls=false; this.currentTime=0; this.onclick=function(){this.play(); this.controls=true; this.onclick=null;};"
                                    onerror="this.style.display='none'; this.parentNode.innerHTML='<div class=\'text-center text-gray-400 py-12\'><i class=\'fas fa-video text-6xl mb-4\'></i><p class=\'text-xl\'>Video will appear here</p><p class=\'text-sm\'>TechStep Studio.mp4</p></div>'">
                                    
                                    <source src="media/videos/courses/TechStep Studio.mp4" type="video/mp4">
                                    <source src="media/videos/courses/TechStep%20Studio.mp4" type="video/mp4">
                                    <!-- Fallback to image if video doesn't work -->
                                    <img src="media/log_added.png" 
                                         alt="TechStep Success Story - Career Change to Cybersecurity" 
                                         class="w-full h-auto rounded-lg shadow-xl"
                                         style="max-height: 400px; object-fit: cover;">
                                </video>
                                
                                <!-- Play Button Overlay -->
                                <div id="playButtonOverlay" class="absolute inset-0 flex items-center justify-center bg-black bg-opacity-30 rounded-lg transition-opacity duration-300 hover:bg-opacity-40"
                                     onclick="document.getElementById('successStoryVideo').click(); this.style.display='none';">
                                    <div class="w-20 h-20 bg-blue-600 rounded-full flex items-center justify-center shadow-2xl transform hover:scale-110 transition-transform duration-300">
                                        <i class="fas fa-play text-white text-2xl ml-1"></i>
                                    </div>
                                </div>
                                
                                <!-- Success Badge -->
                                <div class="absolute -top-4 -right-4 bg-green-500 text-white px-4 py-2 rounded-full font-semibold shadow-lg">
                                    <i class="fas fa-video mr-2"></i>Watch Story
                                </div>
                                
                                <!-- Video Duration Badge -->
                                <div class="absolute bottom-4 left-4 bg-black bg-opacity-75 text-white px-3 py-1 rounded-full text-sm">
                                    <i class="fas fa-clock mr-1"></i>5 sec
                                </div>
                            </div>
                        </div>
                        
                        <!-- Content Side -->
                        <div class="order-1 lg:order-2">
                            <div class="space-y-6">
                                <div class="flex items-center space-x-3">
                                    <div class="w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center">
                                        <i class="fas fa-graduation-cap text-white text-xl"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-2xl font-bold text-white">Career Change Success</h3>
                                        <p class="text-blue-400 font-semibold">From Any Background to Cybersecurity</p>
                                    </div>
                                </div>
                                
                                <blockquote class="text-lg text-gray-300 italic border-l-4 border-blue-500 pl-6">
                                    "TechStep didn't just teach me cybersecurity – they guided my entire career transformation. 
                                    From zero experience to landing my dream job in just 6 months!"
                                </blockquote>
                                
                                <div class="grid grid-cols-2 gap-4">
                                    <div class="text-center p-4 bg-gray-700 rounded-lg">
                                        <div class="text-2xl font-bold text-green-400">6 Months</div>
                                        <div class="text-sm text-gray-400">To Career Change</div>
                                    </div>
                                    <div class="text-center p-4 bg-gray-700 rounded-lg">
                                        <div class="text-2xl font-bold text-blue-400">100%</div>
                                        <div class="text-sm text-gray-400">Support Provided</div>
                                    </div>
                                </div>
                                
                                <div class="flex flex-col sm:flex-row gap-4">
                                    <button onclick="document.getElementById('courses').scrollIntoView({behavior: 'smooth'});" class="flex-1 bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition duration-300">
                                        <i class="fas fa-rocket mr-2"></i>Start Your Journey Today
                                    </button>
                                    <button onclick="window.location.href='demo/'" class="flex-1 border border-blue-400 text-blue-400 px-6 py-3 rounded-lg font-semibold hover:bg-blue-600 hover:text-white transition duration-300">
                                        <i class="fas fa-play mr-2"></i>Try Free Demo
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Meet Your Expert Mentors -->
    <section id="mentors" class="py-20 bg-gray-900">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-4xl font-bold mb-4">Meet Your Expert Mentors</h2>
                <p class="text-xl text-gray-300 max-w-3xl mx-auto">
                    Learn from industry veterans with real-world experience in cybersecurity leadership and operations.
                </p>
            </div>
            
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Dr. Rebecca Chen -->
                <div class="mentor-card p-6 rounded-lg text-center">
                    <img src="https://www.shutterstock.com/image-photo/closeup-headshot-face-portrait-beautiful-260nw-2491646077.jpg" 
                         alt="Dr. Rebecca Chen" class="w-24 h-24 rounded-full mx-auto mb-4 object-cover">
                    <h3 class="text-xl font-semibold mb-2">Dr. Rebecca Chen</h3>
                    <p class="text-blue-400 mb-2">Chief Security Officer</p>
                    <p class="text-gray-300 text-sm mb-4">15+ years in enterprise security leadership. PhD in Cybersecurity & Information Assurance. Former Government Security Specialist.</p>
                    <div class="flex flex-wrap gap-1 mb-4">
                        <span class="bg-blue-600 text-xs px-2 py-1 rounded">CISSP</span>
                        <span class="bg-blue-600 text-xs px-2 py-1 rounded">CISM</span>
                        <span class="bg-blue-600 text-xs px-2 py-1 rounded">Strategic Planning</span>
                    </div>
                    <p class="text-xs text-gray-400">Specializes in: Threat Intelligence, Incident Response, Security Strategy</p>
                </div>

                <!-- Marcus Johnson -->
                <div class="mentor-card p-6 rounded-lg text-center">
                    <img src="https://www.shutterstock.com/image-photo/cheerful-handsome-young-african-man-260nw-2432719403.jpg" 
                         alt="Marcus Johnson" class="w-24 h-24 rounded-full mx-auto mb-4 object-cover">
                    <h3 class="text-xl font-semibold mb-2">Marcus Johnson</h3>
                    <p class="text-blue-400 mb-2">Senior GRC Manager</p>
                    <p class="text-gray-300 text-sm mb-4">12+ years in governance, risk, and compliance. Former Big Four Consulting Manager with expertise in regulatory frameworks.</p>
                    <div class="flex flex-wrap gap-1 mb-4">
                        <span class="bg-blue-600 text-xs px-2 py-1 rounded">CISA</span>
                        <span class="bg-blue-600 text-xs px-2 py-1 rounded">CRISC</span>
                        <span class="bg-blue-600 text-xs px-2 py-1 rounded">ISO 27001</span>
                    </div>
                    <p class="text-xs text-gray-400">Specializes in: Risk Assessment, Compliance Frameworks, Audit Management</p>
                </div>

                <!-- David Thompson -->
                <div class="mentor-card p-6 rounded-lg text-center">
                    <img src="https://www.shutterstock.com/image-photo/successful-indian-authoritative-confident-young-260nw-2274331045.jpg" 
                         alt="David Thompson" class="w-24 h-24 rounded-full mx-auto mb-4 object-cover">
                    <h3 class="text-xl font-semibold mb-2">David Thompson</h3>
                    <p class="text-blue-400 mb-2">Cloud Security Architect</p>
                    <p class="text-gray-300 text-sm mb-4">10+ years in cloud security architecture. Former Cloud Platform Security Lead and AWS Community Hero.</p>
                    <div class="flex flex-wrap gap-1 mb-4">
                        <span class="bg-blue-600 text-xs px-2 py-1 rounded">AWS Security</span>
                        <span class="bg-blue-600 text-xs px-2 py-1 rounded">CCSP</span>
                        <span class="bg-blue-600 text-xs px-2 py-1 rounded">CISSP</span>
                    </div>
                    <p class="text-xs text-gray-400">Specializes in: Multi-cloud Security, DevSecOps, Container Security</p>
                </div>

                <!-- Sarah Martinez -->
                <div class="mentor-card p-6 rounded-lg text-center">
                    <img src="https://www.shutterstock.com/image-photo/happy-attractive-indian-woman-looking-260nw-2449701411.jpg" 
                         alt="Sarah Martinez" class="w-24 h-24 rounded-full mx-auto mb-4 object-cover">
                    <h3 class="text-xl font-semibold mb-2">Sarah Martinez</h3>
                    <p class="text-blue-400 mb-2">SOC Operations Director</p>
                    <p class="text-gray-300 text-sm mb-4">13+ years in security operations and threat hunting. Former Threat Intelligence Analyst with SOC leadership experience.</p>
                    <div class="flex flex-wrap gap-1 mb-4">
                        <span class="bg-blue-600 text-xs px-2 py-1 rounded">GCIH</span>
                        <span class="bg-blue-600 text-xs px-2 py-1 rounded">GCFA</span>
                        <span class="bg-blue-600 text-xs px-2 py-1 rounded">CISSP</span>
                    </div>
                    <p class="text-xs text-gray-400">Specializes in: SIEM Management, Incident Response, Threat Detection</p>
                </div>

                <!-- Alex Rivera -->
                <div class="mentor-card p-6 rounded-lg text-center">
                    <img src="https://www.shutterstock.com/image-photo/happy-smiling-bearded-indian-business-260nw-2066562635.jpg" 
                         alt="Alex Rivera" class="w-24 h-24 rounded-full mx-auto mb-4 object-cover">
                    <h3 class="text-xl font-semibold mb-2">Alex Rivera</h3>
                    <p class="text-blue-400 mb-2">Penetration Testing Lead</p>
                    <p class="text-gray-300 text-sm mb-4">8+ years in ethical hacking and vulnerability assessment. Former Offensive Security Consultant with Red Team operations experience.</p>
                    <div class="flex flex-wrap gap-1 mb-4">
                        <span class="bg-blue-600 text-xs px-2 py-1 rounded">OSCP</span>
                        <span class="bg-blue-600 text-xs px-2 py-1 rounded">OSCE</span>
                        <span class="bg-blue-600 text-xs px-2 py-1 rounded">CEH</span>
                    </div>
                    <p class="text-xs text-gray-400">Specializes in: Network Penetration, Web App Security, Social Engineering</p>
                </div>

                <!-- Dr. Michelle Zhang -->
                <div class="mentor-card p-6 rounded-lg text-center">
                    <img src="https://www.shutterstock.com/image-photo/business-man-face-smile-portrait-600nw-2262612091.jpg" 
                         alt="Dr. Michelle Zhang" class="w-24 h-24 rounded-full mx-auto mb-4 object-cover">
                    <h3 class="text-xl font-semibold mb-2">Dr. Michelle Zhang</h3>
                    <p class="text-blue-400 mb-2">AI Security Researcher</p>
                    <p class="text-gray-300 text-sm mb-4">PhD in Computer Science with AI Security focus. Former AI Research Scientist specializing in machine learning security.</p>
                    <div class="flex flex-wrap gap-1 mb-4">
                        <span class="bg-blue-600 text-xs px-2 py-1 rounded">AI Ethics</span>
                        <span class="bg-blue-600 text-xs px-2 py-1 rounded">CISSP</span>
                        <span class="bg-blue-600 text-xs px-2 py-1 rounded">ML Security</span>
                    </div>
                    <p class="text-xs text-gray-400">Specializes in: AI Governance, Algorithmic Security, ML Threat Modeling</p>
                </div>
            </div>
        </div>
    </section>

   <!-- TechStep Podcast -->
<section id="podcast" class="py-20 bg-gray-800">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-16">
            <h2 class="text-4xl font-bold mb-4">🎧 TechStep Podcast</h2>
            <p class="text-xl text-gray-300 max-w-3xl mx-auto">
                "CyberSecure Weekly" – Your gateway to cybersecurity excellence with industry insights, expert interviews, and career advice.
            </p>
        </div>

        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">

            
            <!-- Episode 1: Zero Trust - FREE ACCESS -->
            <div class="course-card p-6 rounded-lg">
                <div class="flex items-center mb-4">
                    <div class="w-16 h-16 bg-blue-600 rounded-lg flex items-center justify-center mr-4">
                        <i class="fas fa-microphone text-2xl text-white"></i>
                    </div>
                    <div>
                        <h3 class="font-semibold">Episode 45</h3>
                        <p class="text-blue-400 text-sm">Latest • Free</p>
                    </div>
                </div>
                <h4 class="text-lg font-semibold mb-2">Zero Trust Architecture in 2024</h4>
                <p class="text-gray-300 text-sm mb-4">
                    Dr. Rebecca Chen discusses the evolution of zero trust models and implementation strategies for modern enterprises.
                </p>
                
                <!-- Modern Audio Player -->
                <div class="modern-audio-player mb-4">
                    <audio id="zeroTrustAudio" preload="metadata" controlsList="nodownload">
                        <source src="https://cdn1.genspark.ai/user-upload-image/8/17dcaf5f-bfb4-43d3-bfb8-1138be94d24b.mp3" type="audio/mpeg">
                        Your browser does not support the audio element.
                    </audio>
                    
                    <div class="audio-controls">
                        <button class="play-pause-btn" onclick="togglePlay('zeroTrustAudio')">
                            <i class="fas fa-play"></i>
                        </button>
                        
                        <div class="audio-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" id="progress-zeroTrustAudio"></div>
                                <div class="progress-handle" id="handle-zeroTrustAudio"></div>
                            </div>
                            <div class="time-display">
                                <span id="current-time-zeroTrustAudio">0:00</span>
                                <span id="duration-zeroTrustAudio">32:00</span>
                            </div>
                        </div>
                        
                        <div class="audio-controls-right">
                            <button class="volume-btn" onclick="toggleMute('zeroTrustAudio')">
                                <i class="fas fa-volume-up"></i>
                            </button>
                            <div class="playback-speed">
                                <select onchange="changeSpeed('zeroTrustAudio', this.value)">
                                    <option value="0.75">0.75x</option>
                                    <option value="1" selected>1x</option>
                                    <option value="1.25">1.25x</option>
                                    <option value="1.5">1.5x</option>
                                    <option value="2">2x</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex items-center justify-between">
                    <span class="text-sm text-gray-400">32 mins</span>
                    <span class="text-xs bg-green-600 text-white px-2 py-1 rounded">FREE ACCESS</span>
                </div>
            </div>

            <!-- Episode 2: AI Threat Detection - LOCKED -->
            <div class="course-card p-6 rounded-lg relative locked-episode">
                <div class="flex items-center mb-4">
                    <div class="w-16 h-16 bg-green-600 rounded-lg flex items-center justify-center mr-4">
                        <i class="fas fa-brain text-2xl text-white"></i>
                    </div>
                    <div>
                        <h3 class="font-semibold">Episode 44</h3>
                        <p class="text-blue-400 text-sm">Popular • Premium</p>
                    </div>
                </div>
                <h4 class="text-lg font-semibold mb-2">AI-Powered Threat Detection</h4>
                <p class="text-gray-300 text-sm mb-4">
                    Dr. Michelle Zhang explores how artificial intelligence is revolutionizing cybersecurity threat detection and response.
                </p>
                
                <!-- Locked Audio Player -->
                <div class="locked-audio-player mb-4">
                    <div class="lock-overlay">
                        <i class="fas fa-lock text-3xl text-gray-400 mb-2"></i>
                        <p class="text-sm text-gray-400 text-center">Enroll in any course to unlock</p>
                        <button class="unlock-btn mt-2" onclick="showEnrollmentModal()">
                            <i class="fas fa-graduation-cap mr-1"></i>View Courses
                        </button>
                    </div>
                </div>
                
                <div class="flex items-center justify-between">
                    <span class="text-sm text-gray-400">28 mins</span>
                    <span class="text-xs bg-yellow-600 text-white px-2 py-1 rounded">PREMIUM</span>
                </div>
            </div>

            <!-- Episode 3: GRC Best Practices - LOCKED -->
            <div class="course-card p-6 rounded-lg relative locked-episode">
                <div class="flex items-center mb-4">
                    <div class="w-16 h-16 bg-purple-600 rounded-lg flex items-center justify-center mr-4">
                        <i class="fas fa-shield-alt text-2xl text-white"></i>
                    </div>
                    <div>
                        <h3 class="font-semibold">Episode 43</h3>
                        <p class="text-blue-400 text-sm">Trending • Premium</p>
                    </div>
                </div>
                <h4 class="text-lg font-semibold mb-2">GRC Best Practices for SMBs</h4>
                <p class="text-gray-300 text-sm mb-4">
                    Marcus Johnson shares practical governance, risk, and compliance strategies tailored for small and medium businesses.
                </p>
                
                <!-- Locked Audio Player -->
                <div class="locked-audio-player mb-4">
                    <div class="lock-overlay">
                        <i class="fas fa-lock text-3xl text-gray-400 mb-2"></i>
                        <p class="text-sm text-gray-400 text-center">Enroll in GRC course to unlock</p>
                        <button class="unlock-btn mt-2" onclick="scrollToCourses()">
                            <i class="fas fa-graduation-cap mr-1"></i>Enroll Now
                        </button>
                    </div>
                </div>
                
                <div class="flex items-center justify-between">
                    <span class="text-sm text-gray-400">35 mins</span>
                    <span class="text-xs bg-yellow-600 text-white px-2 py-1 rounded">PREMIUM</span>
                </div>
            </div>

            <!-- Episode 4: Cloud Security Trends - LOCKED -->
            <div class="course-card p-6 rounded-lg relative locked-episode">
                <div class="flex items-center mb-4">
                    <div class="w-16 h-16 bg-indigo-600 rounded-lg flex items-center justify-center mr-4">
                        <i class="fas fa-cloud text-2xl text-white"></i>
                    </div>
                    <div>
                        <h3 class="font-semibold">Episode 42</h3>
                        <p class="text-blue-400 text-sm">Featured • Premium</p>
                    </div>
                </div>
                <h4 class="text-lg font-semibold mb-2">Cloud Security Trends 2024</h4>
                <p class="text-gray-300 text-sm mb-4">
                    David Thompson breaks down the latest cloud security trends and what organizations need to know for 2024.
                </p>
                
                <!-- Locked Audio Player -->
                <div class="locked-audio-player mb-4">
                    <div class="lock-overlay">
                        <i class="fas fa-lock text-3xl text-gray-400 mb-2"></i>
                        <p class="text-sm text-gray-400 text-center">Enroll in Cloud Security course to unlock</p>
                        <button class="unlock-btn mt-2" onclick="scrollToCourses()">
                            <i class="fas fa-graduation-cap mr-1"></i>Enroll Now
                        </button>
                    </div>
                </div>
                
                <div class="flex items-center justify-between">
                    <span class="text-sm text-gray-400">42 mins</span>
                    <span class="text-xs bg-yellow-600 text-white px-2 py-1 rounded">PREMIUM</span>
                </div>
            </div>

            <!-- Episode 5: Penetration Testing - LOCKED -->
            <div class="course-card p-6 rounded-lg relative locked-episode">
                <div class="flex items-center mb-4">
                    <div class="w-16 h-16 bg-red-600 rounded-lg flex items-center justify-center mr-4">
                        <i class="fas fa-bug text-2xl text-white"></i>
                    </div>
                    <div>
                        <h3 class="font-semibold">Episode 41</h3>
                        <p class="text-blue-400 text-sm">Expert Series • Premium</p>
                    </div>
                </div>
                <h4 class="text-lg font-semibold mb-2">Advanced Penetration Testing</h4>
                <p class="text-gray-300 text-sm mb-4">
                    Alex Rivera shares insights on advanced penetration testing techniques and career paths in ethical hacking.
                </p>
                
                <!-- Locked Audio Player -->
                <div class="locked-audio-player mb-4">
                    <div class="lock-overlay">
                        <i class="fas fa-lock text-3xl text-gray-400 mb-2"></i>
                        <p class="text-sm text-gray-400 text-center">Enroll in any course to unlock</p>
                        <button class="unlock-btn mt-2" onclick="scrollToCourses()">
                            <i class="fas fa-graduation-cap mr-1"></i>View Courses
                        </button>
                    </div>
                </div>
                
                <div class="flex items-center justify-between">
                    <span class="text-sm text-gray-400">38 mins</span>
                    <span class="text-xs bg-yellow-600 text-white px-2 py-1 rounded">PREMIUM</span>
                </div>
            </div>

            <!-- Episode 6: Career Transition - LOCKED -->
            <div class="course-card p-6 rounded-lg relative locked-episode">
                <div class="flex items-center mb-4">
                    <div class="w-16 h-16 bg-yellow-600 rounded-lg flex items-center justify-center mr-4">
                        <i class="fas fa-rocket text-2xl text-white"></i>
                    </div>
                    <div>
                        <h3 class="font-semibold">Episode 40</h3>
                        <p class="text-blue-400 text-sm">Career Focus • Premium</p>
                    </div>
                </div>
                <h4 class="text-lg font-semibold mb-2">Career Transition Success Stories</h4>
                <p class="text-gray-300 text-sm mb-4">
                    Real stories from professionals who successfully transitioned into cybersecurity careers with actionable advice.
                </p>
                
                <!-- Locked Audio Player -->
                <div class="locked-audio-player mb-4">
                    <div class="lock-overlay">
                        <i class="fas fa-lock text-3xl text-gray-400 mb-2"></i>
                        <p class="text-sm text-gray-400 text-center">Enroll in any course to unlock</p>
                        <button class="unlock-btn mt-2" onclick="scrollToCourses()">
                            <i class="fas fa-graduation-cap mr-1"></i>View Courses
                        </button>
                    </div>
                </div>
                
                <div class="flex items-center justify-between">
                    <span class="text-sm text-gray-400">45 mins</span>
                    <span class="text-xs bg-yellow-600 text-white px-2 py-1 rounded">PREMIUM</span>
                </div>
            </div>
        </div>

        <div class="text-center mt-12">
            <button class="bg-gray-700 text-white px-8 py-3 rounded-lg font-semibold hover:bg-gray-600 transition duration-300">
                <i class="fas fa-podcast mr-2"></i>View All Episodes
            </button>
        </div>
    </div>
</section>

<style>
/* Modern Audio Player Styles */
.modern-audio-player {
    background: linear-gradient(135deg, #1f2937 0%, #374151 100%);
    border: 1px solid rgba(59, 130, 246, 0.2);
    border-radius: 12px;
    padding: 16px;
    backdrop-filter: blur(10px);
}

.audio-controls {
    display: flex;
    align-items: center;
    gap: 12px;
}

.play-pause-btn {
    width: 48px;
    height: 48px;
    background: linear-gradient(135deg, #3b82f6, #1d4ed8);
    border: none;
    border-radius: 50%;
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    transition: all 0.3s ease;
    flex-shrink: 0;
}

.play-pause-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
}

.audio-progress {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.progress-bar {
    position: relative;
    height: 6px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 3px;
    cursor: pointer;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #3b82f6, #60a5fa);
    border-radius: 3px;
    width: 0%;
    transition: width 0.1s ease;
}

.progress-handle {
    position: absolute;
    top: 50%;
    left: 0%;
    width: 14px;
    height: 14px;
    background: #3b82f6;
    border: 2px solid white;
    border-radius: 50%;
    transform: translate(-50%, -50%);
    cursor: pointer;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.progress-bar:hover .progress-handle {
    opacity: 1;
}

.time-display {
    display: flex;
    justify-content: space-between;
    font-size: 12px;
    color: #9ca3af;
}

.audio-controls-right {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-shrink: 0;
}

.volume-btn {
    background: none;
    border: none;
    color: #9ca3af;
    cursor: pointer;
    font-size: 16px;
    padding: 8px;
    border-radius: 6px;
    transition: all 0.3s ease;
}

.volume-btn:hover {
    color: #3b82f6;
    background: rgba(59, 130, 246, 0.1);
}

.playback-speed select {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 6px;
    color: white;
    padding: 4px 8px;
    font-size: 12px;
    cursor: pointer;
}

/* Locked Episode Styles */
.locked-episode {
    opacity: 0.7;
    position: relative;
}

.locked-episode::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.3);
    border-radius: inherit;
    z-index: 1;
    pointer-events: none;
}

.locked-audio-player {
    background: linear-gradient(135deg, #374151 0%, #4b5563 100%);
    border: 1px solid rgba(156, 163, 175, 0.3);
    border-radius: 12px;
    padding: 24px;
    position: relative;
}

.lock-overlay {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    min-height: 120px;
}

.unlock-btn {
    background: linear-gradient(135deg, #3b82f6, #1d4ed8);
    border: none;
    color: white;
    padding: 8px 16px;
    border-radius: 6px;
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
}

.unlock-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
}

/* Responsive Design */
@media (max-width: 768px) {
    .audio-controls {
        flex-direction: column;
        gap: 16px;
    }
    
    .audio-controls-right {
        width: 100%;
        justify-content: center;
    }
    
    .time-display {
        margin-top: 4px;
    }
}
</style>

<script>
// Modern Audio Player Functionality
function togglePlay(audioId) {
    const audio = document.getElementById(audioId);
    const button = audio.parentElement.querySelector('.play-pause-btn i');
    
    if (audio.paused) {
        audio.play();
        button.className = 'fas fa-pause';
    } else {
        audio.pause();
        button.className = 'fas fa-play';
    }
}

function toggleMute(audioId) {
    const audio = document.getElementById(audioId);
    const button = audio.parentElement.querySelector('.volume-btn i');
    
    if (audio.muted) {
        audio.muted = false;
        button.className = 'fas fa-volume-up';
    } else {
        audio.muted = true;
        button.className = 'fas fa-volume-mute';
    }
}

function changeSpeed(audioId, speed) {
    const audio = document.getElementById(audioId);
    audio.playbackRate = parseFloat(speed);
}

function scrollToCourses() {
    document.getElementById('courses').scrollIntoView({
        behavior: 'smooth',
        block: 'start'
    });
}

function showEnrollmentModal() {
    // Trigger the course selection section
    scrollToCourses();
    // Optional: Show notification
    showNotification('Select a course below to unlock premium podcast episodes!', 'info');
}

// Audio Progress Updates
document.addEventListener('DOMContentLoaded', function() {
    const audioElements = document.querySelectorAll('audio');
    
    audioElements.forEach(audio => {
        const audioId = audio.id;
        const progressFill = document.getElementById(`progress-${audioId}`);
        const progressHandle = document.getElementById(`handle-${audioId}`);
        const currentTimeDisplay = document.getElementById(`current-time-${audioId}`);
        const durationDisplay = document.getElementById(`duration-${audioId}`);
        
        // Update progress
        audio.addEventListener('timeupdate', function() {
            if (audio.duration) {
                const progress = (audio.currentTime / audio.duration) * 100;
                if (progressFill) progressFill.style.width = progress + '%';
                if (progressHandle) progressHandle.style.left = progress + '%';
                if (currentTimeDisplay) currentTimeDisplay.textContent = formatTime(audio.currentTime);
            }
        });
        
        // Update duration when loaded
        audio.addEventListener('loadedmetadata', function() {
            if (durationDisplay) durationDisplay.textContent = formatTime(audio.duration);
        });
        
        // Click to seek
        const progressBar = audio.parentElement.querySelector('.progress-bar');
        if (progressBar) {
            progressBar.addEventListener('click', function(e) {
                const rect = this.getBoundingClientRect();
                const pos = (e.clientX - rect.left) / rect.width;
                audio.currentTime = pos * audio.duration;
            });
        }
    });
});

function formatTime(seconds) {
    if (isNaN(seconds)) return '0:00';
    const mins = Math.floor(seconds / 60);
    const secs = Math.floor(seconds % 60);
    return mins + ':' + (secs < 10 ? '0' : '') + secs;
}
</script>

    <!-- What Our Students Say -->
    <section id="testimonials" class="py-20 bg-gray-900">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-4xl font-bold mb-4">What Our Students Say</h2>
                <p class="text-xl text-gray-300">Real success stories from our cybersecurity professionals</p>
            </div>
            
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Testimonial 1 -->
                <div class="testimonial-card p-6 rounded-lg">
                    <div class="flex items-center mb-4">
                        <img src="https://www.shutterstock.com/image-photo/smiling-cheerful-young-adult-african-600nw-1850821510.jpg" 
                             alt="Michael Torres" class="w-12 h-12 rounded-full mr-4 object-cover">
                        <div>
                            <h4 class="font-semibold">Michael Torres</h4>
                            <p class="text-blue-400 text-sm">SOC Analyst at Fortune 500</p>
                        </div>
                    </div>
                    <div class="flex text-yellow-400 mb-3">
                        <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
                    </div>
                    <p class="text-gray-300">"The SOC Analyst course completely transformed my career. The hands-on labs and mentor guidance helped me land my dream job. The practical approach made all the difference!"</p>
                </div>

                <!-- Testimonial 2 -->
                <div class="testimonial-card p-6 rounded-lg">
                    <div class="flex items-center mb-4">
                        <img src="https://www.shutterstock.com/image-photo/modern-youth-representative-headshot-portrait-600nw-2412728603.jpg" 
                             alt="Priya Patel" class="w-12 h-12 rounded-full mr-4 object-cover">
                        <div>
                            <h4 class="font-semibold">Priya Patel</h4>
                            <p class="text-blue-400 text-sm">GRC Specialist</p>
                        </div>
                    </div>
                    <div class="flex text-yellow-400 mb-3">
                        <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
                    </div>
                    <p class="text-gray-300">"Marcus Johnson's mentoring was invaluable. The GRC course content is comprehensive and the Career Pro Package helped me negotiate a 40% salary increase!"</p>
                </div>

                <!-- Testimonial 3 -->
                <div class="testimonial-card p-6 rounded-lg">
                    <div class="flex items-center mb-4">
                        <img src="https://www.shutterstock.com/image-photo/happy-handsome-young-hispanic-business-260nw-2605417069.jpg" 
                             alt="James Chen" class="w-12 h-12 rounded-full mr-4 object-cover">
                        <div>
                            <h4 class="font-semibold">James Chen</h4>
                            <p class="text-blue-400 text-sm">Cloud Security Engineer</p>
                        </div>
                    </div>
                    <div class="flex text-yellow-400 mb-3">
                        <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
                    </div>
                    <p class="text-gray-300">"The Cloud Security course was exactly what I needed to transition from traditional IT to cybersecurity. David Thompson's real-world experience shines through."</p>
                </div>

                <!-- Testimonial 4 -->
                <div class="testimonial-card p-6 rounded-lg">
                    <div class="flex items-center mb-4">
                        <img src="https://www.shutterstock.com/image-photo/smiling-portrait-young-asian-man-600nw-2492067901.jpg" 
                             alt="Sarah Rodriguez" class="w-12 h-12 rounded-full mr-4 object-cover">
                        <div>
                            <h4 class="font-semibold">Sarah Rodriguez</h4>
                            <p class="text-blue-400 text-sm">Information Security Manager</p>
                        </div>
                    </div>
                    <div class="flex text-yellow-400 mb-3">
                        <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
                    </div>
                    <p class="text-gray-300">"From SOC analyst to security manager in 18 months! TechStep's comprehensive training and mentorship program accelerated my career beyond my expectations."</p>
                </div>

                <!-- Testimonial 5 -->
                <div class="testimonial-card p-6 rounded-lg">
                    <div class="flex items-center mb-4">
                        <img src="https://www.shutterstock.com/image-photo/portrait-headshot-young-adult-asian-600nw-1815432683.jpg" 
                             alt="David Park" class="w-12 h-12 rounded-full mr-4 object-cover">
                        <div>
                            <h4 class="font-semibold">David Park</h4>
                            <p class="text-blue-400 text-sm">Penetration Tester</p>
                        </div>
                    </div>
                    <div class="flex text-yellow-400 mb-3">
                        <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
                    </div>
                    <p class="text-gray-300">"Alex Rivera's penetration testing course is incredibly thorough. The hands-on approach and real-world scenarios prepared me perfectly for the OSCP exam."</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Career Pro Package -->
    <section class="py-20 bg-gray-800">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="career-pro-card p-8 rounded-lg text-center">
                <h2 class="text-3xl font-bold mb-4"> Career Pro Package</h2>
                <p class="text-xl text-gray-300 mb-6">Accelerate your cybersecurity career with our comprehensive career support package</p>
                <div class="text-4xl font-bold text-blue-400 mb-6">$499</div>
                
                <div class="grid md:grid-cols-2 gap-6 text-left mb-8">
                    <div class="space-y-3">
                        <div class="flex items-center">
                            <i class="fas fa-check-circle text-green-400 mr-3"></i>
                            <span>Resume Review & Optimization</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-check-circle text-green-400 mr-3"></i>
                            <span>LinkedIn Profile Enhancement</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-check-circle text-green-400 mr-3"></i>
                            <span>Cover Letter Template + Personalization</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-check-circle text-green-400 mr-3"></i>
                            <span>Mock Interview (Technical + Behavioral)</span>
                        </div>
                    </div>
                    <div class="space-y-3">
                        <div class="flex items-center">
                            <i class="fas fa-check-circle text-green-400 mr-3"></i>
                            <span>1:1 Career Strategy Session</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-check-circle text-green-400 mr-3"></i>
                            <span>Internship Placement Support</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-check-circle text-green-400 mr-3"></i>
                            <span>Peer Pod Access (3-person accountability group)</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-check-circle text-green-400 mr-3"></i>
                            <span>Salary Negotiation Guidance</span>
                        </div>
                    </div>
                </div>
                
                <button class="bg-green-600 text-white px-8 py-4 rounded-lg text-lg font-semibold hover:bg-green-700 transition duration-300">
                    <i class="fas fa-rocket mr-2"></i>Add Career Pro Package
                </button>
            </div>
        </div>
    </section>
<!-- Social Proof Section -->
<section class="py-20 bg-gray-900">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Header -->
        <div class="text-center mb-16">
            <h2 class="text-4xl font-bold mb-4">Proven Results. Recognized by Industry.</h2>
            <p class="text-xl text-gray-300 max-w-3xl mx-auto">
                Our graduates consistently achieve top-tier outcomes backed by industry-aligned training.
            </p>
        </div>

        <!-- Metrics Grid -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-8 mb-16">
            <div class="text-center">
                <div class="text-5xl font-bold text-blue-400 mb-2">94%</div>
                <div class="text-lg font-semibold text-white mb-1">Graduate Career Success</div>
                <div class="text-sm text-gray-400">Within 6 months of graduation</div>
            </div>
            <div class="text-center">
                <div class="text-5xl font-bold text-blue-400 mb-2">$78K</div>
                <div class="text-lg font-semibold text-white mb-1">Average Starting Salary</div>
                <div class="text-sm text-gray-400">+45% from previous role</div>
            </div>
            <div class="text-center">
                <div class="text-5xl font-bold text-blue-400 mb-2">92%</div>
                <div class="text-lg font-semibold text-white mb-1">Certification Pass Rate</div>
                <div class="text-sm text-gray-400">First attempt success</div>
            </div>
            <div class="text-center">
                <div class="text-5xl font-bold text-blue-400 mb-2">98%</div>
                <div class="text-lg font-semibold text-white mb-1">Student Satisfaction</div>
                <div class="text-sm text-gray-400">5-star program rating</div>
            </div>
        </div>

        <!-- Industry Partnerships -->
        <div class="mb-16">
            <h3 class="text-2xl font-bold text-center mb-8">Industry Partnerships & Recognition</h3>
            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-8 items-center justify-center">
                <div class="text-center">
                    <div class="bg-white p-4 rounded-lg mb-2 hover:scale-105 transition-transform duration-300">
                        <div class="text-blue-600 font-bold text-sm">CompTIA</div>
                        <div class="text-xs text-gray-600">Authorized</div>
                    </div>
                </div>
                <div class="text-center">
                    <div class="bg-white p-4 rounded-lg mb-2 hover:scale-105 transition-transform duration-300">
                        <div class="text-orange-500 font-bold text-sm">AWS</div>
                        <div class="text-xs text-gray-600">Partner</div>
                    </div>
                </div>
                <div class="text-center">
                    <div class="bg-white p-4 rounded-lg mb-2 hover:scale-105 transition-transform duration-300">
                        <div class="text-blue-500 font-bold text-sm">Azure</div>
                        <div class="text-xs text-gray-600">Partner</div>
                    </div>
                </div>
                <div class="text-center">
                    <div class="bg-white p-4 rounded-lg mb-2 hover:scale-105 transition-transform duration-300">
                        <div class="text-green-600 font-bold text-sm">(ISC)²</div>
                        <div class="text-xs text-gray-600">Endorsed</div>
                    </div>
                </div>
                <div class="text-center">
                    <div class="bg-white p-4 rounded-lg mb-2 hover:scale-105 transition-transform duration-300">
                        <div class="text-red-600 font-bold text-sm">ISACA</div>
                        <div class="text-xs text-gray-600">Member</div>
                    </div>
                </div>
                <div class="text-center">
                    <div class="bg-white p-4 rounded-lg mb-2 hover:scale-105 transition-transform duration-300">
                        <div class="text-blue-800 font-bold text-sm">NIST</div>
                        <div class="text-xs text-gray-600">Aligned</div>
                    </div>
                </div>
            </div>
            <p class="text-xs text-gray-400 text-center mt-4">
                Logos are trademarks of their respective owners. Inclusion does not imply endorsement.
            </p>
        </div>

        <!-- Tech Companies -->
        <div class="mb-12">
            <h3 class="text-2xl font-bold text-center mb-8">Our Network Spans Leading Companies</h3>
            <div class="grid grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-8 items-center justify-center">
                <div class="text-center">
                    <div class="bg-gray-800 p-6 rounded-lg hover:bg-gray-700 transition-colors duration-300">
                        <div class="text-orange-400 font-bold">Amazon</div>
                    </div>
                </div>
                <div class="text-center">
                    <div class="bg-gray-800 p-6 rounded-lg hover:bg-gray-700 transition-colors duration-300">
                        <div class="text-red-400 font-bold">Google</div>
                    </div>
                </div>
                <div class="text-center">
                    <div class="bg-gray-800 p-6 rounded-lg hover:bg-gray-700 transition-colors duration-300">
                        <div class="text-red-600 font-bold">Netflix</div>
                    </div>
                </div>
                <div class="text-center">
                    <div class="bg-gray-800 p-6 rounded-lg hover:bg-gray-700 transition-colors duration-300">
                        <div class="text-blue-400 font-bold">Meta</div>
                    </div>
                </div>
                <div class="text-center">
                    <div class="bg-gray-800 p-6 rounded-lg hover:bg-gray-700 transition-colors duration-300">
                        <div class="text-blue-500 font-bold">PayPal</div>
                    </div>
                </div>
                <div class="text-center">
                    <div class="bg-gray-800 p-6 rounded-lg hover:bg-gray-700 transition-colors duration-300">
                        <div class="text-yellow-500 font-bold">Visa</div>
                    </div>
                </div>
                <div class="text-center">
                    <div class="bg-gray-800 p-6 rounded-lg hover:bg-gray-700 transition-colors duration-300">
                        <div class="text-red-500 font-bold">CVS Health</div>
                    </div>
                </div>
                <div class="text-center">
                    <div class="bg-gray-800 p-6 rounded-lg hover:bg-gray-700 transition-colors duration-300">
                        <div class="text-blue-600 font-bold">Walmart</div>
                    </div>
                </div>
                <div class="text-center">
                    <div class="bg-gray-800 p-6 rounded-lg hover:bg-gray-700 transition-colors duration-300">
                        <div class="text-gray-300 font-bold">Nike</div>
                    </div>
                </div>
                <div class="text-center">
                    <div class="bg-gray-800 p-6 rounded-lg hover:bg-gray-700 transition-colors duration-300">
                        <div class="text-yellow-400 font-bold">eBay</div>
                    </div>
                </div>
                <div class="text-center">
                    <div class="bg-gray-800 p-6 rounded-lg hover:bg-gray-700 transition-colors duration-300">
                        <div class="text-blue-500 font-bold">Booking.com</div>
                    </div>
                </div>
                <div class="text-center">
                    <div class="bg-gray-800 p-6 rounded-lg hover:bg-gray-700 transition-colors duration-300">
                        <div class="text-green-400 font-bold">Microsoft</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Final CTA -->
        <div class="text-center">
            <p class="text-xl text-blue-400 font-semibold">
                Join 500+ professionals who advanced their careers with TechStep.
            </p>
        </div>
    </div>
</section>

    <!-- Footer -->
    <footer class="bg-gray-900 py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid md:grid-cols-4 gap-8">
                <div>
                    <div class="logo-container mb-4">
                        <div class="logo-icon"></div>
                        <span class="logo-text">TechStep</span>
                    </div>
                    <p class="text-gray-300">Accelerating cybersecurity careers through expert training and mentorship.</p>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">Courses</h3>
                    <ul class="space-y-2 text-gray-300">
                        <li><a href="#" class="hover:text-blue-400">SOC Analyst</a></li>
                        <li><a href="#" class="hover:text-blue-400">Threat Detection</a></li>
                        <li><a href="#" class="hover:text-blue-400">Cloud Security</a></li>
                        <li><a href="#" class="hover:text-blue-400">GRC Essentials</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">Support</h3>
                    <ul class="space-y-2 text-gray-300">
                        <li><a href="mailto:support@techstepfoundation.org" class="hover:text-blue-400">
                            <i class="fas fa-envelope mr-2"></i>Email Support
                        </a></li>
                        <li><a href="#" class="hover:text-blue-400">Help Center</a></li>
                        <li><a href="#" class="hover:text-blue-400">Community</a></li>
                        <li><a href="#" class="hover:text-blue-400">Resources</a></li>
                    </ul>
                    <div class="mt-4 p-3 bg-gray-800 border border-gray-700 rounded-lg">
                        <p class="text-sm text-gray-400 mb-1">Need assistance?</p>
                        <a href="mailto:support@techstepfoundation.org" class="text-blue-400 hover:text-blue-300 text-sm font-medium">
                            support@techstepfoundation.org
                        </a>
                    </div>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">Connect</h3>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-300 hover:text-blue-400"><i class="fab fa-linkedin text-xl"></i></a>
                        <a href="#" class="text-gray-300 hover:text-blue-400"><i class="fab fa-twitter text-xl"></i></a>
                        <a href="#" class="text-gray-300 hover:text-blue-400"><i class="fab fa-youtube text-xl"></i></a>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-8 text-center text-gray-400">
                <p>&copy; 2024 TechStep. All rights reserved.</p>
                <p class="mt-2 text-sm">Powered by iPS Global Consulting</p>
            </div>
        </div>
    </footer>

    <script>
        // Global variables
        let selectedCourses = [];
        let currentLearningType = 'self-paced';
        let paymentPlanAgreed = false;
        let stripe = null; // Will be initialized after Stripe SDK loads

        // Initialize Mobile Menu and Trial Navigation Immediately
        function initializeMobileNavigation() {
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const mobileMenu = document.getElementById('mobileMenu');
            const mobileAdminLoginBtn = document.getElementById('mobileAdminLoginBtn');

            console.log('Mobile menu elements:', { mobileMenuBtn, mobileMenu }); // Debug log

            if (mobileMenuBtn && mobileMenu) {
                mobileMenuBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('Mobile menu button clicked'); // Debug log
                    
                    mobileMenu.classList.toggle('hidden');
                    const icon = mobileMenuBtn.querySelector('i');
                    if (mobileMenu.classList.contains('hidden')) {
                        icon.className = 'fas fa-bars text-xl';
                    } else {
                        icon.className = 'fas fa-times text-xl';
                    }
                });

                // Close mobile menu when clicking on links
                mobileMenu.querySelectorAll('a').forEach(link => {
                    link.addEventListener('click', function() {
                        mobileMenu.classList.add('hidden');
                        mobileMenuBtn.querySelector('i').className = 'fas fa-bars text-xl';
                    });
                });

                // Connect mobile login button to desktop functionality
                if (mobileAdminLoginBtn) {
                    mobileAdminLoginBtn.addEventListener('click', function() {
                        mobileMenu.classList.add('hidden');
                        mobileMenuBtn.querySelector('i').className = 'fas fa-bars text-xl';
                        // Trigger the same functionality as desktop login button
                        document.getElementById('adminLoginBtn')?.click();
                    });
                }
            } else {
                console.error('Mobile menu elements not found!', { mobileMenuBtn, mobileMenu });
            }
        }

        // Mobile courses dropdown toggle
        function toggleMobileCourses() {
            const dropdown = document.getElementById('mobileCoursesDropdown');
            const chevron = document.getElementById('mobileCourseChevron');
            
            dropdown.classList.toggle('hidden');
            if (dropdown.classList.contains('hidden')) {
                chevron.className = 'fas fa-chevron-down text-xs';
            } else {
                chevron.className = 'fas fa-chevron-up text-xs';
            }
        }

        function initializeDemoNavigation() {
            // Demo navigation is now handled by onclick events in HTML
            console.log('Demo navigation initialized');
        }

        // Initialize immediately when script runs
        setTimeout(function() {
            initializeMobileNavigation();
            initializeDemoNavigation();
            initializeMainProgramButton();
        }, 100);
        
        // Initialize main program button functionality
        function initializeMainProgramButton() {
            const mainProgramBtn = document.getElementById('mainProgramBtn');
            if (mainProgramBtn) {
                mainProgramBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('Main program button clicked'); // Debug log
                    // Show trial promotion modal
                    showTrialPromotionModal();
                });
            } else {
                console.error('Main program button not found!');
            }
        }

        // Main program button handler moved to initializeMainProgramButton function

        // Trial Promotion Modal
        function showTrialPromotionModal() {
            const modalHTML = `
                <div id="trialPromotionModal" class="modal-overlay show">
                    <div class="modal-content max-w-lg">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold text-white">Experience Before You Enroll</h2>
                            <button id="closeTrialPromotion" class="text-gray-400 hover:text-white">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <div class="text-center mb-6">
                            <div class="w-20 h-20 bg-gradient-to-r from-blue-600 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-graduation-cap text-3xl text-white"></i>
                            </div>
                            <h3 class="text-xl font-bold text-white mb-2">Try Our Complete Learning Platform</h3>
                            <p class="text-gray-300">Get hands-on experience with real SOC analyst training before enrolling in the full program.</p>
                        </div>
                        
                        <div class="bg-gradient-to-r from-blue-900/50 to-purple-900/50 rounded-lg p-6 mb-6">
                            <h4 class="font-bold text-white mb-3">🎯 Free Demo Includes:</h4>
                            <div class="grid grid-cols-2 gap-3 text-sm text-blue-100">
                                <div class="flex items-center">
                                    <i class="fas fa-check-circle text-green-400 mr-2"></i>
                                    <span>Complete LMS experience</span>
                                </div>
                                <div class="flex items-center">
                                    <i class="fas fa-check-circle text-green-400 mr-2"></i>
                                    <span>3 hands-on modules</span>
                                </div>
                                <div class="flex items-center">
                                    <i class="fas fa-check-circle text-green-400 mr-2"></i>
                                    <span>Real SIEM environment</span>
                                </div>
                                <div class="flex items-center">
                                    <i class="fas fa-check-circle text-green-400 mr-2"></i>
                                    <span>Progress tracking</span>
                                </div>
                                <div class="flex items-center">
                                    <i class="fas fa-check-circle text-green-400 mr-2"></i>
                                    <span>Achievement badges</span>
                                </div>
                                <div class="flex items-center">
                                    <i class="fas fa-check-circle text-green-400 mr-2"></i>
                                    <span>Completion certificate</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="space-y-3">
                            <button onclick="window.location.href='demo/'" class="w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-4 px-6 rounded-lg transition duration-300">
                                <i class="fas fa-play mr-2"></i>Start Free Demo Now
                            </button>
                            <button onclick="scrollToCourses(); document.getElementById('trialPromotionModal').remove();" class="w-full bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-lg transition duration-300">
                                Skip to Full Program
                            </button>
                        </div>
                        
                        <div class="mt-4 text-center">
                            <p class="text-xs text-gray-500">
                                <i class="fas fa-clock mr-1"></i>
                                Takes 30-60 minutes • No commitment required
                            </p>
                        </div>
                    </div>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', modalHTML);

            // Close modal handler
            document.getElementById('closeTrialPromotion').addEventListener('click', function() {
                document.getElementById('trialPromotionModal').remove();
            });
        }

        // Exit Intent Trial Modal (can be triggered programmatically)
        // Demo modal function for programmatic access
        function openDemoModal() {
            window.location.href = 'demo/';
        }

        // Expose openDemoModal globally for programmatic access
        window.openDemoModal = openDemoModal;

        // Dashboard Modal Functionality
        const loginBtn = document.getElementById('loginBtn');
        const dashboardModal = document.getElementById('dashboardModal');
        const closeModal = document.getElementById('closeModal');

        if (loginBtn) loginBtn.addEventListener('click', function() {
            dashboardModal.classList.add('show');
            setTimeout(() => {
                animateDashboardProgress();
            }, 300);
        });

        if (closeModal) closeModal.addEventListener('click', function() {
            dashboardModal.classList.remove('show');
        });

        if (dashboardModal) dashboardModal.addEventListener('click', function(e) {
            if (e.target === dashboardModal) {
                dashboardModal.classList.remove('show');
            }
        });

        function animateDashboardProgress() {
            const progressBars = document.querySelectorAll('.dashboard-progress-fill');
            progressBars.forEach(bar => {
                const targetProgress = bar.getAttribute('data-progress');
                setTimeout(() => {
                    bar.style.width = targetProgress + '%';
                }, 200);
            });
        }

        // Dashboard action buttons
        document.querySelectorAll('.dashboard-action-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const btnClass = this.className;
                let message = '';
                
                if (btnClass.includes('btn-continue')) {
                    message = 'Redirecting to your current course...';
                } else if (btnClass.includes('btn-schedule')) {
                    message = 'Opening scheduling interface...';
                } else if (btnClass.includes('btn-certificates')) {
                    message = 'Loading your certificates...';
                } else if (btnClass.includes('btn-podcast')) {
                    message = 'Playing latest podcast episode...';
                }
                
                const originalText = this.innerHTML;
                this.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>' + message;
                this.style.opacity = '0.7';
                
                setTimeout(() => {
                    this.innerHTML = originalText;
                    this.style.opacity = '1';
                }, 2000);
            });
        });

        // Course functionality - will be initialized in DOMContentLoaded
        let learningTypeInputs, mentorBookingSection, courseCards, courseCheckboxes, cartItems, totalPriceElement;
        
        function initializeCourseSelection() {
            learningTypeInputs = document.querySelectorAll('input[name="learning-type"]');
            mentorBookingSection = document.getElementById('mentor-booking-section');
            courseCards = document.querySelectorAll('.course-card');
            courseCheckboxes = document.querySelectorAll('.course-checkbox');
            cartItems = document.getElementById('cart-items');
            totalPriceElement = document.getElementById('total-price');
            
            console.log('Initializing course selection...');
            console.log('Elements found:', {
                learningTypeInputs: learningTypeInputs.length,
                courseCards: courseCards.length,
                courseCheckboxes: courseCheckboxes.length,
                cartItems: !!cartItems,
                totalPriceElement: !!totalPriceElement
            });

        learningTypeInputs.forEach(input => {
            input.addEventListener('change', function() {
                currentLearningType = this.value;
                
                if (this.value === 'with-mentor') {
                    mentorBookingSection.classList.add('show');
                    courseCards.forEach(card => {
                        card.querySelector('.self-paced-price').classList.add('hidden');
                        card.querySelector('.mentor-price').classList.remove('hidden');
                        card.querySelector('.self-paced-desc').classList.add('hidden');
                        card.querySelector('.mentor-desc').classList.remove('hidden');
                    });
                } else {
                    mentorBookingSection.classList.remove('show');
                    courseCards.forEach(card => {
                        card.querySelector('.self-paced-price').classList.remove('hidden');
                        card.querySelector('.mentor-price').classList.add('hidden');
                        card.querySelector('.self-paced-desc').classList.remove('hidden');
                        card.querySelector('.mentor-desc').classList.add('hidden');
                    });
                }
                
                updateCart();
            });
        });

            // Course selection functionality
            console.log('Found course checkboxes:', courseCheckboxes.length);
            console.log('Course checkboxes:', courseCheckboxes);
            courseCheckboxes.forEach((checkbox, index) => {
                console.log(`Setting up listener for checkbox ${index}:`, checkbox);
                checkbox.addEventListener('change', function() {
                    console.log('Checkbox changed:', this.checked, 'Checkbox:', this);
                const courseCard = this.closest('.course-card');
                const courseName = courseCard.querySelector('h3').textContent;
                const selfPrice = parseInt(this.dataset.selfPrice);
                const mentorPrice = parseInt(this.dataset.mentorPrice);
                
                console.log('Course data:', { courseName, selfPrice, mentorPrice });

                if (this.checked) {
                    courseCard.classList.add('selected');
                    selectedCourses.push({
                        name: courseName,
                        selfPrice: selfPrice,
                        mentorPrice: mentorPrice
                    });
                } else {
                    courseCard.classList.remove('selected');
                    selectedCourses = selectedCourses.filter(course => course.name !== courseName);
                }

                console.log('Selected courses:', selectedCourses);
                updateCart();
            });
        });

            // Payment plan change handlers
        document.querySelectorAll('input[name="payment-plan"]').forEach(radio => {
            radio.addEventListener('change', function() {
                const selectedPlan = this.value;
                
                // Update payment authorization text dynamically
                updatePaymentAuthorizationText(selectedPlan);
                
                // Show exclusive selection message
                if (selectedPlan === 'full') {
                    showPaymentSelectionMessage('Pay Once selected - You\'ll pay the full amount upfront with 5% savings.');
                    hidePaymentPlanRequirements();
                    enablePaymentButtons();
                } else if (selectedPlan === 'monthly') {
                    showPaymentSelectionMessage('Monthly Plan selected - You\'ll pay $750 today and $375/month for 6 months.');
                    showPaymentPlanAgreement(selectedPlan);
                }
                
                updatePaymentDisplays();
            });
        });
        }

        // Terms of Service and Payment Terms functions
        function showTermsOfService() {
            const termsHTML = `
                <div id="termsModal" class="modal-overlay">
                    <div class="modal-content max-w-4xl max-h-90vh overflow-y-auto">
                        <div class="flex justify-between items-center mb-6 sticky top-0 bg-gray-700 p-4 -m-4 mb-4 border-b border-gray-600">
                            <h2 class="text-2xl font-bold text-white">Terms of Service</h2>
                            <button onclick="document.getElementById('termsModal').remove()" class="text-gray-400 hover:text-white text-2xl">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <div class="space-y-6 text-gray-300">
                            <div>
                                <h3 class="text-lg font-bold text-white mb-3">1. ACCEPTANCE OF TERMS</h3>
                                <p>By accessing and using the TechStep cybersecurity training platform, you agree to be bound by these Terms of Service and all applicable laws and regulations. If you do not agree with any part of these terms, you are prohibited from using this service.</p>
                            </div>
                            
                            <div>
                                <h3 class="text-lg font-bold text-white mb-3">2. COURSE ACCESS AND CONTENT</h3>
                                <ul class="list-disc list-inside space-y-2 ml-4">
                                    <li>Course access is granted upon full payment or successful enrollment in a payment plan</li>
                                    <li>Content is for personal, non-commercial educational use only</li>
                                    <li>Sharing course materials or credentials is strictly prohibited</li>
                                    <li>Course access is valid for 12 months from enrollment date</li>
                                </ul>
                            </div>
                            
                            <div>
                                <h3 class="text-lg font-bold text-white mb-3">3. USER RESPONSIBILITIES</h3>
                                <ul class="list-disc list-inside space-y-2 ml-4">
                                    <li>Maintain the confidentiality of your account credentials</li>
                                    <li>Use the platform in accordance with all applicable laws</li>
                                    <li>Refrain from attempting to access unauthorized areas</li>
                                    <li>Report security vulnerabilities responsibly</li>
                                </ul>
                            </div>
                            
                            <div>
                                <h3 class="text-lg font-bold text-white mb-3">4. INTELLECTUAL PROPERTY</h3>
                                <p>All course content, including videos, materials, assessments, and documentation, is proprietary to TechStep and protected by copyright law. Users may not reproduce, distribute, or create derivative works from our content.</p>
                            </div>
                            
                            <div>
                                <h3 class="text-lg font-bold text-white mb-3">5. REFUND POLICY</h3>
                                <ul class="list-disc list-inside space-y-2 ml-4">
                                    <li>7-day money-back guarantee for full payment options</li>
                                    <li>Refunds processed within 5-7 business days</li>
                                    <li>Payment plan enrollments: refund available before second payment</li>
                                    <li>Course completion over 25% disqualifies for refund</li>
                                </ul>
                            </div>
                            
                            <div>
                                <h3 class="text-lg font-bold text-white mb-3">6. LIMITATION OF LIABILITY</h3>
                                <p>TechStep shall not be liable for any indirect, incidental, special, or consequential damages arising from your use of our services. Our total liability is limited to the amount paid for the service.</p>
                            </div>
                            
                            <div class="bg-gray-800 border border-gray-600 rounded-lg p-4">
                                <h4 class="font-semibold text-white mb-2">Contact Information</h4>
                                <p class="text-sm">
                                    For questions about these Terms of Service:<br>
                                    <strong>TechStep Foundation</strong><br>
                                    Email: support@techstepfoundation.org<br>
                                    Phone: 1-301-AJW-10MP
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', termsHTML);
            document.getElementById('termsModal').classList.add('show');
        }
        
        function showPaymentTerms() {
            const paymentTermsHTML = `
                <div id="paymentTermsModal" class="modal-overlay">
                    <div class="modal-content max-w-4xl max-h-90vh overflow-y-auto">
                        <div class="flex justify-between items-center mb-6 sticky top-0 bg-gray-700 p-4 -m-4 mb-4 border-b border-gray-600">
                            <h2 class="text-2xl font-bold text-white">Payment Terms</h2>
                            <button onclick="document.getElementById('paymentTermsModal').remove()" class="text-gray-400 hover:text-white text-2xl">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <div class="space-y-6 text-gray-300">
                            <div>
                                <h3 class="text-lg font-bold text-white mb-3">1. PAYMENT OPTIONS</h3>
                                <ul class="list-disc list-inside space-y-2 ml-4">
                                    <li><strong>Full Payment:</strong> Pay the complete course fee upfront and receive a 5% discount</li>
                                    <li><strong>Monthly Plan:</strong> Pay an initial down payment followed by monthly installments</li>
                                    <li>All payments are processed securely through Stripe and PayPal</li>
                                </ul>
                            </div>
                            
                            <div>
                                <h3 class="text-lg font-bold text-white mb-3">2. MONTHLY PAYMENT PLAN TERMS</h3>
                                <ul class="list-disc list-inside space-y-2 ml-4">
                                    <li>Down payment required at enrollment: $750</li>
                                    <li>Monthly payment amount: $375 for 6 consecutive months</li>
                                    <li>Total cost under monthly plan: $3,000 (no discount applied)</li>
                                    <li>Automatic billing on the same date each month</li>
                                    <li>Failed payments may result in course access suspension</li>
                                </ul>
                            </div>
                            
                            <div>
                                <h3 class="text-lg font-bold text-white mb-3">3. BILLING AND CHARGES</h3>
                                <ul class="list-disc list-inside space-y-2 ml-4">
                                    <li>All fees are in USD and exclude applicable taxes</li>
                                    <li>Payment methods accepted: Credit/Debit cards, PayPal, Apple Pay</li>
                                    <li>Billing address verification required for security</li>
                                    <li>Course access granted immediately upon successful payment</li>
                                </ul>
                            </div>
                            
                            <div>
                                <h3 class="text-lg font-bold text-white mb-3">4. CANCELLATION AND REFUNDS</h3>
                                <ul class="list-disc list-inside space-y-2 ml-4">
                                    <li>Monthly plans: Cancel anytime with 7-day notice</li>
                                    <li>Refunds: 7-day money-back guarantee on all purchases</li>
                                    <li>Partial refunds available for payment plan cancellations before 2nd payment</li>
                                    <li>Processing time: 5-7 business days for refunds</li>
                                </ul>
                            </div>
                            
                            <div>
                                <h3 class="text-lg font-bold text-white mb-3">5. FAILED PAYMENTS</h3>
                                <ul class="list-disc list-inside space-y-2 ml-4">
                                    <li>Automatic retry within 3 days of failed payment</li>
                                    <li>Email notification sent for payment failures</li>
                                    <li>Course access suspended after 7 days of non-payment</li>
                                    <li>Account reactivation available upon successful payment</li>
                                </ul>
                            </div>
                            
                            <div>
                                <h3 class="text-lg font-bold text-white mb-3">6. SECURITY AND PRIVACY</h3>
                                <p>All payment information is encrypted using industry-standard SSL technology. We do not store credit card details on our servers. Payment processing is handled by certified PCI DSS compliant providers.</p>
                            </div>
                            
                            <div class="bg-gray-800 border border-gray-600 rounded-lg p-4">
                                <h4 class="font-semibold text-white mb-2">Payment Support</h4>
                                <p class="text-sm">
                                    For payment-related questions or issues:<br>
                                    <strong>TechStep Billing Department</strong><br>
                                    Email: billing@techstepfoundation.org<br>
                                    Phone: 1-301-AJW-10MP<br>
                                    Business Hours: Monday-Friday, 9 AM - 5 PM EST
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', paymentTermsHTML);
            document.getElementById('paymentTermsModal').classList.add('show');
        }

        // Show enhanced payment selection message with clear exclusivity notice
        function showPaymentSelectionMessage(message) {
            // Remove any existing message
            const existingMessage = document.getElementById('payment-selection-message');
            if (existingMessage) {
                existingMessage.remove();
            }
            
            // Create enhanced message with exclusivity notice
            const messageHTML = `
                <div id="payment-selection-message" class="bg-gradient-to-r from-blue-900/30 to-green-900/30 border border-blue-500/50 rounded-lg p-4 mb-4">
                    <div class="text-center mb-2">
                        <div class="flex items-center justify-center mb-2">
                            <i class="fas fa-check-circle text-green-400 mr-2 text-lg"></i>
                            <span class="text-white font-semibold">Payment Option Selected</span>
                        </div>
                        <p class="text-blue-200 text-sm">${message}</p>
                    </div>
                    
                    <div class="bg-yellow-900/20 border border-yellow-500/30 rounded-lg p-3 mt-3">
                        <div class="flex items-start">
                            <i class="fas fa-info-circle text-yellow-400 mr-2 mt-0.5 text-sm"></i>
                            <div class="text-xs text-yellow-200">
                                <strong>Note:</strong> You can only select one payment option. 
                                Selecting a different option will replace your current choice.
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-3 text-center">
                        <button onclick="document.getElementById('payment-selection-message').remove()" 
                                class="text-gray-400 hover:text-white text-xs underline">
                            Dismiss
                        </button>
                    </div>
                </div>
            `;
            
            // Insert message after payment plan selector
            const paymentPlanSelector = document.getElementById('payment-plan-selector');
            if (paymentPlanSelector) {
                paymentPlanSelector.insertAdjacentHTML('afterend', messageHTML);
            }
        }

        // Add to Cart function with single selection logic
        function addToCart(courseId, courseName, price) {
            console.log('🛒 Adding to cart:', { courseId, courseName, price });
            
            try {
                // Get cart elements directly (more reliable)
                const cartItems = document.getElementById('cart-items');
                const totalElement = document.getElementById('total-price');
                const paymentSelector = document.getElementById('payment-plan-selector');
                const paymentButtons = document.getElementById('payment-buttons-container');
                const securityNotice = document.getElementById('security-notice');
                const noCoursesMessage = document.getElementById('no-courses-message');
                
                console.log('📋 Cart elements found:', {
                    cartItems: !!cartItems,
                    totalElement: !!totalElement,
                    paymentSelector: !!paymentSelector,
                    paymentButtons: !!paymentButtons
                });
                
                // Check if course is already in cart
                const existingCourse = selectedCourses.find(course => course.id === courseId);
                if (existingCourse) {
                    alert('Course is already in your cart!');
                    return;
                }
                
                // Clear any existing courses (single selection logic)
                if (selectedCourses.length > 0) {
                    const shouldReplace = confirm(`You currently have "${selectedCourses[0].name}" in your cart. Replace it with "${courseName}"?`);
                    if (!shouldReplace) {
                        return;
                    }
                    
                    // Reset previous course button
                    resetAllCourseButtons();
                    selectedCourses = [];
                }
                
                // Add course to selected courses
                selectedCourses.push({
                    id: courseId,
                    name: courseName,
                    selfPrice: price,
                    mentorPrice: price + 2000 // Add $2000 for mentor option
                });
                
                console.log('✅ Course added to selectedCourses:', selectedCourses);
                
                // Update cart display directly
                if (cartItems) {
                    cartItems.innerHTML = `
                        <div class="flex justify-between items-center py-2 bg-blue-900/20 rounded p-2">
                            <span class="text-white font-medium">${courseName}</span>
                            <span class="text-green-400 font-semibold">✓ Selected</span>
                        </div>
                    `;
                    console.log('✅ Cart items updated');
                }
                
                if (totalElement) {
                    totalElement.textContent = `$${price.toLocaleString()}`;
                    console.log('✅ Total price updated to:', price);
                }
                
                // Hide "no courses" message
                if (noCoursesMessage) {
                    noCoursesMessage.style.display = 'none';
                    console.log('✅ No courses message hidden');
                }
                
                // Show payment options
                if (paymentSelector) {
                    paymentSelector.classList.remove('hidden');
                    console.log('✅ Payment selector shown');
                }
                
                if (paymentButtons) {
                    paymentButtons.classList.remove('hidden');
                    console.log('✅ Payment buttons shown');
                }
                
                if (securityNotice) {
                    securityNotice.classList.remove('hidden');
                    console.log('✅ Security notice shown');
                }
                
                // Update payment displays with course pricing
                updatePaymentDisplays();
                
                // Enable payment button now that course is selected
                enablePaymentButton();
                
                // Update button state for selected course
                updateCourseButtonState(courseId, 'selected');
                
                // Show success notification
                alert(`✅ ${courseName} added to cart! Scroll down to see payment options.`);
                
                // Scroll to cart section
                setTimeout(() => {
                    const orderSummary = document.querySelector('.bg-gray-700.p-6.rounded-lg.max-w-md.mx-auto');
                    if (orderSummary) {
                        orderSummary.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        console.log('✅ Scrolled to order summary');
                    }
                }, 500);
                
            } catch (error) {
                console.error('❌ Error in addToCart:', error);
                alert('There was an issue adding the course to cart. Please refresh and try again.');
            }
        }
        
        // Reset all course buttons to default state
        function resetAllCourseButtons() {
            document.querySelectorAll('.add-to-cart-btn').forEach(btn => {
                btn.innerHTML = '<i class="fas fa-shopping-cart mr-2"></i>Add to Cart';
                btn.className = 'w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300';
                btn.disabled = false;
                // Restore onclick handler
                const courseId = btn.getAttribute('data-course-id');
                if (courseId) {
                    btn.onclick = () => {
                        const courseName = btn.getAttribute('data-course-name');
                        const price = parseInt(btn.getAttribute('data-price'));
                        addToCart(courseId, courseName, price);
                    };
                }
            });
        }
        
        // Update course button state
        function updateCourseButtonState(courseId, state) {
            // Find button by course ID in data attribute
            const button = document.querySelector(`[data-course="${courseId}"] .add-to-cart-btn`) || 
                          document.querySelector(`[data-course-id="${courseId}"]`);
            
            console.log('🔘 Updating button state for course:', courseId, 'Button found:', !!button);
            
            if (button) {
                if (state === 'selected') {
                    button.innerHTML = '<i class="fas fa-check mr-2"></i>Added to Cart';
                    button.className = 'add-to-cart-btn w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg cursor-default';
                    button.disabled = true;
                    button.onclick = null; // Disable click
                } else {
                    button.innerHTML = '<i class="fas fa-shopping-cart mr-2"></i>Add to Cart';
                    button.className = 'add-to-cart-btn w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300';
                    button.disabled = false;
                }
                console.log('✅ Button state updated to:', state);
            } else {
                console.warn('⚠️ Button not found for course:', courseId);
            }
        }
        
        // Update payment authorization text based on selected plan
        function updatePaymentAuthorizationText(selectedPlan) {
            const authText = document.getElementById('dynamic-payment-text');
            if (authText) {
                if (selectedPlan === 'full') {
                    authText.textContent = 'I authorize TechStep Foundation to charge my payment method the full course amount with 5% discount applied.';
                } else if (selectedPlan === 'monthly') {
                    authText.textContent = 'I authorize TechStep Foundation to charge my payment method $750 today and $375 monthly for 6 consecutive months.';
                }
            }
        }

        function updateCart() {
            console.log('updateCart called, selectedCourses:', selectedCourses);
            if (selectedCourses.length === 0) {
                cartItems.innerHTML = '<p class="text-gray-400">Select courses to see pricing</p>';
                totalPriceElement.textContent = '$0';
                document.getElementById('payment-buttons-container').classList.add('hidden');
                document.getElementById('payment-plan-selector').classList.add('hidden');
                document.getElementById('security-notice').classList.add('hidden');
                return;
            }

            let total = 0;
            let cartHTML = '';

            selectedCourses.forEach(course => {
                const price = currentLearningType === 'with-mentor' ? course.mentorPrice : course.selfPrice;
                total += price;
                cartHTML += `
                    <div class="flex justify-between">
                        <span class="text-sm">${course.name}</span>
                        <span class="text-sm">$${price.toLocaleString()}</span>
                    </div>
                `;
            });

            cartItems.innerHTML = cartHTML;
            totalPriceElement.textContent = `$${total.toLocaleString()}`;

            // Update payment plan displays
            console.log('Updating payment displays...');
            updatePaymentDisplays();

            // Show payment options
            console.log('Showing payment options...');
            const paymentPlanSelector = document.getElementById('payment-plan-selector');
            const paymentButtonsContainer = document.getElementById('payment-buttons-container');
            const securityNotice = document.getElementById('security-notice');
            
            console.log('Payment elements:', {
                paymentPlanSelector: !!paymentPlanSelector,
                paymentButtonsContainer: !!paymentButtonsContainer,
                securityNotice: !!securityNotice
            });
            
            if (paymentPlanSelector) paymentPlanSelector.classList.remove('hidden');
            if (paymentButtonsContainer) paymentButtonsContainer.classList.remove('hidden');
            if (securityNotice) securityNotice.classList.remove('hidden');

            // Initialize payment handlers
            initializePaymentHandlers();
        }

        function updatePaymentDisplays() {
            console.log('🔄 Updating payment displays...');
            
            if (selectedCourses.length === 0) {
                console.log('⚠️ No courses selected, skipping payment display update');
                return;
            }
            
            const course = selectedCourses[0]; // Single course selection
            const basePrice = course.selfPrice;
            
            // Calculate payment amounts for SOC Analyst (using its specific pricing)
            let fullPayment, downPayment, monthlyPayment;
            
            if (course.id === 'soc-analyst') {
                fullPayment = 2849; // Fixed price for SOC Analyst
                downPayment = 750;
                monthlyPayment = 375;
            } else {
                fullPayment = Math.round(basePrice * 0.95); // 5% discount
                downPayment = Math.round(basePrice * 0.25); // 25% down
                monthlyPayment = Math.round((basePrice - downPayment) / 6); // 6 months
            }
            
            console.log('💰 Payment calculations:', {
                basePrice,
                fullPayment,
                downPayment,
                monthlyPayment
            });
            
            // Update the payment plan cards with actual pricing
            try {
                // Update "Pay Once" option
                const payOncePrice = document.querySelector('input[value="full"] + .payment-option-card .text-2xl.font-bold');
                if (payOncePrice) {
                    payOncePrice.innerHTML = `$${fullPayment.toLocaleString()} <span class="text-sm text-green-300">(5% savings)</span>`;
                }
                
                // Update "Monthly Plan" option  
                const monthlyPrice = document.querySelector('input[value="monthly"] + .payment-option-card .text-2xl.font-bold');
                if (monthlyPrice) {
                    monthlyPrice.textContent = `$${downPayment} down + $${monthlyPayment}/month`;
                }
                
                console.log('✅ Payment displays updated successfully');
            } catch (error) {
                console.error('❌ Error updating payment displays:', error);
            }
        }

        // Enable payment button when course is added to cart
        function enablePaymentButton() {
            const checkoutButton = document.getElementById('stripe-checkout-button');
            const buttonText = document.getElementById('stripe-button-text');
            
            if (checkoutButton && selectedCourses.length > 0) {
                checkoutButton.disabled = false;
                checkoutButton.classList.remove('opacity-50');
                
                if (buttonText) {
                    const course = selectedCourses[0];
                    buttonText.textContent = `Complete Purchase - ${course.name}`;
                }
                
                console.log('✅ Payment button enabled');
            }
        }
        
        // Disable payment button when cart is empty
        function disablePaymentButton() {
            const checkoutButton = document.getElementById('stripe-checkout-button');
            const buttonText = document.getElementById('stripe-button-text');
            
            if (checkoutButton) {
                checkoutButton.disabled = true;
                checkoutButton.classList.add('opacity-50');
                
                if (buttonText) {
                    buttonText.textContent = 'Select a Course to Continue';
                }
                
                console.log('❌ Payment button disabled');
            }
        }

        function calculateTotal() {
            let total = 0;
            selectedCourses.forEach(course => {
                const price = currentLearningType === 'with-mentor' ? course.mentorPrice : course.selfPrice;
                total += price;
            });
            return total;
        }

        function calculatePaymentAmount(planType) {
            const total = calculateTotal();
            
            switch(planType) {
                case 'full':
                    return Math.round(total * 0.95); // 5% discount
                case 'monthly':
                    return Math.round(total / 3);
                case 'weekly':
                    return Math.round(total / 12);
                default:
                    return total;
            }
        }

        // Payment Plan Agreement System
        function showPaymentPlanAgreement(planType) {
            const planDetails = getPlanDetails(planType);
            
            const agreementHTML = `
                <div id="payment-plan-agreement-modal" class="modal-overlay show payment-plan-agreement">
                    <div class="modal-content max-w-4xl max-h-90vh overflow-y-auto">
                        <div class="flex justify-between items-center mb-6 sticky top-0 bg-gray-700 p-4 -m-4 mb-4 border-b border-gray-600">
                            <div>
                                <h3 class="text-2xl font-bold text-blue-400">Payment Plan Agreement</h3>
                                <p class="text-gray-300 text-sm">${planDetails.description}</p>
                            </div>
                            <button id="close-agreement-modal" class="text-gray-400 hover:text-white text-2xl">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <div class="agreement-content">
                            ${generateAgreementContent(planType, planDetails)}
                        </div>
                        
                        <div class="sticky bottom-0 bg-gray-700 p-4 -m-4 mt-4 border-t border-gray-600">
                            <div class="flex items-start mb-4">
                                <input type="checkbox" id="agreement-checkbox" class="mt-1 mr-3 w-5 h-5 text-blue-600">
                                <label for="agreement-checkbox" class="text-sm text-gray-300 cursor-pointer">
                                    I have read, understood, and agree to the terms and conditions of this Payment Plan Agreement. I acknowledge that all payments are non-refundable and that late fees will apply for missed payments.
                                </label>
                            </div>
                            
                            <div class="flex gap-4">
                                <button id="decline-agreement" class="flex-1 border border-gray-500 text-gray-300 py-3 rounded-lg font-semibold hover:bg-gray-600 transition duration-300">
                                    <i class="fas fa-times mr-2"></i>Decline
                                </button>
                                <button id="accept-agreement" disabled class="flex-1 bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed">
                                    <i class="fas fa-check mr-2"></i>Accept & Continue
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', agreementHTML);
            
            // Handle checkbox change
            const agreementCheckbox = document.getElementById('agreement-checkbox');
            if (agreementCheckbox) agreementCheckbox.addEventListener('change', function() {
                document.getElementById('accept-agreement').disabled = !this.checked;
            });
            
            // Handle accept button
            const acceptAgreement = document.getElementById('accept-agreement');
            if (acceptAgreement) acceptAgreement.addEventListener('click', function() {
                paymentPlanAgreed = true;
                document.getElementById('payment-plan-agreement-modal').remove();
                showPaymentPlanRequirements(planType);
                enablePaymentButtons();
                storeAgreementAcceptance(planType);
            });
            
            // Handle decline button
            const declineAgreement = document.getElementById('decline-agreement');
            if (declineAgreement) declineAgreement.addEventListener('click', function() {
                document.querySelector('input[name="payment-plan"][value="full"]').checked = true;
                document.getElementById('payment-plan-agreement-modal').remove();
                paymentPlanAgreed = false;
                updatePaymentDisplays();
            });
            
            // Handle close button
            const closeAgreementModal = document.getElementById('close-agreement-modal');
            if (closeAgreementModal) closeAgreementModal.addEventListener('click', function() {
                document.querySelector('input[name="payment-plan"][value="full"]').checked = true;
                document.getElementById('payment-plan-agreement-modal').remove();
                paymentPlanAgreed = false;
                updatePaymentDisplays();
            });
        }

        function getPlanDetails(planType) {
            const total = calculateTotal();
            
            const plans = {
                monthly: {
                    description: "3 Monthly Payments",
                    amount: Math.round(total / 3),
                    frequency: "monthly",
                    totalPayments: 3,
                    billingCycle: "monthly",
                    firstPayment: "today",
                    subsequentPayments: "1st of each month"
                },
                weekly: {
                    description: "12 Weekly Payments",
                    amount: Math.round(total / 12),
                    frequency: "weekly",
                    totalPayments: 12,
                    billingCycle: "weekly",
                    firstPayment: "today",
                    subsequentPayments: "same day each week"
                }
            };
            
            return plans[planType];
        }

        function generateAgreementContent(planType, planDetails) {
            const currentDate = new Date().toLocaleDateString();
            const total = calculateTotal();
            
            return `
                <div class="agreement-text space-y-6 text-sm leading-relaxed">
                    <div class="agreement-highlight">
                        <h4 class="font-semibold text-blue-400 mb-2 flex items-center">
                            <i class="fas fa-info-circle mr-2"></i>Agreement Summary
                        </h4>
                        <div class="grid md:grid-cols-2 gap-4 text-sm">
                            <div>
                                <strong>Payment Plan:</strong> ${planDetails.description}<br>
                                <strong>Payment Amount:</strong> $${planDetails.amount.toLocaleString()} per ${planDetails.frequency}<br>
                                <strong>Total Payments:</strong> ${planDetails.totalPayments}
                            </div>
                            <div>
                                <strong>Total Course Cost:</strong> $${total.toLocaleString()}<br>
                                <strong>First Payment:</strong> ${planDetails.firstPayment}<br>
                                <strong>Billing Cycle:</strong> ${planDetails.subsequentPayments}
                            </div>
                        </div>
                    </div>

                    <div class="agreement-section">
                        <h4 class="font-semibold text-lg mb-3 text-white">PAYMENT PLAN AGREEMENT</h4>
                        <p class="mb-4">
                            This Payment Plan Agreement ("Agreement") is entered into on <strong>${currentDate}</strong> between TechStep ("Company," "we," "us," or "our") and the customer ("Customer," "you," or "your") for the purchase of cybersecurity training courses.
                        </p>
                    </div>

                    <div class="agreement-section">
                        <h5 class="font-semibold text-white mb-2">1. PAYMENT TERMS</h5>
                        <ul class="list-disc list-inside space-y-2 ml-4">
                            <li>You agree to pay <strong>$${planDetails.amount.toLocaleString()}</strong> ${planDetails.frequency} for <strong>${planDetails.totalPayments}</strong> consecutive ${planDetails.frequency === 'weekly' ? 'weeks' : 'months'}.</li>
                            <li>Your first payment of <strong>$${planDetails.amount.toLocaleString()}</strong> is due immediately upon acceptance of this agreement.</li>
                            <li>Subsequent payments will be automatically charged to your selected payment method on the <strong>${planDetails.subsequentPayments}</strong>.</li>
                            <li>The total amount to be paid under this agreement is <strong>$${total.toLocaleString()}</strong>.</li>
                        </ul>
                    </div>

                    <div class="agreement-section">
                        <h5 class="font-semibold text-white mb-2">2. AUTOMATIC BILLING</h5>
                        <ul class="list-disc list-inside space-y-2 ml-4">
                            <li>By accepting this agreement, you authorize TechStep to automatically charge your payment method for each scheduled payment.</li>
                            <li>You are responsible for ensuring sufficient funds are available on each billing date.</li>
                            <li>It is your responsibility to update your payment information if your payment method expires or changes.</li>
                        </ul>
                    </div>

                    <div class="agreement-warning">
                        <h5 class="font-semibold text-red-400 mb-2 flex items-center">
                            <i class="fas fa-exclamation-triangle mr-2"></i>3. NON-REFUNDABLE POLICY
                        </h5>
                        <ul class="list-disc list-inside space-y-2 ml-4">
                            <li><strong>ALL PAYMENTS ARE FINAL AND NON-REFUNDABLE.</strong></li>
                            <li>Once a payment is processed, it cannot be reversed, refunded, or credited, regardless of course completion status.</li>
                            <li>No refunds will be provided for any reason, including but not limited to: course dissatisfaction, technical difficulties, personal circumstances, or early completion.</li>
                            <li>Course access will remain available for the full duration as specified in your course enrollment.</li>
                        </ul>
                    </div>

                    <div class="agreement-info">
                        <h5 class="font-semibold text-yellow-400 mb-2 flex items-center">
                            <i class="fas fa-credit-card mr-2"></i>4. LATE PAYMENTS AND FEES
                        </h5>
                        <ul class="list-disc list-inside space-y-2 ml-4">
                            <li>If a scheduled payment fails due to insufficient funds, expired card, or other payment method issues, a <strong>late fee of $25</strong> will be automatically added to your account.</li>
                            <li>You will have <strong>7 days</strong> from a failed payment to update your payment method and complete the payment plus applicable late fees.</li>
                            <li>After 7 days of non-payment, an additional <strong>$15 processing fee</strong> will be applied.</li>
                            <li>Continued non-payment may result in:
                                <ul class="list-disc list-inside ml-4 mt-2 space-y-1">
                                    <li>Course access suspension</li>
                                    <li>Collection agency referral</li>
                                    <li>Additional collection costs and legal fees</li>
                                    <li>Credit bureau reporting</li>
                                </ul>
                            </li>
                        </ul>
                    </div>

                    <div class="agreement-section">
                        <h5 class="font-semibold text-white mb-2">5. COURSE ACCESS</h5>
                        <ul class="list-disc list-inside space-y-2 ml-4">
                            <li>Course access will be granted immediately upon acceptance of this agreement and first payment.</li>
                            <li>Continued access depends on maintaining current payment status.</li>
                            <li>Access may be suspended if payments become delinquent, but will be restored upon payment of all outstanding amounts.</li>
                        </ul>
                    </div>

                    <div class="agreement-section">
                        <h5 class="font-semibold text-white mb-2">6. MODIFICATION AND CANCELLATION</h5>
                        <ul class="list-disc list-inside space-y-2 ml-4">
                            <li>You may not modify or cancel this payment plan once accepted.</li>
                            <li>TechStep reserves the right to modify these terms with 30 days written notice.</li>
                            <li>Changes will not affect existing payment plan agreements already in progress.</li>
                        </ul>
                    </div>

                    <div class="agreement-section">
                        <h5 class="font-semibold text-white mb-2">7. DEFAULT AND REMEDIES</h5>
                        <ul class="list-disc list-inside space-y-2 ml-4">
                            <li>Failure to make any payment when due constitutes a default under this agreement.</li>
                            <li>Upon default, TechStep may declare the entire remaining balance immediately due and payable.</li>
                            <li>You will be responsible for all costs of collection, including attorney fees and court costs.</li>
                        </ul>
                    </div>

                    <div class="agreement-section">
                        <h5 class="font-semibold text-white mb-2">8. ACKNOWLEDGMENT</h5>
                        <p class="ml-4">
                            By accepting this agreement, you acknowledge that you have read, understood, and agree to be bound by all terms and conditions. You confirm that you are at least 18 years old and have the legal capacity to enter into this agreement.
                        </p>
                    </div>

                    <div class="bg-gray-800 border border-gray-600 rounded-lg p-4 mt-6">
                        <h5 class="font-semibold text-white mb-2">CONTACT INFORMATION</h5>
                        <p class="text-sm">
                            For questions regarding this payment plan agreement, please contact:<br>
                            <strong>TechStep </strong><br>
                            Email: info@ipsglobalconsulting.com<br>
                            Phone: 1-301-AJW-10MP<br>
                            Business Hours: Monday-Friday, 9 AM - 5 PM EST
                        </p>
                    </div>
                </div>
            `;
        }

        function showPaymentPlanRequirements(planType) {
            const planDetails = getPlanDetails(planType);
            
            const requirementsHTML = `
                <div id="payment-plan-requirements" class="bg-green-900/20 border border-green-500/30 rounded-lg p-4 mb-4">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-semibold text-green-400 flex items-center">
                            <i class="fas fa-check-circle mr-2"></i>Payment Plan Agreement Accepted
                        </h4>
                        <button id="view-agreement-again" class="text-xs bg-gray-600 hover:bg-gray-500 px-2 py-1 rounded">
                            View Agreement
                        </button>
                    </div>
                    <div class="text-sm text-gray-300">
                        <p><strong>Plan:</strong> ${planDetails.description} of $${planDetails.amount.toLocaleString()}</p>
                        <p><strong>First Payment:</strong> Today | <strong>Next Payment:</strong> ${getNextPaymentDate(planType)}</p>
                        <p class="text-yellow-400 mt-1">
                            <i class="fas fa-exclamation-triangle mr-1"></i>
                            Remember: All payments are non-refundable. Late fees apply for missed payments.
                        </p>
                    </div>
                </div>
            `;
            
            const paymentPlanSelector = document.getElementById('payment-plan-selector');
            paymentPlanSelector.insertAdjacentHTML('afterend', requirementsHTML);
            
            const viewAgreementAgain = document.getElementById('view-agreement-again');
            if (viewAgreementAgain) viewAgreementAgain.addEventListener('click', function() {
                showPaymentPlanAgreement(planType, true);
            });
        }

        function hidePaymentPlanRequirements() {
            const existingRequirements = document.getElementById('payment-plan-requirements');
            if (existingRequirements) {
                existingRequirements.remove();
            }
            paymentPlanAgreed = false;
        }

        function getNextPaymentDate(planType) {
            const now = new Date();
            let nextDate;
            
            if (planType === 'monthly') {
                nextDate = new Date(now.getFullYear(), now.getMonth() + 1, 1);
            } else if (planType === 'weekly') {
                nextDate = new Date(now.getTime() + 7 * 24 * 60 * 60 * 1000);
            }
            
            return nextDate.toLocaleDateString();
        }

        function enablePaymentButtons() {
            const paymentButtonsContainer = document.getElementById('payment-buttons-container');
            paymentButtonsContainer.classList.remove('payment-plan-locked');
            
            document.getElementById('stripe-button').disabled = false;
            document.getElementById('paypal-button-container').style.pointerEvents = 'auto';
        }

        function disablePaymentButtons() {
            const paymentButtonsContainer = document.getElementById('payment-buttons-container');
            paymentButtonsContainer.classList.add('payment-plan-locked');
            
            document.getElementById('stripe-button').disabled = true;
            document.getElementById('paypal-button-container').style.pointerEvents = 'none';
        }

        function validatePaymentPlan() {
            const selectedPlan = document.querySelector('input[name="payment-plan"]:checked').value;
            
            if (selectedPlan !== 'full' && !paymentPlanAgreed) {
                showNotification('Please accept the payment plan agreement to continue.', 'warning');
                return false;
            }
            
            return true;
        }

        function storeAgreementAcceptance(planType) {
            const agreementData = {
                accepted: true,
                timestamp: new Date().toISOString(),
                planType: planType,
                userAgent: navigator.userAgent,
                courses: selectedCourses.map(c => c.name),
                total: calculateTotal()
            };
            
            localStorage.setItem('techstep_payment_agreement', JSON.stringify(agreementData));
        }

        // Payment processing functions
        function initializePaymentHandlers() {
            // Initialize PayPal
            initializePayPal();

            // Stripe button handler
            document.getElementById('stripe-button').onclick = function() {
                if (!validatePaymentPlan()) return;
                
                const selectedPlan = document.querySelector('input[name="payment-plan"]:checked').value;
                const amount = calculatePaymentAmount(selectedPlan);
                
                showStripeModal(amount, selectedPlan);
            };

            // Check for Apple Pay support
            if (window.ApplePaySession && ApplePaySession.canMakePayments()) {
                document.getElementById('apple-pay-button').classList.remove('hidden');
                document.getElementById('apple-pay-button').onclick = function() {
                    if (!validatePaymentPlan()) return;
                    showNotification('Apple Pay integration coming soon!', 'info');
                };
            }

            // Initially disable payment buttons if payment plan not agreed
            const selectedPlan = document.querySelector('input[name="payment-plan"]:checked').value;
            if (selectedPlan !== 'full' && !paymentPlanAgreed) {
                disablePaymentButtons();
            }
        }

        function initializePayPal() {
            if (!window.paypal) {
                console.error('PayPal SDK not loaded');
                return;
            }

            // Clear existing PayPal buttons
            document.getElementById('paypal-button-container').innerHTML = '';

            window.paypal.Buttons({
                style: {
                    layout: 'vertical',
                    color: 'blue',
                    shape: 'rect',
                    label: 'paypal'
                },
                
                createOrder: (data, actions) => {
                    if (!validatePaymentPlan()) return;
                    
                    const selectedPlan = document.querySelector('input[name="payment-plan"]:checked').value;
                    const orderAmount = calculatePaymentAmount(selectedPlan);

                    return actions.order.create({
                        purchase_units: [{
                            amount: {
                                value: orderAmount.toString(),
                                currency_code: 'USD'
                            },
                            description: `TechStep Courses - ${selectedCourses.map(c => c.name).join(', ')}`,
                            custom_id: `techstep_${Date.now()}`,
                            invoice_id: `INV_${Date.now()}`
                        }],
                        application_context: {
                            brand_name: 'TechStep',
                            landing_page: 'NO_PREFERENCE',
                            user_action: 'PAY_NOW'
                        }
                    });
                },

                onApprove: async (data, actions) => {
                    try {
                        const order = await actions.order.capture();
                        handlePaymentSuccess(order, 'paypal');
                    } catch (error) {
                        console.error('PayPal payment error:', error);
                        showNotification('Payment failed. Please try again.', 'error');
                    }
                },

                onError: (err) => {
                    console.error('PayPal error:', err);
                    showNotification('Payment failed. Please try again.', 'error');
                },

                onCancel: (data) => {
                    console.log('PayPal payment cancelled:', data);
                    showNotification('Payment cancelled', 'info');
                }
            }).render('#paypal-button-container');
        }

        function showStripeModal(amount, planType) {
            const modalHTML = `
                <div id="stripe-modal" class="modal-overlay show">
                    <div class="modal-content max-w-md">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-semibold">Complete Payment</h3>
                            <button id="close-stripe-modal" class="text-gray-400 hover:text-white text-2xl">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <form id="stripe-payment-form">
                            <div class="mb-4">
                                <label class="block text-sm font-medium mb-2">Email</label>
                                <input type="email" id="customer-email" required 
                                       class="w-full p-3 bg-gray-600 rounded-lg text-white border border-gray-500 focus:border-blue-400">
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium mb-2">Full Name</label>
                                <input type="text" id="customer-name" required 
                                       class="w-full p-3 bg-gray-600 rounded-lg text-white border border-gray-500 focus:border-blue-400">
                            </div>
                            
                            <div class="mb-6">
                                <label class="block text-sm font-medium mb-2">Payment Information</label>
                                <div id="card-element" class="p-3 bg-gray-600 rounded-lg border border-gray-500">
                                    <!-- Stripe Elements will create input elements here -->
                                </div>
                            </div>
                            
                            <button type="submit" id="submit-payment" 
                                    class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition duration-300">
                                <span id="payment-button-text">Pay $${amount.toLocaleString()}</span>
                                <i id="payment-spinner" class="fas fa-spinner fa-spin ml-2 hidden"></i>
                            </button>
                        </form>
                        
                        <div id="payment-messages" class="mt-4 text-sm text-red-400"></div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            
            // Initialize Stripe Elements
            const elements = stripe.elements({
                appearance: {
                    theme: 'night',
                    variables: {
                        colorPrimary: '#3b82f6',
                        colorBackground: '#374151',
                        colorText: '#ffffff',
                        colorDanger: '#ef4444',
                        borderRadius: '8px'
                    }
                }
            });

            const cardElement = elements.create('card');
            cardElement.mount('#card-element');
            
            // Handle form submission
            const stripePaymentForm = document.getElementById('stripe-payment-form');
            if (stripePaymentForm) stripePaymentForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const submitButton = document.getElementById('submit-payment');
                const spinner = document.getElementById('payment-spinner');
                const buttonText = document.getElementById('payment-button-text');
                
                // Show loading state
                submitButton.disabled = true;
                buttonText.textContent = 'Processing...';
                spinner.classList.remove('hidden');
                
                try {
                    const {error, paymentMethod} = await stripe.createPaymentMethod({
                        type: 'card',
                        card: cardElement,
                        billing_details: {
                            name: document.getElementById('customer-name').value,
                            email: document.getElementById('customer-email').value,
                        },
                    });

                    if (error) {
                        throw error;
                    }

                    // For demo purposes, simulate successful payment
                    setTimeout(() => {
                        document.getElementById('stripe-modal').remove();
                        handlePaymentSuccess({
                            id: 'demo_payment_' + Date.now(),
                            amount: amount,
                            method: 'stripe'
                        }, 'stripe');
                    }, 2000);
                    
                } catch (error) {
                    document.getElementById('payment-messages').textContent = error.message;
                    
                    // Reset button state
                    submitButton.disabled = false;
                    buttonText.textContent = `Pay $${amount.toLocaleString()}`;
                    spinner.classList.add('hidden');
                }
            });
            
            // Close modal handler
            document.getElementById('close-stripe-modal').onclick = () => {
                document.getElementById('stripe-modal').remove();
            };
        }

        function handlePaymentSuccess(paymentData, method) {
            const successHTML = `
                <div id="success-modal" class="modal-overlay show">
                    <div class="modal-content max-w-md text-center">
                        <div class="mb-6">
                            <i class="fas fa-check-circle text-6xl text-green-400 mb-4"></i>
                            <h3 class="text-2xl font-bold mb-2">Payment Successful!</h3>
                            <p class="text-gray-300">Your enrollment is confirmed</p>
                        </div>
                        
                        <div class="bg-gray-700 p-4 rounded-lg mb-6 text-left">
                            <h4 class="font-semibold mb-2">Order Details:</h4>
                            <div class="space-y-1 text-sm">
                                ${selectedCourses.map(course => `
                                    <div class="flex justify-between">
                                        <span>${course.name}</span>
                                        <span>$${currentLearningType === 'with-mentor' ? course.mentorPrice.toLocaleString() : course.selfPrice.toLocaleString()}</span>
                                    </div>
                                `).join('')}
                            </div>
                            <div class="border-t border-gray-600 mt-2 pt-2">
                                <div class="flex justify-between font-semibold">
                                    <span>Total Paid:</span>
                                    <span>$${paymentData.amount ? paymentData.amount.toLocaleString() : calculatePaymentAmount(document.querySelector('input[name="payment-plan"]:checked').value).toLocaleString()}</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="space-y-3">
                            <button onclick="redirectToDashboard()" 
                                    class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition duration-300">
                                <i class="fas fa-play mr-2"></i>Start Learning
                            </button>
                            <button onclick="document.getElementById('success-modal').remove()" 
                                    class="w-full border border-gray-500 text-gray-300 py-3 rounded-lg font-semibold hover:bg-gray-700 transition duration-300">
                                Continue Browsing
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', successHTML);
            
            // Clear cart
            selectedCourses = [];
            updateCart();
            
            // Uncheck all course checkboxes
            courseCheckboxes.forEach(checkbox => {
                checkbox.checked = false;
                checkbox.closest('.course-card').classList.remove('selected');
            });
        }

        function redirectToDashboard() {
            document.getElementById('success-modal').remove();
            loginBtn.click();
        }

        // Notification system
        function showNotification(message, type = 'info') {
            const colors = {
                success: 'success',
                error: 'error',
                info: 'info',
                warning: 'warning'
            };
            
            const notification = document.createElement('div');
            notification.className = `notification ${colors[type]}`;
            notification.innerHTML = `
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <i class="fas fa-${type === 'success' ? 'check' : type === 'error' ? 'exclamation-triangle' : 'info-circle'} mr-2"></i>
                        <span>${message}</span>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-xl">&times;</button>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            setTimeout(() => {
                notification.remove();
            }, 5000);
        }

        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Close modal with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const modals = document.querySelectorAll('.modal-overlay.show');
                modals.forEach(modal => modal.classList.remove('show'));
            }
        });

        // Initialize Stripe on page load
        // Initialize Stripe Payment System
        function initializeStripePayments() {
            console.log('🚀 Initializing Stripe payment system...');
            
            // Load Stripe.js if not already loaded
            if (!window.Stripe) {
                const stripeScript = document.createElement('script');
                stripeScript.src = 'https://js.stripe.com/v3/';
                stripeScript.onload = setupStripe;
                stripeScript.onerror = () => {
                    console.error('❌ Failed to load Stripe.js');
                    updatePaymentButtons(false);
                };
                document.head.appendChild(stripeScript);
                console.log('📦 Loading Stripe.js...');
            } else {
                setupStripe();
            }
        }
        
        // Initialize on page load - consolidated with main DOMContentLoaded listener
        
        // API Configuration and Service Layer
        const API_BASE_URL = 'https://8000-iijrwv71livvm5m4tkmpb-6532622b.e2b.dev/api/v1';
        
        // API Service Class
        class TechStepAPI {
            constructor() {
                this.baseUrl = API_BASE_URL;
                this.authToken = localStorage.getItem('techstep_token');
            }

            async request(endpoint, options = {}) {
                const url = `${this.baseUrl}${endpoint}`;
                const config = {
                    headers: {
                        'Content-Type': 'application/json',
                        ...options.headers,
                    },
                    ...options,
                };

                if (this.authToken) {
                    config.headers['Authorization'] = `Bearer ${this.authToken}`;
                }

                try {
                    const response = await fetch(url, config);
                    
                    if (!response.ok) {
                        const errorData = await response.json().catch(() => ({}));
                        throw new Error(errorData.detail || `HTTP error! status: ${response.status}`);
                    }

                    return await response.json();
                } catch (error) {
                    console.error('API Request failed:', error);
                    throw error;
                }
            }

            // Authentication Methods
            async register(userData) {
                const response = await this.request('/auth/register', {
                    method: 'POST',
                    body: JSON.stringify(userData),
                });
                this.setAuthToken(response.access_token);
                return response;
            }

            async login(email, password) {
                const response = await this.request('/auth/login', {
                    method: 'POST',
                    body: JSON.stringify({ email, password }),
                });
                this.setAuthToken(response.access_token);
                return response;
            }

            async getCurrentUser() {
                return await this.request('/auth/me');
            }

            setAuthToken(token) {
                this.authToken = token;
                localStorage.setItem('techstep_token', token);
            }

            logout() {
                this.authToken = null;
                localStorage.removeItem('techstep_token');
            }

            isAuthenticated() {
                return !!this.authToken;
            }

            // Course Methods
            async getCourses(params = {}) {
                const searchParams = new URLSearchParams(params);
                return await this.request(`/courses/?${searchParams}`);
            }

            async getCourse(courseId) {
                return await this.request(`/courses/${courseId}`);
            }

            async enrollInCourse(courseId) {
                return await this.request(`/courses/${courseId}/enroll`, {
                    method: 'POST',
                });
            }

            async getMyEnrollments() {
                return await this.request('/courses/enrollments/my');
            }

            // User Methods
            async getUserDashboard() {
                return await this.request('/users/profile/dashboard');
            }

            // Payment Methods
            async createPaymentIntent(paymentData) {
                return await this.request('/payments/create-intent', {
                    method: 'POST',
                    body: JSON.stringify(paymentData)
                });
            }

            async confirmPayment(paymentIntentId) {
                return await this.request('/payments/confirm', {
                    method: 'POST',
                    body: JSON.stringify({ payment_intent_id: paymentIntentId })
                });
            }

            async bookConsultation(bookingData) {
                return await this.request('/payments/consultations/book', {
                    method: 'POST',
                    body: JSON.stringify(bookingData)
                });
            }
        }

        // Initialize API service
        const api = new TechStepAPI();

        // Authentication State Management
        let currentUser = null;

        async function checkAuthStatus() {
            if (api.isAuthenticated()) {
                try {
                    currentUser = await api.getCurrentUser();
                    updateUIForAuthenticatedUser();
                } catch (error) {
                    console.error('Auth check failed:', error);
                    api.logout();
                    updateUIForUnauthenticatedUser();
                }
            } else {
                updateUIForUnauthenticatedUser();
            }
        }

        function updateUIForAuthenticatedUser() {
            const adminLoginBtn = document.getElementById('adminLoginBtn');
            if (adminLoginBtn && currentUser) {
                adminLoginBtn.innerHTML = `<i class="fas fa-user mr-2"></i>${currentUser.full_name}`;
                adminLoginBtn.classList.add('bg-green-600', 'hover:bg-green-700');
                adminLoginBtn.classList.remove('bg-gray-600', 'hover:bg-gray-700');
            }
        }

        function updateUIForUnauthenticatedUser() {
            const adminLoginBtn = document.getElementById('adminLoginBtn');
            if (adminLoginBtn) {
                adminLoginBtn.innerHTML = '<i class="fas fa-lock mr-2"></i>Mentee Login';
                adminLoginBtn.classList.add('bg-gray-600', 'hover:bg-gray-700');
                adminLoginBtn.classList.remove('bg-green-600', 'hover:bg-green-700');
            }
        }

        // Course Loading Functions
        async function loadCourses() {
            try {
                showLoadingState();
                const courses = await api.getCourses();
                displayCourses(courses);
                hideLoadingState();
            } catch (error) {
                console.error('Failed to load courses from API, using fallback data:', error);
                
                // Fallback course data with updated pricing
                const fallbackCourses = [
                    {
                        id: 1,
                        title: "SOC Analyst Foundations",
                        slug: "soc-analyst-foundations",
                        description: "Master security operations center fundamentals, threat detection, and incident response procedures.",
                        short_description: "6-month comprehensive program with self-paced learning decks, labs, virtual internship & certificate",
                        level: "beginner",
                        price: 2999,
                        duration_hours: 720,
                        instructor_name: "Sarah Chen",
                        instructor_bio: "SOC Manager with 10+ years in cybersecurity operations",
                        instructor_avatar_url: "https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face",
                        learning_objectives: ["Master SOC fundamentals", "Understand threat detection", "Learn incident response procedures"],
                        prerequisites: ["Basic IT knowledge"],
                        tags: ["SOC", "threat detection", "incident response"],
                        status: "published",
                        is_featured: true,
                        enrollment_count: 1247,
                        rating: 4.8,
                        rating_count: 234,
                        thumbnail_url: "https://images.unsplash.com/photo-1550751827-4bd374c3f58b?w=400&h=250&fit=crop"
                    },
                    {
                        id: 2,
                        title: "Cyber Threat Analyst & Incident Response",
                        slug: "cyber-threat-analyst-incident-response",
                        description: "Advanced threat hunting, malware analysis, and comprehensive incident response strategies.",
                        short_description: "6-month comprehensive program with self-paced learning decks, labs, virtual internship & certificate",
                        level: "intermediate",
                        price: 2999,
                        duration_hours: 720,
                        instructor_name: "Michael Rodriguez",
                        instructor_bio: "Senior Threat Analyst with expertise in malware analysis",
                        instructor_avatar_url: "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face",
                        learning_objectives: ["Advanced threat hunting", "Malware analysis techniques", "Incident response strategies"],
                        prerequisites: ["SOC fundamentals", "Basic networking"],
                        tags: ["threat hunting", "malware analysis", "incident response"],
                        status: "published",
                        is_featured: true,
                        enrollment_count: 892,
                        rating: 4.9,
                        rating_count: 187,
                        thumbnail_url: "https://images.unsplash.com/photo-1558494949-ef010cbdcc31?w=400&h=250&fit=crop"
                    },
                    {
                        id: 3,
                        title: "SIEM Engineering - Splunk Specialization",
                        slug: "siem-engineering-splunk",
                        description: "Master Splunk administration, SIEM deployment, and security monitoring infrastructure.",
                        short_description: "6-month comprehensive program with self-paced learning decks, labs, virtual internship & certificate",
                        level: "intermediate",
                        price: 2999,
                        duration_hours: 720,
                        instructor_name: "Dr. Emily Watson",
                        instructor_bio: "SIEM Architect and Splunk Expert with 12+ years experience",
                        instructor_avatar_url: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face",
                        learning_objectives: ["Master Splunk administration", "SIEM deployment", "Security monitoring infrastructure"],
                        prerequisites: ["Basic security knowledge", "Command line familiarity"],
                        tags: ["SIEM", "Splunk", "security monitoring"],
                        status: "published",
                        is_featured: true,
                        enrollment_count: 756,
                        rating: 4.7,
                        rating_count: 143,
                        thumbnail_url: "https://images.unsplash.com/photo-1563013544-824ae1b704d3?w=400&h=250&fit=crop"
                    },
                    {
                        id: 4,
                        title: "Cloud Security Analyst (AWS, Azure, GCP)",
                        slug: "cloud-security-analyst",
                        description: "AWS, Azure, and GCP security architecture, compliance, and best practices.",
                        short_description: "6-month comprehensive program with self-paced learning decks, labs, virtual internship & certificate",
                        level: "intermediate",
                        price: 2999,
                        duration_hours: 720,
                        instructor_name: "David Kim",
                        instructor_bio: "Cloud Security Architect with AWS and Azure certifications",
                        instructor_avatar_url: "https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?w=150&h=150&fit=crop&crop=face",
                        learning_objectives: ["AWS security architecture", "Azure compliance", "GCP best practices"],
                        prerequisites: ["Cloud platform experience", "Basic security fundamentals"],
                        tags: ["cloud security", "AWS", "Azure", "GCP"],
                        status: "published",
                        is_featured: true,
                        enrollment_count: 634,
                        rating: 4.6,
                        rating_count: 98,
                        thumbnail_url: "https://images.unsplash.com/photo-1451187580459-43490279c0fa?w=400&h=250&fit=crop"
                    },
                    {
                        id: 5,
                        title: "Malware Analyst & Network Defense",
                        slug: "malware-analyst-network-defense",
                        description: "Reverse engineering, dynamic analysis, and advanced network security techniques.",
                        short_description: "6-month comprehensive program with self-paced learning decks, labs, virtual internship & certificate",
                        level: "advanced",
                        price: 2999,
                        duration_hours: 720,
                        instructor_name: "Alex Rivera",
                        instructor_bio: "Malware Research Specialist with reverse engineering expertise",
                        instructor_avatar_url: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face",
                        learning_objectives: ["Reverse engineering techniques", "Dynamic malware analysis", "Network defense strategies"],
                        prerequisites: ["Advanced security knowledge", "Programming basics"],
                        tags: ["malware analysis", "reverse engineering", "network defense"],
                        status: "published",
                        is_featured: false,
                        enrollment_count: 423,
                        rating: 4.9,
                        rating_count: 89,
                        thumbnail_url: "https://images.unsplash.com/photo-1563013544-824ae1b704d3?w=400&h=250&fit=crop"
                    },
                    {
                        id: 6,
                        title: "Risk & Compliance Analyst - GRC Fundamentals",
                        slug: "risk-compliance-analyst-grc",
                        description: "Governance frameworks, risk management, and regulatory compliance strategies.",
                        short_description: "6-month comprehensive program with self-paced learning decks, labs, virtual internship & certificate",
                        level: "intermediate",
                        price: 2999,
                        duration_hours: 720,
                        instructor_name: "Michelle Zhang",
                        instructor_bio: "GRC Consultant with expertise in compliance frameworks",
                        instructor_avatar_url: "https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face",
                        learning_objectives: ["Governance frameworks", "Risk management", "Regulatory compliance"],
                        prerequisites: ["Basic business knowledge", "Security awareness"],
                        tags: ["GRC", "compliance", "risk management"],
                        status: "published",
                        is_featured: true,
                        enrollment_count: 567,
                        rating: 4.5,
                        rating_count: 112,
                        thumbnail_url: "https://images.unsplash.com/photo-1451187580459-43490279c0fa?w=400&h=250&fit=crop"
                    }
                ];
                
                displayCourses(fallbackCourses);
                hideLoadingState();
            }
        }

        function displayCourses(courses) {
            const coursesContainer = document.querySelector('#courses .grid');
            if (!coursesContainer) return;

            coursesContainer.innerHTML = courses.map(course => `
                <div class="course-card rounded-2xl p-6 transition-all duration-300" 
                     data-course-id="${course.id}" data-price="${course.price}">
                    <div class="relative mb-4">
                        <img src="${course.thumbnail_url || 'https://images.unsplash.com/photo-1550751827-4bd374c3f58b?w=400&h=250&fit=crop'}" 
                             alt="${course.title}" class="w-full h-48 object-cover rounded-xl">
                        <div class="absolute top-4 right-4">
                            <span class="bg-blue-600 text-white px-3 py-1 rounded-full text-sm font-semibold">
                                ${course.level.charAt(0).toUpperCase() + course.level.slice(1)}
                            </span>
                        </div>
                        ${course.is_featured ? '<div class="absolute top-4 left-4"><span class="bg-yellow-500 text-black px-3 py-1 rounded-full text-sm font-bold">Featured</span></div>' : ''}
                    </div>
                    
                    <h3 class="text-xl font-bold text-white mb-3">${course.title}</h3>
                    <p class="text-gray-300 mb-4 text-sm">${course.short_description}</p>
                    
                    <div class="flex items-center mb-4">
                        <img src="${course.instructor_avatar_url || 'https://images.unsplash.com/photo-1494790108755-2616b612b786?w=50&h=50&fit=crop&crop=face'}" 
                             alt="${course.instructor_name}" class="w-8 h-8 rounded-full mr-3">
                        <div>
                            <p class="text-white text-sm font-semibold">${course.instructor_name}</p>
                            <p class="text-gray-400 text-xs">${course.duration_hours} hours</p>
                        </div>
                    </div>
                    
                    <div class="flex justify-between items-center mb-4">
                        <div>
                            <div class="text-sm text-gray-400">Starting at</div>
                            <span class="text-2xl font-bold text-blue-400">$${course.price.toLocaleString()}</span>
                        </div>
                        <div class="flex items-center text-yellow-400">
                            <i class="fas fa-star mr-1"></i>
                            <span class="text-sm">${course.rating.toFixed(1)} (${course.rating_count})</span>
                        </div>
                    </div>
                    
                    <div class="space-y-3">
                        <button class="buy-now-btn w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300" 
                                data-course-id="${course.id}" data-course-title="${course.title}" data-price="${course.price}" data-type="self-paced">
                            <i class="fas fa-shopping-cart mr-2"></i>Self-Paced Course - $${course.price.toLocaleString()}
                        </button>
                        <button class="mentor-btn w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300"
                                data-course-id="${course.id}" data-course-title="${course.title}" data-price="4999" data-type="mentor">
                            <i class="fas fa-user-tie mr-2"></i>Live Mentor + Course - $4,999
                        </button>
                        <div class="text-center">
                            <button class="consultation-btn text-blue-400 hover:text-blue-300 text-sm underline transition duration-300"
                                    data-course-id="${course.id}" data-course-title="${course.title}">
                                <i class="fas fa-calendar mr-1"></i>Book FREE 30-min Consultation First
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');

            // Attach event listeners for buy buttons
            attachBuyNowListeners();
        }

        function attachBuyNowListeners() {
            // Self-paced buy now buttons
            document.querySelectorAll('.buy-now-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const courseId = this.dataset.courseId;
                    const courseTitle = this.dataset.courseTitle;
                    const price = this.dataset.price;
                    const type = this.dataset.type;
                    
                    showPaymentModal(courseId, courseTitle, price, type);
                });
            });

            // Live mentor buttons  
            document.querySelectorAll('.mentor-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const courseId = this.dataset.courseId;
                    const courseTitle = this.dataset.courseTitle;
                    const price = this.dataset.price;
                    const type = this.dataset.type;
                    
                    showPaymentModal(courseId, courseTitle, price, type);
                });
            });

            // Consultation booking buttons
            document.querySelectorAll('.consultation-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const courseId = this.dataset.courseId;
                    const courseTitle = this.dataset.courseTitle;
                    
                    showConsultationBooking(courseId, courseTitle);
                });
            });
        }

        function showLoadingState() {
            const coursesContainer = document.querySelector('#courses .grid');
            if (coursesContainer) {
                coursesContainer.innerHTML = `
                    <div class="col-span-full flex justify-center items-center py-12">
                        <div class="text-center">
                            <i class="fas fa-spinner fa-spin text-4xl text-blue-500 mb-4"></i>
                            <p class="text-white">Loading courses...</p>
                        </div>
                    </div>
                `;
            }
        }

        function hideLoadingState() {
            // Loading state is hidden when courses are displayed
        }

        function showErrorState(message) {
            const coursesContainer = document.querySelector('#courses .grid');
            if (coursesContainer) {
                coursesContainer.innerHTML = `
                    <div class="col-span-full flex justify-center items-center py-12">
                        <div class="text-center">
                            <i class="fas fa-exclamation-triangle text-4xl text-red-500 mb-4"></i>
                            <p class="text-white mb-4">${message}</p>
                            <button onclick="loadCourses()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg">
                                <i class="fas fa-refresh mr-2"></i>Try Again
                            </button>
                        </div>
                    </div>
                `;
            }
        }



        // Payment Modal Functions
        function showPaymentModal(courseId, courseTitle, basePrice, type) {
            const finalPrice = parseInt(basePrice);
            
            // Calculate payment options with 5% discount for both types
            const fullPaymentDiscount = Math.round(finalPrice * 0.05);
            const fullPaymentPrice = finalPrice - fullPaymentDiscount;
            
            // Monthly payment structure: larger down payment + 5 equal monthly payments
            const downPayment = Math.ceil(finalPrice * 0.4); // 40% down payment
            const monthlyPayment = Math.ceil((finalPrice - downPayment) / 5); // 5 equal monthly payments
            const totalInstallmentPrice = downPayment + (monthlyPayment * 5);
            
            const modalHTML = `
                <div id="paymentModal" class="modal-overlay">
                    <div class="modal-content max-w-4xl">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold text-white">Complete Your Purchase</h2>
                            <button id="closePaymentModal" class="text-gray-400 hover:text-white">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <!-- Left Column: Course & Payment Options -->
                            <div>
                                <div class="bg-gray-800 rounded-lg p-6 mb-6">
                                    <h3 class="text-xl font-bold text-white mb-2">${courseTitle}</h3>
                                    <p class="text-gray-300 mb-4">
                                        <i class="fas fa-${type === 'mentor' ? 'user-tie' : 'laptop'} mr-2"></i>
                                        ${type === 'mentor' ? 'Live Mentor + Course (6 months)' : 'Self-Paced Course (6 months)'}
                                    </p>
                                    <div class="text-sm text-gray-400">
                                        • 6-month comprehensive program
                                        • Lifetime access to materials
                                        ${type === 'mentor' ? '• Weekly 1-on-1 mentor sessions\n• Career guidance & support\n• Project reviews & feedback' : '• Self-paced learning\n• Community access\n• Certificate of completion'}
                                    </div>
                                </div>

                                <!-- Free Trial Banner -->
                                <div class="bg-gradient-to-r from-purple-600 to-blue-600 p-4 rounded-lg mb-6">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <h3 class="text-white font-bold text-lg">🎉 FREE 7-Day Trial Available!</h3>
                                            <p class="text-white/80 text-sm">Try any course risk-free for one week</p>
                                        </div>
                                        <button id="startFreeTrial" class="bg-white text-purple-600 font-bold px-4 py-2 rounded-lg hover:bg-gray-100 transition-all">
                                            Start Free Trial
                                        </button>
                                    </div>
                                </div>

                                <div class="space-y-4 mb-6">
                                    <h4 class="text-lg font-bold text-white">Choose Payment Option:</h4>
                                    
                                    <!-- Full Payment Option -->
                                    <label class="payment-option-card block p-4 bg-gray-800 rounded-lg border-2 border-transparent hover:border-green-500 cursor-pointer transition-all">
                                        <input type="radio" name="paymentOption" value="full" class="mr-3" checked>
                                        <div class="inline-block w-full">
                                            <div class="flex items-center justify-between">
                                                <div class="flex items-center">
                                                    <span class="text-white font-semibold">Full Payment (Save 5%)</span>
                                                    <span class="ml-2 bg-green-600 text-white px-2 py-1 rounded text-xs">BEST VALUE</span>
                                                </div>
                                                <div class="text-right">
                                                    <div class="text-gray-400 text-sm line-through">$${finalPrice.toLocaleString()}</div>
                                                    <div class="text-green-400 font-bold text-lg">$${fullPaymentPrice.toLocaleString()}</div>
                                                </div>
                                            </div>
                                            <div class="text-green-400 text-sm mt-1">(Save $${fullPaymentDiscount} • No additional fees)</div>
                                        </div>
                                    </label>
                                    
                                    <!-- 30% Down + Monthly Payments -->
                                    <label class="payment-option-card block p-4 bg-gray-800 rounded-lg border-2 border-transparent hover:border-blue-500 cursor-pointer transition-all">
                                        <input type="radio" name="paymentOption" value="monthly" class="mr-3">
                                        <div class="inline-block w-full">
                                            <div class="flex items-center justify-between">
                                                <div>
                                                    <div class="text-white font-semibold">30% Down + Monthly Payments</div>
                                                    <span class="bg-blue-600 text-white px-2 py-1 rounded text-xs">POPULAR</span>
                                                </div>
                                                <div class="text-right">
                                                    <div class="text-blue-400 font-bold text-lg">$${Math.ceil(finalPrice * 0.3).toLocaleString()}</div>
                                                    <div class="text-gray-400 text-sm">down payment</div>
                                                </div>
                                            </div>
                                            <div class="mt-2 text-sm">
                                                <div class="text-gray-400">Then: <span class="text-blue-400 font-bold">$${Math.ceil((finalPrice * 0.7) / 6).toLocaleString()}/month</span> × 6 months</div>
                                                <div class="text-xs text-gray-500 mt-1">Total: $${Math.ceil(finalPrice * 0.3) + Math.ceil((finalPrice * 0.7) / 6) * 6}</div>
                                            </div>
                                        </div>
                                    </label>
                                    
                                    <!-- 30% Down + Bi-weekly Payments -->
                                    <label class="payment-option-card block p-4 bg-gray-800 rounded-lg border-2 border-transparent hover:border-purple-500 cursor-pointer transition-all">
                                        <input type="radio" name="paymentOption" value="biweekly" class="mr-3">
                                        <div class="inline-block w-full">
                                            <div class="flex items-center justify-between">
                                                <div>
                                                    <div class="text-white font-semibold">30% Down + Bi-weekly Payments</div>
                                                    <span class="bg-purple-600 text-white px-2 py-1 rounded text-xs">FLEXIBLE</span>
                                                </div>
                                                <div class="text-right">
                                                    <div class="text-purple-400 font-bold text-lg">$${Math.ceil(finalPrice * 0.3).toLocaleString()}</div>
                                                    <div class="text-gray-400 text-sm">down payment</div>
                                                </div>
                                            </div>
                                            <div class="mt-2 text-sm">
                                                <div class="text-gray-400">Then: <span class="text-purple-400 font-bold">$${Math.ceil((finalPrice * 0.7) / 12).toLocaleString()}/bi-weekly</span> × 12 payments</div>
                                                <div class="text-xs text-gray-500 mt-1">Total: $${Math.ceil(finalPrice * 0.3) + Math.ceil((finalPrice * 0.7) / 12) * 12} • Faster payoff</div>
                                            </div>
                                        </div>
                                    </label>
                                </div>
                                
                                <!-- Discount Options -->
                                <div class="space-y-4 mb-6">
                                    <h4 class="text-lg font-bold text-white">Special Discounts:</h4>
                                    
                                    <div class="grid grid-cols-1 gap-3">
                                        <label class="discount-option flex items-center p-3 bg-gray-800 rounded-lg border border-gray-600 hover:border-purple-500 cursor-pointer transition-all">
                                            <input type="checkbox" id="siblingDiscount" class="mr-3">
                                            <div class="flex-1">
                                                <span class="text-white font-semibold">Sibling Discount (10% off)</span>
                                                <div class="text-gray-400 text-sm">Family member already enrolled</div>
                                            </div>
                                            <span class="text-purple-400 font-bold">-10%</span>
                                        </label>
                                        
                                        <label class="discount-option flex items-center p-3 bg-gray-800 rounded-lg border border-gray-600 hover:border-orange-500 cursor-pointer transition-all">
                                            <input type="checkbox" id="groupDiscount" class="mr-3">
                                            <div class="flex-1">
                                                <span class="text-white font-semibold">Group of 3 Discount (15% off)</span>
                                                <div class="text-gray-400 text-sm">Enrolling with 2 friends/colleagues</div>
                                            </div>
                                            <span class="text-orange-400 font-bold">-15%</span>
                                        </label>
                                    </div>
                                    
                                    <div id="siblingInfo" class="hidden bg-purple-900 p-3 rounded-lg">
                                        <input type="email" id="siblingEmail" placeholder="Sibling's email address" 
                                               class="w-full p-2 rounded bg-gray-700 text-white border border-gray-600 focus:border-purple-500 focus:outline-none">
                                        <div class="text-xs text-gray-400 mt-1">We'll verify enrollment to apply the discount</div>
                                    </div>
                                    
                                    <div id="groupInfo" class="hidden bg-orange-900 p-3 rounded-lg space-y-2">
                                        <input type="email" id="groupMember1" placeholder="Friend 1 email address" 
                                               class="w-full p-2 rounded bg-gray-700 text-white border border-gray-600 focus:border-orange-500 focus:outline-none">
                                        <input type="email" id="groupMember2" placeholder="Friend 2 email address" 
                                               class="w-full p-2 rounded bg-gray-700 text-white border border-gray-600 focus:border-orange-500 focus:outline-none">
                                        <div class="text-xs text-gray-400">All 3 must enroll within 48 hours to qualify</div>
                                    </div>
                                </div>

                                <div class="bg-blue-900 rounded-lg p-4 mb-6">
                                    <div class="flex items-center mb-2">
                                        <i class="fas fa-file-contract text-blue-400 mr-2"></i>
                                        <span class="text-white font-semibold">Mentee Agreement</span>
                                    </div>
                                    <button id="viewAgreement" class="text-blue-300 hover:text-blue-200 underline text-sm">
                                        Click to read full terms and conditions
                                    </button>
                                </div>
                            </div>

                            <!-- Right Column: Payment Summary & Form -->
                            <div>
                                <div class="bg-gray-800 rounded-lg p-6 mb-6">
                                    <h4 class="text-lg font-bold text-white mb-4">Payment Summary</h4>
                                    <div id="paymentSummary">
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="text-gray-300">Course Fee:</span>
                                            <span class="text-white">$${finalPrice.toLocaleString()}</span>
                                        </div>
                                        <div class="flex justify-between items-center mb-2" id="discountRow">
                                            <span class="text-gray-300">Full Payment Discount (5%):</span>
                                            <span class="text-green-400">-$${fullPaymentDiscount}</span>
                                        </div>
                                        <div class="flex justify-between items-center mb-2 hidden" id="siblingDiscountRow">
                                            <span class="text-gray-300">Sibling Discount (10%):</span>
                                            <span class="text-purple-400" id="siblingDiscountAmount">-$0</span>
                                        </div>
                                        <div class="flex justify-between items-center mb-2 hidden" id="groupDiscountRow">
                                            <span class="text-gray-300">Group Discount (15%):</span>
                                            <span class="text-orange-400" id="groupDiscountAmount">-$0</span>
                                        </div>
                                        <div class="flex justify-between items-center mb-2" id="paymentPlanRow">
                                            <span class="text-gray-300" id="paymentPlanLabel">Payment Plan:</span>
                                            <span class="text-blue-400" id="paymentPlanDetails">Full Payment</span>
                                        </div>
                                        <hr class="border-gray-600 my-3">
                                        <div class="flex justify-between items-center">
                                            <span class="text-lg font-bold text-white">Total Due Today:</span>
                                            <span id="totalAmount" class="text-2xl font-bold text-green-400">$${fullPaymentPrice.toLocaleString()}</span>
                                        </div>
                                    </div>
                                </div>

                                <form id="paymentForm" class="space-y-4">
                                    <div class="grid grid-cols-2 gap-4">
                                        <input type="text" id="firstName" placeholder="First Name" required 
                                               class="w-full p-3 rounded-lg bg-gray-700 text-white border border-gray-600 focus:border-blue-500 focus:outline-none">
                                        <input type="text" id="lastName" placeholder="Last Name" required 
                                               class="w-full p-3 rounded-lg bg-gray-700 text-white border border-gray-600 focus:border-blue-500 focus:outline-none">
                                    </div>
                                    
                                    <input type="email" id="customerEmail" placeholder="Email Address" required 
                                           class="w-full p-3 rounded-lg bg-gray-700 text-white border border-gray-600 focus:border-blue-500 focus:outline-none">
                                    
                                    <div id="card-element" class="p-4 border border-gray-600 rounded-lg bg-gray-700">
                                        <!-- Stripe Elements will create form elements here -->
                                    </div>
                                    
                                    <div id="card-errors" class="text-red-400 text-sm hidden"></div>
                                    
                                    <label class="flex items-start space-x-3 mb-4">
                                        <input type="checkbox" id="agreementCheck" required class="mt-1">
                                        <span class="text-sm text-gray-300">
                                            I have read and agree to the 
                                            <button type="button" id="agreementLink" onclick="showTermsOfService()" class="text-blue-400 hover:text-blue-300 underline">
                                                Mentee Agreement and Terms of Service
                                            </button>
                                        </span>
                                    </label>
                                    
                                    <button type="submit" id="paymentSubmit" 
                                            class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-6 rounded-lg transition duration-300">
                                        <i class="fas fa-lock mr-2"></i>Complete Payment - $${fullPaymentPrice.toLocaleString()}
                                    </button>
                                    
                                    <p class="text-xs text-gray-400 text-center">
                                        <i class="fas fa-shield-alt mr-1"></i>
                                        Your payment is secured by Stripe. After payment, you'll receive login credentials via email.
                                    </p>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Remove existing modal if any
            const existingModal = document.getElementById('paymentModal');
            if (existingModal) existingModal.remove();

            document.body.insertAdjacentHTML('beforeend', modalHTML);
            setupPaymentModal(courseId, courseTitle, finalPrice, type, fullPaymentPrice, downPayment, monthlyPayment, totalInstallmentPrice);
        }

        function setupPaymentModal(courseId, courseTitle, basePrice, type, fullPaymentPrice, downPayment, monthlyPayment, totalInstallmentPrice) {
            const paymentModal = document.getElementById('paymentModal');
            const closeBtn = document.getElementById('closePaymentModal');
            const paymentForm = document.getElementById('paymentForm');
            let currentAmount = fullPaymentPrice;
            let appliedDiscounts = { sibling: false, group: false };
            let originalFullPrice = fullPaymentPrice;
            let originalDownPayment = downPayment;
            
            // Show modal
            paymentModal.classList.add('show');

            // Close modal
            closeBtn.addEventListener('click', () => {
                paymentModal.classList.remove('show');
                setTimeout(() => paymentModal.remove(), 300);
            });

            // Update payment calculations
            function updatePaymentCalculations() {
                let basePrice = originalFullPrice;
                let finalFullPrice = originalFullPrice;
                
                // Apply additional discounts to base price
                if (appliedDiscounts.sibling) {
                    basePrice *= 0.9; // 10% off
                }
                if (appliedDiscounts.group) {
                    basePrice *= 0.85; // 15% off
                }
                
                // Calculate 5% discount for full payment
                finalFullPrice = Math.round(basePrice * 0.95);
                
                const discountRow = document.getElementById('discountRow');
                const siblingDiscountRow = document.getElementById('siblingDiscountRow');
                const groupDiscountRow = document.getElementById('groupDiscountRow');
                const totalAmount = document.getElementById('totalAmount');
                const submitBtn = document.getElementById('paymentSubmit');
                const paymentPlanDetails = document.getElementById('paymentPlanDetails');
                
                // Update discount displays
                if (appliedDiscounts.sibling) {
                    const siblingDiscount = Math.round(originalFullPrice * 0.1);
                    document.getElementById('siblingDiscountAmount').textContent = `-$${siblingDiscount.toLocaleString()}`;
                    siblingDiscountRow.classList.remove('hidden');
                } else {
                    siblingDiscountRow.classList.add('hidden');
                }
                
                if (appliedDiscounts.group) {
                    const groupDiscount = Math.round(originalFullPrice * 0.15);
                    document.getElementById('groupDiscountAmount').textContent = `-$${groupDiscount.toLocaleString()}`;
                    groupDiscountRow.classList.remove('hidden');
                } else {
                    groupDiscountRow.classList.add('hidden');
                }
                
                // Check which payment option is selected
                const selectedPaymentOption = document.querySelector('input[name="paymentOption"]:checked')?.value;
                
                if (selectedPaymentOption === 'full') {
                    currentAmount = finalFullPrice;
                    discountRow.style.display = 'flex';
                    paymentPlanDetails.textContent = 'Full Payment (5% Discount Applied)';
                    totalAmount.textContent = `$${finalFullPrice.toLocaleString()}`;
                    submitBtn.innerHTML = `<i class="fas fa-lock mr-2"></i>Complete Payment - $${finalFullPrice.toLocaleString()}`;
                } else if (selectedPaymentOption === 'monthly') {
                    const downPayment = Math.ceil(basePrice * 0.3);
                    const monthlyPayment = Math.ceil((basePrice * 0.7) / 6);
                    currentAmount = downPayment;
                    discountRow.style.display = 'none';
                    paymentPlanDetails.innerHTML = `30% Down Payment Today<br><span class="text-xs">Then $${monthlyPayment.toLocaleString()}/month × 6 months</span>`;
                    totalAmount.textContent = `$${downPayment.toLocaleString()}`;
                    submitBtn.innerHTML = `<i class="fas fa-lock mr-2"></i>Pay Down Payment - $${downPayment.toLocaleString()}`;
                } else if (selectedPaymentOption === 'biweekly') {
                    const downPayment = Math.ceil(basePrice * 0.3);
                    const biweeklyPayment = Math.ceil((basePrice * 0.7) / 12);
                    currentAmount = downPayment;
                    discountRow.style.display = 'none';
                    paymentPlanDetails.innerHTML = `30% Down Payment Today<br><span class="text-xs">Then $${biweeklyPayment.toLocaleString()}/bi-weekly × 12 payments</span>`;
                    totalAmount.textContent = `$${downPayment.toLocaleString()}`;
                    submitBtn.innerHTML = `<i class="fas fa-lock mr-2"></i>Pay Down Payment - $${downPayment.toLocaleString()}`;
                } else {
                    // Legacy installments option fallback
                    const downPayment = Math.ceil(basePrice * 0.4);
                    const monthlyPayment = Math.ceil((basePrice - downPayment) / 5);
                    currentAmount = downPayment;
                    discountRow.style.display = 'none';
                    paymentPlanDetails.innerHTML = `Down Payment Today<br><span class="text-xs">Then $${monthlyPayment.toLocaleString()}/month × 5</span>`;
                    totalAmount.textContent = `$${downPayment.toLocaleString()}`;
                    submitBtn.innerHTML = `<i class="fas fa-lock mr-2"></i>Pay Down Payment - $${downPayment.toLocaleString()}`;
                }
            }

            // Free Trial Functionality
            const startFreeTrialBtn = document.getElementById('startFreeTrial');
            if (startFreeTrialBtn) {
                startFreeTrialBtn.addEventListener('click', function() {
                    // Show free trial modal
                    showFreeTrialModal(courseId, courseTitle);
                });
            }

            // Handle payment option changes
            const paymentOptions = document.querySelectorAll('input[name="paymentOption"]');
            paymentOptions.forEach(option => {
                option.addEventListener('change', updatePaymentCalculations);
            });
            
            // Handle discount options
            const siblingDiscount = document.getElementById('siblingDiscount');
            const groupDiscount = document.getElementById('groupDiscount');
            const siblingInfo = document.getElementById('siblingInfo');
            const groupInfo = document.getElementById('groupInfo');
            
            siblingDiscount.addEventListener('change', function() {
                appliedDiscounts.sibling = this.checked;
                if (this.checked) {
                    siblingInfo.classList.remove('hidden');
                    groupDiscount.checked = false; // Can't combine with group discount
                    appliedDiscounts.group = false;
                    groupInfo.classList.add('hidden');
                } else {
                    siblingInfo.classList.add('hidden');
                }
                updatePaymentCalculations();
            });
            
            groupDiscount.addEventListener('change', function() {
                appliedDiscounts.group = this.checked;
                if (this.checked) {
                    groupInfo.classList.remove('hidden');
                    siblingDiscount.checked = false; // Can't combine with sibling discount
                    appliedDiscounts.sibling = false;
                    siblingInfo.classList.add('hidden');
                } else {
                    groupInfo.classList.add('hidden');
                }
                updatePaymentCalculations();
            });
            
            // Initial calculation
            updatePaymentCalculations();

            // Handle agreement viewing
            const viewAgreementBtn = document.getElementById('viewAgreement');
            const agreementLink = document.getElementById('agreementLink');
            
            [viewAgreementBtn, agreementLink].forEach(btn => {
                if (btn) {
                    btn.addEventListener('click', showMenteeAgreement);
                }
            });
            
            // Handle schedule first session button
            const scheduleFirstSessionBtn = document.getElementById('scheduleFirstSession');
            if (scheduleFirstSessionBtn) {
                scheduleFirstSessionBtn.addEventListener('click', () => {
                    showScheduleSessionModal(courseTitle, type);
                });
            }

            // Stripe Elements will be initialized when needed for modals
            // Main payment flow uses Stripe Checkout (no card elements needed)

            // Handle form submission
            paymentForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const submitBtn = document.getElementById('paymentSubmit');
                const cardErrors = document.getElementById('card-errors');
                const agreementCheck = document.getElementById('agreementCheck');
                
                if (!agreementCheck.checked) {
                    cardErrors.textContent = 'Please read and accept the mentee agreement to continue.';
                    cardErrors.classList.remove('hidden');
                    return;
                }
                
                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Processing...';
                submitBtn.disabled = true;
                cardErrors.classList.add('hidden');

                try {
                    const selectedPaymentOption = type === 'mentor' ? 
                        document.querySelector('input[name="paymentOption"]:checked').value : 'full';
                    
                    // Create payment intent
                    const paymentIntentResponse = await api.createPaymentIntent({
                        course_id: parseInt(courseId),
                        amount: Math.round(currentAmount * 100), // Convert to cents
                        currency: 'usd',
                        payment_type: type,
                        payment_option: selectedPaymentOption,
                        customer_info: {
                            first_name: document.getElementById('firstName').value,
                            last_name: document.getElementById('lastName').value,
                            email: document.getElementById('customerEmail').value
                        }
                    });

                    // Confirm payment with Stripe
                    const {error} = await stripe.confirmCardPayment(paymentIntentResponse.client_secret, {
                        payment_method: {
                            card: cardElement,
                            billing_details: {
                                name: `${document.getElementById('firstName').value} ${document.getElementById('lastName').value}`,
                                email: document.getElementById('customerEmail').value,
                            },
                        }
                    });

                    if (error) {
                        throw new Error(error.message);
                    } else {
                        // Payment successful with Stripe, now confirm with backend
                        try {
                            const confirmResponse = await api.confirmPayment(paymentIntentResponse.payment_intent_id);
                            console.log('Payment confirmed with backend:', confirmResponse);
                            
                            // Payment successfully recorded in database
                            showPaymentSuccess(courseTitle, document.getElementById('customerEmail').value, selectedPaymentOption);
                        } catch (backendError) {
                            console.error('Backend confirmation failed:', backendError);
                            // Payment processed by Stripe but not recorded in database
                            cardErrors.textContent = 'Payment processed but enrollment failed. Please contact support with your payment confirmation.';
                            cardErrors.classList.remove('hidden');
                        }
                    }

                } catch (error) {
                    cardErrors.textContent = error.message;
                    cardErrors.classList.remove('hidden');
                } finally {
                    const selectedOption = type === 'mentor' ? document.querySelector('input[name="paymentOption"]:checked').value : 'full';
                    const btnText = selectedOption === 'installments' ? 
                        `<i class="fas fa-lock mr-2"></i>Complete First Payment - $${installmentPrice.toLocaleString()}` :
                        `<i class="fas fa-lock mr-2"></i>Complete Payment - $${currentAmount.toLocaleString()}`;
                    submitBtn.innerHTML = btnText;
                    submitBtn.disabled = false;
                }
            });
        }

        function showMenteeAgreement() {
            const agreementHTML = `
                <div id="agreementModal" class="modal-overlay show">
                    <div class="modal-content max-w-4xl max-h-[90vh] overflow-y-auto">
                        <div class="flex justify-between items-center mb-6 sticky top-0 bg-gray-800 p-4 -m-4 mb-4">
                            <h2 class="text-2xl font-bold text-white">TechStep Mentee Agreement</h2>
                            <button id="closeAgreementModal" class="text-gray-400 hover:text-white">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <div class="text-gray-300 space-y-4 text-sm leading-relaxed">
                            <h3 class="text-lg font-bold text-white">1. Program Overview</h3>
                            <p>The TechStep Cybersecurity Training Program ("Program") is a comprehensive 6-month educational experience designed to provide mentees with practical cybersecurity skills and knowledge. The Program includes course materials, live instruction, and one-on-one mentorship sessions.</p>
                            
                            <h3 class="text-lg font-bold text-white">2. Mentee Responsibilities</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li>Attend scheduled mentorship sessions as agreed upon with your assigned mentor</li>
                                <li>Complete assigned coursework and projects within the specified timeframes</li>
                                <li>Actively participate in learning activities and provide feedback when requested</li>
                                <li>Maintain professional conduct during all interactions with mentors and staff</li>
                                <li>Respect intellectual property rights of all course materials and content</li>
                            </ul>
                            
                            <h3 class="text-lg font-bold text-white">3. Mentor Commitment</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li>Provide weekly one-on-one mentorship sessions (minimum 1 hour per week)</li>
                                <li>Review and provide feedback on projects and assignments</li>
                                <li>Offer career guidance and industry insights</li>
                                <li>Respond to questions and concerns within 48 hours during business days</li>
                                <li>Maintain professional standards and confidentiality</li>
                            </ul>
                            
                            <h3 class="text-lg font-bold text-white">4. Payment Terms</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li><strong>Full Payment:</strong> 5% discount when paid in full upfront</li>
                                <li><strong>Installment Plan:</strong> 3 equal monthly payments (no additional fees)</li>
                                <li>All payments are processed securely through Stripe</li>
                                <li>Refund policy applies as outlined in Section 6</li>
                            </ul>
                            
                            <h3 class="text-lg font-bold text-white">5. Access and Materials</h3>
                            <p>Upon successful payment, mentees receive:</p>
                            <ul class="list-disc list-inside space-y-2">
                                <li>Immediate access to all course materials and video content</li>
                                <li>Lifetime access to course materials (even after program completion)</li>
                                <li>Access to private mentee community and resources</li>
                                <li>Certificate of completion upon successful program completion</li>
                                <li>Job placement assistance and career guidance</li>
                            </ul>
                            
                            <h3 class="text-lg font-bold text-white">6. Refund Policy</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li><strong>7-Day Money-Back Guarantee:</strong> Full refund if requested within 7 days of purchase</li>
                                <li><strong>No refunds after 7 days:</strong> All sales are final after the 7-day grace period</li>
                                <li>Installment plan refunds: If cancelled within 7 days, remaining payments will be cancelled and completed payments refunded</li>
                                <li>Refund processing takes 5-10 business days</li>
                                <li><strong>Important:</strong> Please ensure this program meets your needs before the 7-day period expires</li>
                            </ul>
                            
                            <h3 class="text-lg font-bold text-white">7. Intellectual Property</h3>
                            <p>All course materials, content, and resources are proprietary to TechStep and protected by copyright. Mentees may not:</p>
                            <ul class="list-disc list-inside space-y-2">
                                <li>Share, distribute, or resell course materials</li>
                                <li>Record or screenshot course content without permission</li>
                                <li>Use materials for commercial purposes outside of personal learning</li>
                            </ul>
                            
                            <h3 class="text-lg font-bold text-white">8. Privacy and Confidentiality</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li>Personal information is protected according to our Privacy Policy</li>
                                <li>Mentorship sessions may be recorded for quality assurance (with consent)</li>
                                <li>Mentees consent to use of anonymized success stories for marketing purposes</li>
                            </ul>
                            
                            <h3 class="text-lg font-bold text-white">9. Program Completion</h3>
                            <p>To receive a certificate of completion, mentees must:</p>
                            <ul class="list-disc list-inside space-y-2">
                                <li>Complete all required coursework and projects</li>
                                <li>Attend minimum 80% of scheduled mentorship sessions</li>
                                <li>Pass final assessment with a score of 80% or higher</li>
                                <li>Submit final capstone project for review</li>
                            </ul>
                            
                            <h3 class="text-lg font-bold text-white">10. Limitation of Liability</h3>
                            <p>TechStep provides educational services and career guidance but cannot guarantee specific job outcomes or salary increases. Our liability is limited to the amount paid for the program.</p>
                            
                            <h3 class="text-lg font-bold text-white">11. Contact Information</h3>
                            <p>For questions about this agreement or the program:</p>
                            <ul class="list-disc list-inside space-y-2">
                                <li>Email: support@techstep.com</li>
                                <li>Phone: 1-800-TECHSTEP</li>
                                <li>Business Hours: Monday-Friday, 9 AM - 6 PM EST</li>
                            </ul>
                            
                            <div class="bg-blue-900 rounded-lg p-4 mt-8">
                                <p class="text-blue-200 text-sm">
                                    <i class="fas fa-info-circle mr-2"></i>
                                    By proceeding with payment, you acknowledge that you have read, understood, and agree to be bound by these terms and conditions.
                                </p>
                            </div>
                        </div>
                        
                        <div class="flex justify-center mt-8">
                            <button id="acceptAgreement" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-8 rounded-lg transition duration-300">
                                <i class="fas fa-check mr-2"></i>I Understand and Accept
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', agreementHTML);
            
            const agreementModal = document.getElementById('agreementModal');
            const closeBtn = document.getElementById('closeAgreementModal');
            const acceptBtn = document.getElementById('acceptAgreement');
            
            closeBtn.addEventListener('click', () => {
                agreementModal.remove();
            });
            
            acceptBtn.addEventListener('click', () => {
                const agreementCheck = document.getElementById('agreementCheck');
                if (agreementCheck) {
                    agreementCheck.checked = true;
                }
                agreementModal.remove();
            });
        }

        function showScheduleSessionModal(courseTitle, type) {
            const scheduleHTML = `
                <div id="scheduleModal" class="modal-overlay show">
                    <div class="modal-content max-w-2xl">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold text-white">Schedule Your FREE First Session</h2>
                            <button id="closeScheduleModal" class="text-gray-400 hover:text-white">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <div class="bg-blue-900 rounded-lg p-4 mb-6">
                            <h3 class="text-lg font-bold text-white mb-2">
                                <i class="fas fa-gift mr-2"></i>${courseTitle} - First Week FREE
                            </h3>
                            <p class="text-blue-200 text-sm">
                                ${type === 'live-mentor-career' ? 'Guided Career Placement Program' : 'Live with Mentor Program'} - 
                                Try our mentorship program risk-free for one week!
                            </p>
                        </div>
                        
                        <form id="scheduleForm" class="space-y-4">
                            <div class="grid grid-cols-2 gap-4">
                                <input type="text" id="scheduleFirstName" placeholder="First Name" required 
                                       class="w-full p-3 rounded-lg bg-gray-700 text-white border border-gray-600 focus:border-blue-500 focus:outline-none">
                                <input type="text" id="scheduleLastName" placeholder="Last Name" required 
                                       class="w-full p-3 rounded-lg bg-gray-700 text-white border border-gray-600 focus:border-blue-500 focus:outline-none">
                            </div>
                            
                            <input type="email" id="scheduleEmail" placeholder="Email Address" required 
                                   class="w-full p-3 rounded-lg bg-gray-700 text-white border border-gray-600 focus:border-blue-500 focus:outline-none">
                            
                            <input type="tel" id="schedulePhone" placeholder="Phone Number" required 
                                   class="w-full p-3 rounded-lg bg-gray-700 text-white border border-gray-600 focus:border-blue-500 focus:outline-none">
                            
                            <div class="grid grid-cols-2 gap-4">
                                <select id="scheduleTimezone" required 
                                        class="w-full p-3 rounded-lg bg-gray-700 text-white border border-gray-600 focus:border-blue-500 focus:outline-none">
                                    <option value="">Select Timezone</option>
                                    <option value="America/New_York">Eastern Time (ET)</option>
                                    <option value="America/Chicago">Central Time (CT)</option>
                                    <option value="America/Denver">Mountain Time (MT)</option>
                                    <option value="America/Los_Angeles">Pacific Time (PT)</option>
                                    <option value="Europe/London">London (GMT)</option>
                                    <option value="Europe/Paris">Paris (CET)</option>
                                    <option value="Asia/Tokyo">Tokyo (JST)</option>
                                    <option value="Australia/Sydney">Sydney (AEST)</option>
                                </select>
                                
                                <select id="schedulePreferredTime" required 
                                        class="w-full p-3 rounded-lg bg-gray-700 text-white border border-gray-600 focus:border-blue-500 focus:outline-none">
                                    <option value="">Preferred Time</option>
                                    <option value="Morning (9-12 PM)">Morning (9-12 PM)</option>
                                    <option value="Afternoon (12-5 PM)">Afternoon (12-5 PM)</option>
                                    <option value="Evening (5-8 PM)">Evening (5-8 PM)</option>
                                    <option value="Flexible">I'm Flexible</option>
                                </select>
                            </div>
                            
                            <textarea id="scheduleGoals" placeholder="What are your career goals and what would you like to focus on in your first session?" 
                                      rows="3" class="w-full p-3 rounded-lg bg-gray-700 text-white border border-gray-600 focus:border-blue-500 focus:outline-none"></textarea>
                            
                            <div class="bg-gray-800 rounded-lg p-4">
                                <h4 class="text-white font-semibold mb-2">What happens next?</h4>
                                <ul class="text-sm text-gray-300 space-y-1">
                                    <li>• Our team will contact you within 24 hours</li>
                                    <li>• We'll schedule your FREE first mentorship session</li>
                                    <li>• You'll meet your assigned mentor and discuss your goals</li>
                                    <li>• If you're not satisfied, cancel within 7 days for a full refund</li>
                                </ul>
                            </div>
                            
                            <button type="submit" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-6 rounded-lg transition duration-300">
                                <i class="fas fa-calendar-check mr-2"></i>Schedule My FREE Session
                            </button>
                        </form>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', scheduleHTML);
            
            const scheduleModal = document.getElementById('scheduleModal');
            const closeBtn = document.getElementById('closeScheduleModal');
            const scheduleForm = document.getElementById('scheduleForm');
            
            closeBtn.addEventListener('click', () => {
                scheduleModal.remove();
            });
            
            scheduleForm.addEventListener('submit', (e) => {
                e.preventDefault();
                
                const formData = {
                    firstName: document.getElementById('scheduleFirstName').value,
                    lastName: document.getElementById('scheduleLastName').value,
                    email: document.getElementById('scheduleEmail').value,
                    phone: document.getElementById('schedulePhone').value,
                    timezone: document.getElementById('scheduleTimezone').value,
                    preferredTime: document.getElementById('schedulePreferredTime').value,
                    goals: document.getElementById('scheduleGoals').value,
                    course: courseTitle,
                    tier: type,
                    timestamp: new Date().toISOString()
                };
                
                // In a real implementation, this would send to support@techstepfoundation.org
                console.log('Scheduling request sent to support@techstepfoundation.org:', formData);
                
                // Show success message
                scheduleModal.innerHTML = `
                    <div class="modal-content max-w-md text-center">
                        <div class="mb-6">
                            <i class="fas fa-check-circle text-6xl text-green-500 mb-4"></i>
                            <h2 class="text-2xl font-bold text-white mb-2">Session Request Sent!</h2>
                            <p class="text-gray-300">Our team will contact you within 24 hours to schedule your FREE first session.</p>
                        </div>
                        
                        <div class="bg-blue-900 rounded-lg p-4 mb-6">
                            <p class="text-white text-sm mb-2">
                                <i class="fas fa-envelope mr-2"></i>
                                Confirmation sent to:
                            </p>
                            <p class="text-blue-300 font-semibold">${formData.email}</p>
                        </div>
                        
                        <button onclick="document.getElementById('scheduleModal').remove();" 
                                class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                            Got it!
                        </button>
                    </div>
                `;
            });
        }

        function showPaymentSuccess(courseTitle, email, paymentOption = 'full') {
            const successHTML = `
                <div id="successModal" class="modal-overlay show">
                    <div class="modal-content max-w-md text-center">
                        <div class="mb-6">
                            <i class="fas fa-check-circle text-6xl text-green-500 mb-4"></i>
                            <h2 class="text-2xl font-bold text-white mb-2">Payment Successful!</h2>
                            <p class="text-gray-300">Thank you for purchasing "${courseTitle}"</p>
                        </div>
                        
                        <div class="bg-blue-900 rounded-lg p-4 mb-6">
                            <p class="text-white text-sm mb-2">
                                <i class="fas fa-envelope mr-2"></i>
                                Login credentials have been sent to:
                            </p>
                            <p class="text-blue-300 font-semibold">${email}</p>
                        </div>
                        
                        <p class="text-gray-400 text-sm mb-6">
                            Please check your email (including spam folder) for your login details. 
                            You'll have immediate access to your course content.
                        </p>
                        
                        <button onclick="document.getElementById('successModal').remove(); document.getElementById('paymentModal').remove();" 
                                class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                            Got it!
                        </button>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', successHTML);
        }

        // Free Trial Modal Function
        function showFreeTrialModal(courseId, courseTitle) {
            const trialHTML = `
                <div id="freeTrialModal" class="modal-overlay show">
                    <div class="modal-content max-w-lg">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold text-white">🎉 Start Your 7-Day Free Trial</h2>
                            <button id="closeFreeTrialModal" class="text-gray-400 hover:text-white">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <div class="bg-gradient-to-r from-purple-600 to-blue-600 p-4 rounded-lg mb-6">
                            <h3 class="text-white font-bold text-lg mb-2">${courseTitle}</h3>
                            <p class="text-white/80 text-sm">Full access to all course materials for 7 days - completely free!</p>
                        </div>

                        <div class="space-y-4 mb-6">
                            <div class="flex items-center text-gray-300">
                                <i class="fas fa-check-circle text-green-400 mr-3"></i>
                                <span>Complete access to all course content</span>
                            </div>
                            <div class="flex items-center text-gray-300">
                                <i class="fas fa-check-circle text-green-400 mr-3"></i>
                                <span>Download resources and materials</span>
                            </div>
                            <div class="flex items-center text-gray-300">
                                <i class="fas fa-check-circle text-green-400 mr-3"></i>
                                <span>Access to community forums</span>
                            </div>
                            <div class="flex items-center text-gray-300">
                                <i class="fas fa-check-circle text-green-400 mr-3"></i>
                                <span>No credit card required</span>
                            </div>
                            <div class="flex items-center text-gray-300">
                                <i class="fas fa-check-circle text-green-400 mr-3"></i>
                                <span>Cancel anytime during trial</span>
                            </div>
                        </div>

                        <form id="freeTrialForm" class="space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-gray-300 text-sm font-medium mb-2">First Name</label>
                                    <input type="text" id="trialFirstName" required 
                                           class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                                </div>
                                <div>
                                    <label class="block text-gray-300 text-sm font-medium mb-2">Last Name</label>
                                    <input type="text" id="trialLastName" required 
                                           class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                                </div>
                            </div>
                            <div>
                                <label class="block text-gray-300 text-sm font-medium mb-2">Email Address</label>
                                <input type="email" id="trialEmail" required 
                                       class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                            </div>
                            <div>
                                <label class="block text-gray-300 text-sm font-medium mb-2">Phone Number (optional)</label>
                                <input type="tel" id="trialPhone" 
                                       class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                            </div>

                            <div class="flex items-start mt-4">
                                <input type="checkbox" id="trialTerms" required class="mt-1 mr-3">
                                <label for="trialTerms" class="text-gray-300 text-sm">
                                    I agree to the <a href="#" onclick="showTermsOfService(); return false;" class="text-purple-400 hover:text-purple-300">Terms of Service</a> 
                                    and understand this is a 7-day free trial with no obligations.
                                </label>
                            </div>

                            <button type="submit" id="startTrialBtn" 
                                    class="w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                                <i class="fas fa-play mr-2"></i>Start My Free Trial
                            </button>
                        </form>

                        <p class="text-xs text-gray-500 text-center mt-4">
                            Trial ends automatically after 7 days. No charges will be made unless you choose to continue.
                        </p>
                    </div>
                </div>
            `;

            // Remove existing modal if any
            const existingModal = document.getElementById('freeTrialModal');
            if (existingModal) existingModal.remove();

            document.body.insertAdjacentHTML('beforeend', trialHTML);

            // Setup modal functionality
            const modal = document.getElementById('freeTrialModal');
            const closeBtn = document.getElementById('closeFreeTrialModal');
            const form = document.getElementById('freeTrialForm');

            closeBtn.addEventListener('click', () => {
                modal.classList.remove('show');
                setTimeout(() => modal.remove(), 300);
            });

            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const firstName = document.getElementById('trialFirstName').value;
                const lastName = document.getElementById('trialLastName').value;
                const email = document.getElementById('trialEmail').value;
                const phone = document.getElementById('trialPhone').value;
                const submitBtn = document.getElementById('startTrialBtn');

                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Starting Trial...';
                submitBtn.disabled = true;

                try {
                    // Here you would typically make an API call to start the free trial
                    // For now, we'll simulate the process
                    await new Promise(resolve => setTimeout(resolve, 2000));

                    // Show success message
                    showFreeTrialSuccess(courseTitle, email, firstName);
                    modal.remove();

                } catch (error) {
                    console.error('Free trial signup failed:', error);
                    alert('Failed to start free trial. Please try again.');
                    submitBtn.innerHTML = '<i class="fas fa-play mr-2"></i>Start My Free Trial';
                    submitBtn.disabled = false;
                }
            });
        }

        function showFreeTrialSuccess(courseTitle, email, firstName) {
            const successHTML = `
                <div id="trialSuccessModal" class="modal-overlay show">
                    <div class="modal-content max-w-md text-center">
                        <div class="mb-6">
                            <i class="fas fa-rocket text-6xl text-purple-500 mb-4"></i>
                            <h2 class="text-2xl font-bold text-white mb-2">Trial Started!</h2>
                            <p class="text-gray-300">Welcome to your 7-day free trial of "${courseTitle}"</p>
                        </div>
                        
                        <div class="bg-purple-900 rounded-lg p-4 mb-6">
                            <p class="text-white text-sm mb-2">
                                <i class="fas fa-envelope mr-2"></i>
                                Login credentials have been sent to:
                            </p>
                            <p class="text-purple-300 font-semibold">${email}</p>
                        </div>
                        
                        <div class="bg-blue-900 rounded-lg p-4 mb-6">
                            <p class="text-blue-300 text-sm">
                                <i class="fas fa-clock mr-2"></i>
                                Your trial expires in 7 days. We'll send you a reminder 2 days before it ends.
                            </p>
                        </div>
                        
                        <button onclick="document.getElementById('trialSuccessModal').remove();" 
                                class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                            Start Learning Now!
                        </button>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', successHTML);
        }

        // Consultation Booking Functions
        function showConsultationBooking(courseId, courseTitle) {
            const modalHTML = `
                <div id="consultationModal" class="modal-overlay">
                    <div class="modal-content max-w-3xl">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold text-white">Book FREE 30-Minute Consultation</h2>
                            <button id="closeConsultationModal" class="text-gray-400 hover:text-white">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <div class="bg-blue-900 rounded-lg p-4 mb-6">
                            <h3 class="text-lg font-bold text-white mb-2">
                                <i class="fas fa-gift mr-2"></i>FREE Consultation for "${courseTitle}"
                            </h3>
                            <p class="text-blue-200 text-sm">
                                Discuss your learning goals with our expert mentor before purchasing the full course.
                            </p>
                        </div>

                        <form id="consultationForm" class="space-y-4">
                            <div class="grid grid-cols-2 gap-4">
                                <input type="text" id="consultFirstName" placeholder="First Name" required 
                                       class="w-full p-3 rounded-lg bg-gray-700 text-white border border-gray-600 focus:border-blue-500 focus:outline-none">
                                <input type="text" id="consultLastName" placeholder="Last Name" required 
                                       class="w-full p-3 rounded-lg bg-gray-700 text-white border border-gray-600 focus:border-blue-500 focus:outline-none">
                            </div>
                            
                            <input type="email" id="consultEmail" placeholder="Email Address" required 
                                   class="w-full p-3 rounded-lg bg-gray-700 text-white border border-gray-600 focus:border-blue-500 focus:outline-none">
                            
                            <input type="tel" id="consultPhone" placeholder="Phone Number" required 
                                   class="w-full p-3 rounded-lg bg-gray-700 text-white border border-gray-600 focus:border-blue-500 focus:outline-none">
                            
                            <div>
                                <label class="block text-white text-sm font-bold mb-2">Select Available Time Slot:</label>
                                <div id="timeSlots" class="grid grid-cols-2 gap-2">
                                    <!-- Time slots will be populated by calendar -->
                                </div>
                            </div>
                            
                            <textarea id="consultMessage" placeholder="What specific topics or goals would you like to discuss? (Optional)" 
                                      class="w-full p-3 rounded-lg bg-gray-700 text-white border border-gray-600 focus:border-blue-500 focus:outline-none h-24"></textarea>
                            
                            <button type="submit" id="consultationSubmit" 
                                    class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-6 rounded-lg transition duration-300">
                                <i class="fas fa-calendar-plus mr-2"></i>Book FREE Consultation
                            </button>
                        </form>
                    </div>
                </div>
            `;

            // Remove existing modal if any
            const existingModal = document.getElementById('consultationModal');
            if (existingModal) existingModal.remove();

            document.body.insertAdjacentHTML('beforeend', modalHTML);
            setupConsultationModal(courseId, courseTitle);
        }

        function setupConsultationModal(courseId, courseTitle) {
            const consultationModal = document.getElementById('consultationModal');
            const closeBtn = document.getElementById('closeConsultationModal');
            const consultationForm = document.getElementById('consultationForm');
            
            // Show modal
            consultationModal.classList.add('show');

            // Close modal
            closeBtn.addEventListener('click', () => {
                consultationModal.classList.remove('show');
                setTimeout(() => consultationModal.remove(), 300);
            });

            // Load available time slots
            loadAvailableTimeSlots();

            // Handle form submission
            consultationForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const submitBtn = document.getElementById('consultationSubmit');
                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Booking...';
                submitBtn.disabled = true;

                try {
                    const selectedSlot = document.querySelector('input[name="timeSlot"]:checked');
                    if (!selectedSlot) {
                        throw new Error('Please select a time slot');
                    }

                    const bookingData = {
                        course_id: courseId,
                        course_title: courseTitle,
                        first_name: document.getElementById('consultFirstName').value,
                        last_name: document.getElementById('consultLastName').value,
                        email: document.getElementById('consultEmail').value,
                        phone: document.getElementById('consultPhone').value,
                        time_slot: selectedSlot.value,
                        message: document.getElementById('consultMessage').value
                    };

                    const response = await api.bookConsultation(bookingData);

                    showConsultationSuccess(bookingData.email, selectedSlot.dataset.readable);

                } catch (error) {
                    alert('Booking failed: ' + error.message);
                } finally {
                    submitBtn.innerHTML = '<i class="fas fa-calendar-plus mr-2"></i>Book FREE Consultation';
                    submitBtn.disabled = false;
                }
            });
        }

        function loadAvailableTimeSlots() {
            // Generate next 7 days with available times
            const timeSlotsContainer = document.getElementById('timeSlots');
            const timeSlots = [];
            
            const today = new Date();
            const times = ['10:00 AM', '11:00 AM', '2:00 PM', '3:00 PM', '4:00 PM'];
            
            for (let i = 1; i <= 7; i++) {
                const date = new Date(today);
                date.setDate(today.getDate() + i);
                
                if (date.getDay() !== 0 && date.getDay() !== 6) { // Skip weekends
                    times.forEach(time => {
                        const datetime = `${date.toISOString().split('T')[0]}T${time.includes('PM') && !time.startsWith('12') ? 
                            (parseInt(time.split(':')[0]) + 12) + ':' + time.split(':')[1].split(' ')[0] : 
                            time.split(' ')[0]}:00`;
                        
                        timeSlots.push({
                            value: datetime,
                            readable: `${date.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' })} at ${time}`
                        });
                    });
                }
            }

            timeSlotsContainer.innerHTML = timeSlots.map(slot => `
                <label class="flex items-center p-3 bg-gray-700 rounded-lg hover:bg-blue-700 cursor-pointer transition duration-300">
                    <input type="radio" name="timeSlot" value="${slot.value}" data-readable="${slot.readable}" 
                           class="mr-3 text-blue-600">
                    <span class="text-white text-sm">${slot.readable}</span>
                </label>
            `).join('');
        }

        function showConsultationSuccess(email, timeSlot) {
            const successHTML = `
                <div id="consultationSuccessModal" class="modal-overlay show">
                    <div class="modal-content max-w-md text-center">
                        <div class="mb-6">
                            <i class="fas fa-calendar-check text-6xl text-green-500 mb-4"></i>
                            <h2 class="text-2xl font-bold text-white mb-2">Consultation Booked!</h2>
                            <p class="text-gray-300">Your FREE consultation is scheduled</p>
                        </div>
                        
                        <div class="bg-green-900 rounded-lg p-4 mb-6">
                            <p class="text-white font-semibold mb-2">
                                <i class="fas fa-clock mr-2"></i>${timeSlot}
                            </p>
                            <p class="text-green-300 text-sm">
                                Confirmation details sent to: ${email}
                            </p>
                        </div>
                        
                        <p class="text-gray-400 text-sm mb-6">
                            You'll receive a calendar invite and Zoom link via email. 
                            Our mentor will contact you 5 minutes before the session.
                        </p>
                        
                        <button onclick="document.getElementById('consultationSuccessModal').remove(); document.getElementById('consultationModal').remove();" 
                                class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                            Perfect!
                        </button>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', successHTML);
        }

        // Enhanced login/register functionality (for existing customers)
        function showAuthModal() {
            console.log('showAuthModal called');
            console.log('API authenticated:', api.isAuthenticated());
            if (api.isAuthenticated()) {
                // Show dashboard
                showDashboard();
            } else {
                // Show login modal for existing customers only
                console.log('Showing student login modal');
                showStudentLoginModal();
            }
        }

        async function showDashboard() {
            try {
                const dashboardData = await api.getUserDashboard();
                updateDashboardWithRealData(dashboardData);
                document.getElementById('dashboardModal').classList.add('show');
                setTimeout(() => {
                    animateDashboardProgress();
                }, 300);
            } catch (error) {
                console.error('Failed to load dashboard:', error);
                alert('Failed to load dashboard data');
            }
        }

        function updateDashboardWithRealData(data) {
            // Update user info
            const userNameEl = document.querySelector('#dashboardModal .text-2xl.font-bold');
            if (userNameEl && data.user) {
                userNameEl.textContent = data.user.full_name;
            }

            // Update stats
            if (data.stats) {
                const statsElements = document.querySelectorAll('#dashboardModal .stats-card');
                if (statsElements.length >= 4) {
                    statsElements[0].querySelector('.text-3xl').textContent = data.stats.total_courses || 0;
                    statsElements[1].querySelector('.text-3xl').textContent = data.stats.completed_courses || 0;
                    statsElements[2].querySelector('.text-3xl').textContent = data.stats.total_bookings || 0;
                    statsElements[3].querySelector('.text-3xl').textContent = `$${data.stats.total_spent || 0}`;
                }
            }
        }

        function showStudentLoginModal() {
            // Login modal for existing customers only
            const modalHTML = `
                <div id="authModal" class="modal-overlay">
                    <div class="modal-content max-w-md">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold text-white">Mentee Login</h2>
                            <button id="closeAuthModal" class="text-gray-400 hover:text-white">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <div class="bg-blue-900 rounded-lg p-4 mb-6">
                            <p class="text-blue-200 text-sm">
                                <i class="fas fa-info-circle mr-2"></i>
                                This login is for existing mentees who have already purchased courses.
                            </p>
                        </div>
                        
                        <form id="studentLoginForm">
                            <input type="email" id="studentEmail" placeholder="Email Address" required 
                                   class="w-full p-3 mb-4 rounded-lg bg-gray-700 text-white border border-gray-600 focus:border-blue-500 focus:outline-none">
                            <input type="password" id="studentPassword" placeholder="Password" required 
                                   class="w-full p-3 mb-6 rounded-lg bg-gray-700 text-white border border-gray-600 focus:border-blue-500 focus:outline-none">
                            
                            <button type="submit" id="studentLoginSubmit" 
                                    class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300">
                                <i class="fas fa-sign-in-alt mr-2"></i>Access My Courses
                            </button>
                        </form>
                        
                        <div id="loginError" class="mt-4 text-red-400 text-sm hidden"></div>
                        
                        <div class="mt-6 text-center">
                            <p class="text-gray-400 text-sm mb-2">Don't have an account yet?</p>
                            <button onclick="document.getElementById('authModal').remove(); document.querySelector('#courses').scrollIntoView();" 
                                    class="text-blue-400 hover:text-blue-300 underline text-sm">
                                Browse Courses & Purchase
                            </button>
                        </div>
                    </div>
                </div>
            `;

            // Remove existing auth modal if any
            const existingModal = document.getElementById('authModal');
            if (existingModal) {
                existingModal.remove();
            }

            // Add modal to page
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            
            // Setup modal functionality
            setupStudentLoginModal();
        }

        function setupStudentLoginModal() {
            const authModal = document.getElementById('authModal');
            const closeBtn = document.getElementById('closeAuthModal');
            const loginForm = document.getElementById('studentLoginForm');
            const loginSubmit = document.getElementById('studentLoginSubmit');
            const loginError = document.getElementById('loginError');

            // Show modal
            authModal.classList.add('show');

            // Close modal
            closeBtn.addEventListener('click', () => {
                authModal.classList.remove('show');
                setTimeout(() => authModal.remove(), 300);
            });

            // Form submission
            loginForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                loginError.classList.add('hidden');
                
                const email = document.getElementById('studentEmail').value;
                const password = document.getElementById('studentPassword').value;
                
                try {
                    loginSubmit.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Signing in...';
                    loginSubmit.disabled = true;

                    const response = await api.login(email, password);
                    currentUser = response.user;

                    updateUIForAuthenticatedUser();
                    authModal.classList.remove('show');
                    setTimeout(() => authModal.remove(), 300);
                    
                    // Show dashboard
                    setTimeout(() => showDashboard(), 500);
                    
                } catch (error) {
                    loginError.textContent = error.message || 'Invalid email or password';
                    loginError.classList.remove('hidden');
                } finally {
                    loginSubmit.innerHTML = '<i class="fas fa-sign-in-alt mr-2"></i>Access My Courses';
                    loginSubmit.disabled = false;
                }
            });
        }

        // Update the admin login button event listener
        function setupAdminLoginButton() {
            const adminLoginBtn = document.getElementById('adminLoginBtn');
            console.log('Setting up admin login button:', adminLoginBtn);
            if (adminLoginBtn) {
                adminLoginBtn.addEventListener('click', function() {
                    console.log('Mentee login button clicked');
                    handleMenteeLogin();
                });
            } else {
                console.error('Admin login button not found!');
            }
        }
        
        function handleMenteeLogin() {
            // Check if user is already enrolled and provisioned
            const enrolledUser = localStorage.getItem('techstep_enrolled_user');
            const isProvisioned = localStorage.getItem('techstep_user_provisioned');
            
            if (enrolledUser && isProvisioned === 'true') {
                // Redirect to dashboard
                window.location.href = '/login';
            } else if (enrolledUser && isProvisioned !== 'true') {
                // User enrolled but not yet provisioned
                showProvisioningMessage();
            } else {
                // User not enrolled - redirect to enrollment
                showEnrollmentRequiredMessage();
            }
        }
        
        function showProvisioningMessage() {
            const modalHTML = `
                <div id="provisioning-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
                    <div class="bg-gray-800 border border-gray-700 rounded-lg max-w-md w-full mx-4 p-6">
                        <div class="text-center">
                            <div class="w-16 h-16 bg-yellow-600 rounded-full flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-clock text-white text-2xl"></i>
                            </div>
                            <h3 class="text-xl font-bold text-white mb-2">Account Setup in Progress</h3>
                            <p class="text-gray-300 mb-6">Your account is being prepared. You'll receive login credentials via email within 24 hours of enrollment.</p>
                            
                            <div class="space-y-3">
                                <p class="text-sm text-gray-400">Need help? Contact <a href="mailto:support@techstepfoundation.org" class="text-blue-400 hover:underline">support@techstepfoundation.org</a></p>
                                <button onclick="closeProvisioningModal()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-6 rounded-lg transition duration-300">
                                    OK
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }
        
        function closeProvisioningModal() {
            const modal = document.getElementById('provisioning-modal');
            if (modal) {
                modal.remove();
            }
        }
        
        function showEnrollmentRequiredMessage() {
            const modalHTML = `
                <div id="enrollment-required-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
                    <div class="bg-gray-800 border border-gray-700 rounded-lg max-w-md w-full mx-4 p-6">
                        <div class="text-center">
                            <div class="w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-graduation-cap text-white text-2xl"></i>
                            </div>
                            <h3 class="text-xl font-bold text-white mb-2">Enrollment Required</h3>
                            <p class="text-gray-300 mb-4">Please enroll in a course to access the mentee portal.</p>
                            <p class="text-sm text-gray-400 mb-6">Questions? Contact <a href="mailto:support@techstepfoundation.org" class="text-blue-400 hover:underline">support@techstepfoundation.org</a></p>
                            
                            <div class="space-y-3">
                                <button onclick="redirectToEnrollment()" class="w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                                    <i class="fas fa-arrow-right mr-2"></i>Enroll Now
                                </button>
                                <button onclick="closeEnrollmentModal()" class="w-full border border-gray-600 text-gray-300 hover:text-white hover:bg-gray-700 font-medium py-3 px-6 rounded-lg transition duration-300">
                                    Maybe Later
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }
        
        function redirectToEnrollment() {
            closeEnrollmentModal();
            const coursesSection = document.getElementById('courses-section') || document.querySelector('.course-card');
            if (coursesSection) {
                coursesSection.scrollIntoView({ behavior: 'smooth' });
            }
        }
        
        function closeEnrollmentModal() {
            const modal = document.getElementById('enrollment-required-modal');
            if (modal) {
                modal.remove();
            }
        }

        // Chatbot functionality
        let chatbotVisible = false;
        let chatbotTimeout;
        
        function createChatbot() {
            if (chatbotVisible) return;
            
            const chatbotHTML = `
                <div id="chatbot-container" class="fixed bottom-6 right-6 z-50">
                    <!-- Enhanced Chat bubble with animations -->
                    <div id="chat-bubble" class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-4 py-3 rounded-2xl shadow-2xl mb-3 max-w-xs animate-pulse hover:from-blue-500 hover:to-purple-500 transition-all transform hover:scale-105 cursor-pointer">
                        <div class="flex items-start space-x-3">
                            <div class="w-8 h-8 bg-white bg-opacity-20 rounded-full flex items-center justify-center flex-shrink-0 animate-bounce">
                                <i class="fas fa-user-graduate text-xs"></i>
                            </div>
                            <div>
                                <div class="text-sm font-medium mb-1">
                                    Hi! I'm Sarah 👋
                                </div>
                                <div class="text-xs text-blue-100">
                                    Cybersecurity mentor with 8+ years experience. Ready to help you find the perfect course for your career goals!
                                </div>
                                <div class="text-xs text-blue-200 mt-2 font-semibold">
                                    💬 Click to start interactive chat!
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Enhanced Chat button with pulse animation -->
                    <button id="chat-button" class="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 text-white p-4 rounded-full shadow-2xl transition-all duration-300 transform hover:scale-110 animate-pulse relative">
                        <div class="absolute inset-0 bg-gradient-to-r from-blue-400 to-purple-400 rounded-full animate-ping opacity-20"></div>
                        <i class="fas fa-comments text-xl relative z-10"></i>
                        <div class="absolute -top-2 -right-2 w-4 h-4 bg-red-500 rounded-full flex items-center justify-center">
                            <div class="w-2 h-2 bg-white rounded-full animate-pulse"></div>
                        </div>
                    </button>
                    
                    <!-- Chat window (initially hidden) -->
                    <div id="chat-window" class="hidden absolute bottom-16 right-0 w-80 bg-white rounded-lg shadow-2xl border border-gray-300">
                        <div class="bg-gradient-to-r from-blue-600 to-purple-600 text-white p-4 rounded-t-lg flex justify-between items-center relative overflow-hidden">
                            <!-- Animated background elements -->
                            <div class="absolute inset-0 opacity-10">
                                <div class="absolute top-2 left-4 w-2 h-2 bg-white rounded-full animate-pulse"></div>
                                <div class="absolute bottom-3 right-8 w-1 h-1 bg-yellow-300 rounded-full animate-bounce"></div>
                            </div>
                            
                            <div class="flex items-center relative z-10">
                                <div class="relative mr-3">
                                    <img src="https://www.shutterstock.com/image-photo/happy-attractive-indian-woman-looking-260nw-2449701411.jpg" 
                                         alt="Sarah" class="w-10 h-10 rounded-full object-cover border-2 border-white border-opacity-30">
                                    <div class="absolute -bottom-1 -right-1 w-3 h-3 bg-green-400 rounded-full border border-white">
                                        <div class="w-1 h-1 bg-white rounded-full m-auto mt-0.5 animate-pulse"></div>
                                    </div>
                                </div>
                                <div>
                                    <div class="font-bold">Sarah Martinez</div>
                                    <div class="text-xs text-blue-200 flex items-center">
                                        <i class="fas fa-shield-alt mr-1 text-yellow-300"></i>
                                        Cybersecurity Mentor • Online
                                    </div>
                                </div>
                            </div>
                            <button id="close-chat" class="text-white hover:bg-white hover:bg-opacity-20 p-2 rounded-full transition-all relative z-10">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <div class="p-4 space-y-3 max-h-64 overflow-y-auto" id="chat-messages">
                            <div class="flex items-start space-x-2">
                                <img src="https://www.shutterstock.com/image-photo/happy-attractive-indian-woman-looking-260nw-2449701411.jpg" 
                                     alt="Sarah" class="w-6 h-6 rounded-full object-cover">
                                <div class="bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-3 text-sm text-gray-800 border border-blue-200">
                                    <div class="font-semibold text-blue-800 mb-1">Hi there! 👋</div>
                                    <div class="mb-2">I'm Sarah, and I've helped over <span class="font-bold text-purple-600">200+ professionals</span> transition into cybersecurity! 🚀</div>
                                    <div class="text-blue-700">What's your current background and career goals? 🎯</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="p-3 border-t border-gray-200">
                            <div class="flex space-x-2">
                                <input type="text" id="chat-input" placeholder="Type your question..." 
                                       class="flex-1 p-2 border border-gray-300 rounded-lg text-sm text-gray-900 bg-white focus:outline-none focus:border-blue-500 placeholder-gray-500">
                                <button id="send-message" class="bg-blue-600 text-white px-3 py-2 rounded-lg hover:bg-blue-700">
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                            <div class="text-xs text-gray-500 mt-2">
                                <i class="fas fa-envelope mr-1"></i>
                                Need detailed help? We'll connect you with our team at support@techstepfoundation.org
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', chatbotHTML);
            
            const chatButton = document.getElementById('chat-button');
            const chatBubble = document.getElementById('chat-bubble');
            const chatWindow = document.getElementById('chat-window');
            const closeChat = document.getElementById('close-chat');
            const chatInput = document.getElementById('chat-input');
            const sendButton = document.getElementById('send-message');
            const chatMessages = document.getElementById('chat-messages');
            
            chatbotVisible = true;
            
            // Hide bubble after 10 seconds
            setTimeout(() => {
                if (chatBubble) chatBubble.style.display = 'none';
            }, 10000);
            
            // Chat button click
            [chatButton, chatBubble].forEach(element => {
                if (element) {
                    element.addEventListener('click', () => {
                        chatWindow.classList.toggle('hidden');
                        if (chatBubble) chatBubble.style.display = 'none';
                        if (!chatWindow.classList.contains('hidden')) {
                            chatInput.focus();
                        }
                    });
                }
            });
            
            // Close chat
            closeChat.addEventListener('click', () => {
                chatWindow.classList.add('hidden');
            });
            
            // Send message
            function sendMessage() {
                const message = chatInput.value.trim();
                if (!message) return;
                
                // Add user message
                const userMessageHTML = `
                    <div class="flex items-start space-x-2 justify-end">
                        <div class="bg-blue-600 text-white rounded-lg p-2 text-sm max-w-xs">
                            ${message}
                        </div>
                        <div class="w-6 h-6 bg-gray-400 rounded-full flex items-center justify-center">
                            <i class="fas fa-user text-white text-xs"></i>
                        </div>
                    </div>
                `;
                chatMessages.insertAdjacentHTML('beforeend', userMessageHTML);
                
                chatInput.value = '';
                
                // Auto-response based on keywords
                setTimeout(() => {
                    let response = '';
                    const msg = message.toLowerCase();
                    
                    if (msg.includes('price') || msg.includes('cost') || msg.includes('payment')) {
                        response = "Great question! Our programs are $2,499 for self-service and $4,999 for mentor-guided. We offer 5% discount for full payment or monthly installments. Plus, we have sibling and group discounts available!";
                    } else if (msg.includes('beginner') || msg.includes('experience') || msg.includes('background')) {
                        response = "No worries about experience level! Our programs are designed for all backgrounds. Whether you're in IT, finance, or completely new to tech, we'll help you transition into cybersecurity. What's your current role?";
                    } else if (msg.includes('job') || msg.includes('career') || msg.includes('salary')) {
                        response = "Excellent! Our graduates typically see 40-80% salary increases. The cybersecurity field has over 3.5 million open positions globally. With 6 months of intensive training and mentorship, you'll be job-ready!";
                    } else if (msg.includes('mentor') || msg.includes('support')) {
                        response = "Our mentors are industry professionals with 10+ years experience. You get weekly 1-on-1 sessions, project reviews, and career guidance. It's like having a senior cybersecurity professional as your personal coach!";
                    } else if (msg.includes('time') || msg.includes('schedule') || msg.includes('hours')) {
                        response = "The program is a comprehensive 6-month guided career placement program - about 7-10 hours per week. Most students do evenings and weekends. Our mentors work around your availability.";
                    } else {
                        response = "That's a great question! I'd love to give you a detailed answer. Let me connect you with our team who can provide specific guidance. Would you like me to have someone contact you at your email?";
                    }
                    
                    const botMessageHTML = `
                        <div class="flex items-start space-x-2">
                            <img src="https://www.shutterstock.com/image-photo/happy-attractive-indian-woman-looking-260nw-2449701411.jpg" 
                                 alt="Sarah" class="w-6 h-6 rounded-full object-cover">
                            <div class="bg-gray-100 rounded-lg p-2 text-sm text-gray-800 max-w-xs">
                                ${response}
                            </div>
                        </div>
                    `;
                    chatMessages.insertAdjacentHTML('beforeend', botMessageHTML);
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                    
                    // Collect contact info
                    setTimeout(() => {
                        const contactHTML = `
                            <div class="flex items-start space-x-2">
                                <img src="https://www.shutterstock.com/image-photo/happy-attractive-indian-woman-looking-260nw-2449701411.jpg" 
                                     alt="Sarah" class="w-6 h-6 rounded-full object-cover">
                                <div class="bg-gray-100 rounded-lg p-2 text-sm text-gray-800 max-w-xs">
                                    <div class="mb-2">Can I get your email so our team can follow up with personalized guidance?</div>
                                    <input type="email" id="visitor-email" placeholder="your@email.com" 
                                           class="w-full p-1 border border-gray-300 rounded text-xs">
                                    <button onclick="collectVisitorInfo()" class="bg-blue-600 text-white px-2 py-1 rounded text-xs mt-1">
                                        Send to Team
                                    </button>
                                </div>
                            </div>
                        `;
                        chatMessages.insertAdjacentHTML('beforeend', contactHTML);
                        chatMessages.scrollTop = chatMessages.scrollHeight;
                    }, 2000);
                }, 1000);
                
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            sendButton.addEventListener('click', sendMessage);
            chatInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') sendMessage();
            });
        }
        
        // Collect visitor information
        window.collectVisitorInfo = function() {
            const email = document.getElementById('visitor-email').value;
            if (!email || !email.includes('@')) {
                alert('Please enter a valid email address');
                return;
            }
            
            // Send to support email (in real implementation, this would be an API call)
            console.log('Sending visitor info to support@techstepfoundation.org:', {
                email: email,
                timestamp: new Date().toISOString(),
                page: window.location.href,
                userAgent: navigator.userAgent
            });
            
            const confirmationHTML = `
                <div class="flex items-start space-x-2">
                    <img src="https://www.shutterstock.com/image-photo/happy-attractive-indian-woman-looking-260nw-2449701411.jpg" 
                         alt="Sarah" class="w-6 h-6 rounded-full object-cover">
                    <div class="bg-green-100 rounded-lg p-2 text-sm text-green-800 max-w-xs">
                        Perfect! I've sent your info to our team. You'll hear from us within 24 hours with personalized course recommendations. Thanks for your interest! 🎉
                    </div>
                </div>
            `;
            document.getElementById('chat-messages').insertAdjacentHTML('beforeend', confirmationHTML);
            document.getElementById('chat-messages').scrollTop = document.getElementById('chat-messages').scrollHeight;
        }

        // Course loading function
        async function loadCourses() {
            try {
                const courses = await api.getCourses();
                console.log('Courses loaded:', courses.length);
                // Courses are statically defined in HTML, so this is mainly for future dynamic loading
            } catch (error) {
                console.log('Using static course data - API not available');
            }
        }

        // Main DOMContentLoaded listener - consolidate all initialization
        // IMMEDIATE FUNCTION - Always Available
        function selectSOCCourse() {
            console.log('🚨 DIRECT BUTTON: SOC Course Selected!');
            
            try {
                // Check the checkbox
                const checkbox = document.querySelector('[data-course="soc-analyst"] .course-checkbox');
                if (checkbox) {
                    checkbox.checked = true;
                    console.log('✅ Checkbox checked');
                }
                
                // Direct cart update
                const cartItems = document.getElementById('cart-items');
                const totalElement = document.getElementById('total-price');
                const paymentSelector = document.getElementById('payment-plan-selector');
                const paymentButtons = document.getElementById('payment-buttons-container');
                const noCoursesMessage = document.getElementById('no-courses-message');
                
                // Update cart immediately
                if (cartItems) {
                    cartItems.innerHTML = `
                        <div class="flex justify-between items-center py-2">
                            <span class="text-white">SOC Analyst Foundations</span>
                            <span class="text-blue-400 font-semibold">Selected ✓</span>
                        </div>
                    `;
                    console.log('✅ Cart items updated');
                }
                
                if (totalElement) {
                    totalElement.textContent = '$2,849';
                    console.log('✅ Total updated');
                }
                
                if (noCoursesMessage) {
                    noCoursesMessage.style.display = 'none';
                    console.log('✅ No courses message hidden');
                }
                
                if (paymentSelector) {
                    paymentSelector.classList.remove('hidden');
                    console.log('✅ Payment selector shown');
                }
                
                if (paymentButtons) {
                    paymentButtons.classList.remove('hidden');
                    console.log('✅ Payment buttons shown');
                }
                
                // Change button text to indicate success
                const button = event.target;
                if (button) {
                    button.textContent = '✅ SELECTED! Check cart below';
                    button.className = 'w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg';
                }
                
                // Scroll to cart
                setTimeout(() => {
                    document.querySelector('.bg-gray-700.p-6.rounded-lg.max-w-md.mx-auto')?.scrollIntoView({
                        behavior: 'smooth',
                        block: 'center'
                    });
                }, 500);
                
                alert('✅ SOC Analyst Foundations added to cart! Check the Order Summary below.');
                
            } catch (error) {
                console.error('Error in selectSOCCourse:', error);
                alert('There was an issue. Please refresh the page and try again.');
            }
        }
        
        // DIRECT CHECKBOX HANDLER
        function handleSOCCheckboxChange(checkbox) {
            console.log('🎯 Direct checkbox change:', checkbox.checked);
            if (checkbox.checked) {
                selectSOCCourse();
            } else {
                // Reset cart
                const cartItems = document.getElementById('cart-items');
                const totalElement = document.getElementById('total-price');
                if (cartItems) cartItems.innerHTML = '<p class="text-gray-400">Select SOC Analyst course below to see pricing</p>';
                if (totalElement) totalElement.textContent = '$0';
            }
        }
        
        document.addEventListener('DOMContentLoaded', async function() {
            // Initialize course selection functionality
            initializeCourseSelection();
            
            // Initialize cart display
            updateCart();
            
            // Setup event listeners
            setupAdminLoginButton();
            
            // Check authentication status
            await checkAuthStatus();
            
            // Load courses from API
            await loadCourses();
            
            // Show enhanced interactive chatbot after 10 seconds
            chatbotTimeout = setTimeout(createChatbot, 10000);
            
            // Initialize Stripe payment system
            initializeStripePayments();
            
            // Setup course selection handlers
            setupCourseSelection();
        });
        
        function setupCourseSelection() {
            console.log('🔧 SIMPLE Setup: Course selection...');
            
            // APPROACH 1: Direct event listeners with multiple attempts
            function attachListeners() {
                const socCheckbox = document.querySelector('[data-course="soc-analyst"] .course-checkbox');
                console.log('🎯 SOC Checkbox found:', !!socCheckbox);
                
                if (socCheckbox) {
                    // Remove any existing listeners
                    socCheckbox.removeEventListener('change', handleCheckboxChange);
                    socCheckbox.addEventListener('change', handleCheckboxChange);
                    console.log('✅ Direct listener attached to SOC checkbox');
                } else {
                    console.log('❌ SOC checkbox not found, retrying...');
                }
                
                // Attach to all checkboxes as backup
                const allCheckboxes = document.querySelectorAll('.course-checkbox');
                console.log('📋 Total checkboxes found:', allCheckboxes.length);
                
                allCheckboxes.forEach((cb, i) => {
                    cb.removeEventListener('change', handleCheckboxChange);
                    cb.addEventListener('change', handleCheckboxChange);
                    console.log(`🔗 Listener attached to checkbox ${i}`);
                });
            }
            
            // APPROACH 2: Global event delegation as backup
            document.addEventListener('change', function(e) {
                if (e.target.classList.contains('course-checkbox')) {
                    console.log('🌐 Global delegation caught checkbox change');
                    handleCheckboxChange(e);
                }
            });
            
            // APPROACH 3: Polling as ultimate backup
            let pollCount = 0;
            const pollInterval = setInterval(() => {
                pollCount++;
                const socCheckbox = document.querySelector('[data-course="soc-analyst"] .course-checkbox');
                if (socCheckbox && socCheckbox.checked) {
                    console.log('🔄 Polling detected checked SOC checkbox!');
                    handleCheckboxChange({ target: socCheckbox });
                    clearInterval(pollInterval);
                }
                if (pollCount > 20) clearInterval(pollInterval); // Stop after 10 seconds
            }, 500);
            
            // Try attaching listeners multiple times
            attachListeners();
            setTimeout(attachListeners, 500);
            setTimeout(attachListeners, 1000);
            setTimeout(attachListeners, 2000);
            
            // Add test button and immediate workaround
            setTimeout(() => {
                addTestButton();
                addImmediateWorkaround();
                addDebugInspector();
            }, 1500);
        }
        
        function handleCheckboxChange(event) {
            console.log('🚨 CHECKBOX CHANGE DETECTED!', event.target.checked);
            const courseCard = event.target.closest('.course-selection');
            console.log('📋 Course card found:', courseCard?.dataset?.course);
            
            // Force immediate cart update
            updateCartTotal();
            
            // Also try direct DOM manipulation as backup
            if (event.target.checked && courseCard?.dataset?.course === 'soc-analyst') {
                console.log('🔥 DIRECT UPDATE: SOC Analyst selected!');
                forceCartUpdate();
            }
        }
        
        function forceCartUpdate() {
            console.log('🔥 FORCING cart update with direct DOM manipulation...');
            
            // Direct DOM updates
            const cartItems = document.getElementById('cart-items');
            const totalElement = document.getElementById('total-price');
            const paymentSelector = document.getElementById('payment-plan-selector');
            const paymentButtons = document.getElementById('payment-buttons-container');
            const noCoursesMessage = document.getElementById('no-courses-message');
            
            if (cartItems) {
                cartItems.innerHTML = `
                    <div class="flex justify-between items-center py-2">
                        <span class="text-white">SOC Analyst Foundations</span>
                        <span class="text-blue-400 font-semibold">Selected</span>
                    </div>
                `;
                console.log('✅ Cart items updated');
            }
            
            if (totalElement) {
                totalElement.textContent = '$2,849';
                console.log('✅ Total updated');
            }
            
            if (noCoursesMessage) {
                noCoursesMessage.style.display = 'none';
                console.log('✅ No courses message hidden');
            }
            
            if (paymentSelector) {
                paymentSelector.classList.remove('hidden');
                console.log('✅ Payment selector shown');
            }
            
            if (paymentButtons) {
                paymentButtons.classList.remove('hidden');
                console.log('✅ Payment buttons shown');
            }
        }
                    
                    // Check the checkbox
                    const socCheckbox = document.querySelector('[data-course="soc-analyst"] .course-checkbox');
                    if (socCheckbox) {
                        socCheckbox.checked = true;
                        console.log('✅ SOC checkbox manually checked');
                    }
                    
                    // Force update
                    forceCartUpdate();
                };
                cartSection.appendChild(testButton);
                console.log('🧪 Test button added');
            }
        }
        
        function addImmediateWorkaround() {
            console.log('🚨 Adding immediate workaround...');
            
            // Add click listener to the entire SOC course card
            const socCourseCard = document.querySelector('[data-course="soc-analyst"]');
            if (socCourseCard) {
                console.log('✅ SOC course card found');
                
                // Make entire card clickable
                socCourseCard.style.cursor = 'pointer';
                socCourseCard.addEventListener('click', function(e) {
                    console.log('🎯 SOC CARD CLICKED!');
                    
                    // Find checkbox within this card
                    const checkbox = this.querySelector('.course-checkbox');
                    if (checkbox) {
                        // Toggle checkbox if not already the target
                        if (e.target !== checkbox) {
                            checkbox.checked = !checkbox.checked;
                            console.log('✅ Checkbox toggled to:', checkbox.checked);
                        }
                        
                        // Force immediate update
                        if (checkbox.checked) {
                            console.log('🔥 IMMEDIATELY updating cart...');
                            forceCartUpdate();
                        } else {
                            // Reset cart
                            resetCart();
                        }
                    }
                });
                
                console.log('✅ Click listener added to entire SOC card');
            }
            
            // Also add a prominent "SELECT SOC ANALYST" button
            const socCard = document.querySelector('[data-course="soc-analyst"]');
            if (socCard && !socCard.querySelector('.select-button')) {
                const selectButton = document.createElement('button');
                selectButton.className = 'select-button w-full mt-4 bg-green-600 text-white py-2 px-4 rounded-lg font-semibold hover:bg-green-700 transition';
                selectButton.textContent = '✅ SELECT THIS COURSE';
                selectButton.onclick = (e) => {
                    e.stopPropagation();
                    console.log('🎯 SELECT BUTTON CLICKED!');
                    
                    const checkbox = socCard.querySelector('.course-checkbox');
                    if (checkbox) {
                        checkbox.checked = true;
                        forceCartUpdate();
                        selectButton.textContent = '✅ SELECTED!';
                        selectButton.className = selectButton.className.replace('bg-green-600 hover:bg-green-700', 'bg-blue-600');
                    }
                };
                
                socCard.appendChild(selectButton);
                console.log('✅ SELECT button added to SOC card');
            }
        }
        
        function resetCart() {
            console.log('🔄 Resetting cart...');
            const cartItems = document.getElementById('cart-items');
            const totalElement = document.getElementById('total-price');
            const paymentSelector = document.getElementById('payment-plan-selector');
            const paymentButtons = document.getElementById('payment-buttons-container');
            const noCoursesMessage = document.getElementById('no-courses-message');
            
            if (cartItems) cartItems.innerHTML = '<p id="no-courses-message" class="text-gray-400">Select SOC Analyst course below to see pricing</p>';
            if (totalElement) totalElement.textContent = '$0';
            if (paymentSelector) paymentSelector.classList.add('hidden');
            if (paymentButtons) paymentButtons.classList.add('hidden');
            if (noCoursesMessage) noCoursesMessage.style.display = 'block';
        }
        
        function addDebugInspector() {
            console.log('🔍 DEBUGGING: DOM Inspector...');
            
            // Log all course cards
            const courseCards = document.querySelectorAll('.course-selection');
            console.log('📋 Total course cards found:', courseCards.length);
            
            courseCards.forEach((card, i) => {
                const checkbox = card.querySelector('.course-checkbox');
                const courseName = card.querySelector('h3')?.textContent;
                const courseId = card.dataset.course;
                
                console.log(`📋 Card ${i}:`, {
                    courseName: courseName,
                    courseId: courseId,
                    hasCheckbox: !!checkbox,
                    checkboxChecked: checkbox?.checked
                });
            });
            
            // Log cart elements
            console.log('🛒 Cart elements:');
            console.log('  - cart-items:', !!document.getElementById('cart-items'));
            console.log('  - total-price:', !!document.getElementById('total-price'));
            console.log('  - payment-plan-selector:', !!document.getElementById('payment-plan-selector'));
            console.log('  - payment-buttons-container:', !!document.getElementById('payment-buttons-container'));
            console.log('  - no-courses-message:', !!document.getElementById('no-courses-message'));
            
            // Add window debug function
            window.debugTechStep = function() {
                console.log('🔧 Manual Debug Trigger');
                const socCheckbox = document.querySelector('[data-course="soc-analyst"] .course-checkbox');
                console.log('SOC checkbox found:', !!socCheckbox);
                console.log('SOC checkbox checked:', socCheckbox?.checked);
                
                if (socCheckbox) {
                    socCheckbox.checked = true;
                    forceCartUpdate();
                    console.log('✅ Forced SOC selection');
                }
            };
            
            console.log('🧪 Added window.debugTechStep() function - call this in console to force selection');
        }
        
        // Stripe Payment Integration (removed duplicate - using the enhanced version below)
        
        function setupStripe() {
            // Initialize Stripe with test key for development
            try {
                stripe = Stripe('pk_test_51RwDF3HTfrREHzBzMxKImvpXUSlamCz990lkgAxIzZeLrdsDouon9Uq8RyOKtvwR0OC8zjWHdUgpb9freiqlrzo300uyTp6tMx');
                console.log('✅ Stripe initialized successfully');
                
                // Setup payment plan interactivity
                setupPaymentPlanSelection();
                
                // Update payment buttons
                updatePaymentButtons();
                
            } catch (error) {
                console.error('❌ Stripe initialization failed:', error);
                // Fallback for payment demo mode
                updatePaymentButtons(false);
            }
        }
        
        function setupPaymentPlanSelection() {
            const paymentPlanRadios = document.querySelectorAll('input[name="payment-plan"]');
            const paymentCards = document.querySelectorAll('.payment-option-card');
            
            paymentPlanRadios.forEach((radio, index) => {
                radio.addEventListener('change', () => {
                    // Update UI to show selected plan
                    paymentCards.forEach((card, cardIndex) => {
                        const checkIcon = card.querySelector('.option-check');
                        if (cardIndex === index && radio.checked) {
                            card.classList.remove('border-gray-600', 'bg-gray-800');
                            card.classList.add('border-blue-500', 'bg-blue-900');
                            if (checkIcon) checkIcon.classList.remove('opacity-0');
                        } else if (cardIndex !== 0) { // Keep first option (full pay) always highlighted if not selected
                            card.classList.add('border-gray-600', 'bg-gray-800');
                            card.classList.remove('border-blue-500', 'bg-blue-900');
                            if (checkIcon) checkIcon.classList.add('opacity-0');
                        }
                    });
                    
                    // Update total and payment buttons
                    updateCartTotal();
                });
            });
        }
        
        function updatePaymentButtons(stripeEnabled = true) {
            const paymentContainer = document.getElementById('payment-buttons-container');
            if (!paymentContainer) {
                console.warn('Payment buttons container not found');
                return;
            }
            
            // Replace existing payment buttons with new Stripe-integrated ones
            if (stripeEnabled) {
                paymentContainer.innerHTML = `
                    <div class="space-y-3">
                        <button id="stripe-checkout-button" class="w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-4 px-6 rounded-lg transition duration-300 flex items-center justify-center disabled:opacity-50" disabled>
                            <i class="fas fa-credit-card mr-2"></i>
                            <span id="stripe-button-text">Select a Course to Continue</span>
                        </button>
                        
                        <div class="text-center">
                            <div class="flex items-center justify-center space-x-4 text-sm text-gray-400">
                                <span><i class="fab fa-cc-visa text-lg"></i></span>
                                <span><i class="fab fa-cc-mastercard text-lg"></i></span>
                                <span><i class="fab fa-cc-amex text-lg"></i></span>
                                <span><i class="fab fa-apple-pay text-lg"></i></span>
                                <span><i class="fab fa-google-pay text-lg"></i></span>
                            </div>
                            <p class="text-xs text-gray-500 mt-2">🔒 256-bit SSL encryption • PCI DSS compliant • Powered by Stripe</p>
                        </div>
                    </div>
                `;
                
                // Setup checkout button click handler after DOM update
                setTimeout(() => {
                    const checkoutButton = document.getElementById('stripe-checkout-button');
                    if (checkoutButton) {
                        checkoutButton.addEventListener('click', handleStripeCheckout);
                        console.log('✅ Stripe checkout button initialized');
                    }
                }, 100);
            } else {
                // Fallback for demo mode
                paymentContainer.innerHTML = `
                    <div class="space-y-3">
                        <button class="w-full bg-gray-600 text-white font-bold py-4 px-6 rounded-lg cursor-not-allowed" disabled>
                            <i class="fas fa-exclamation-triangle mr-2"></i>
                            Payment Demo Mode - Stripe Not Available
                        </button>
                        <p class="text-xs text-gray-500 text-center">In production, secure payment processing will be available</p>
                    </div>
                `;
            }
        }
        
        async function handleStripeCheckout() {
            console.log('💳 Starting Stripe checkout process...');
            console.log('Selected courses:', selectedCourses);
            
            // Check if we have Stripe initialized
            if (!stripe) {
                console.error('❌ Stripe not initialized');
                alert('Payment system not available. Please refresh the page and try again.');
                return;
            }
            
            // Check if courses are selected using our global selectedCourses array
            if (selectedCourses.length === 0) {
                alert('Please select a course to continue with payment.');
                return;
            }
            
            // Check payment plan selection
            const paymentPlan = document.querySelector('input[name="payment-plan"]:checked')?.value || 'full';
            console.log('📅 Selected payment plan:', paymentPlan);
            
            // Check agreement checkbox
            const agreementCheckbox = document.getElementById('payment-agreement');
            if (!agreementCheckbox || !agreementCheckbox.checked) {
                alert('Please agree to the Terms of Service and Payment Terms to continue.');
                if (agreementCheckbox) agreementCheckbox.focus();
                return;
            }
            
            // Get the first (and only) selected course
            const course = selectedCourses[0];
            console.log('🎯 Course for checkout:', course);
            
            try {
                const button = document.getElementById('stripe-checkout-button');
                button.disabled = true;
                button.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Processing...';
                
                // Define success and cancel URLs
                let successUrl, cancelUrl;
                if (course.id === 'soc-analyst') {
                    successUrl = 'https://techstepfoundation.org/onboarding/soc-analyst';
                } else {
                    successUrl = 'https://techstepfoundation.org/onboarding/success';
                }
                cancelUrl = 'https://techstepfoundation.org/';
                
                // Calculate final price based on payment plan
                let finalPrice, mode, lineItems;
                
                if (paymentPlan === 'full') {
                    // Full payment with 5% discount for SOC Analyst
                    if (course.id === 'soc-analyst') {
                        finalPrice = 2849; // Fixed discounted price
                    } else {
                        finalPrice = Math.round(course.selfPrice * 0.95);
                    }
                    
                    mode = 'payment';
                    lineItems = [{
                        price_data: {
                            currency: 'usd',
                            product_data: {
                                name: course.name,
                                description: 'TechStep Foundation Course - Full Payment (5% Discount Applied)'
                            },
                            unit_amount: finalPrice * 100 // Convert to cents
                        },
                        quantity: 1
                    }];
                } else if (paymentPlan === 'monthly') {
                    // Monthly plan: down payment + subscription
                    const downPayment = course.id === 'soc-analyst' ? 750 : Math.round(course.selfPrice * 0.25);
                    
                    mode = 'payment';
                    lineItems = [{
                        price_data: {
                            currency: 'usd',
                            product_data: {
                                name: `${course.name} - Down Payment`,
                                description: 'Initial payment for monthly plan. Recurring payments will be set up separately.'
                            },
                            unit_amount: downPayment * 100
                        },
                        quantity: 1
                    }];
                }
                
                console.log('🚀 Creating Stripe checkout session:', { mode, lineItems, finalPrice });
                
                // Create Stripe Checkout Session
                const { error } = await stripe.redirectToCheckout({
                    lineItems: lineItems,
                    mode: mode,
                    successUrl: successUrl + '?session_id={CHECKOUT_SESSION_ID}',
                    cancelUrl: cancelUrl,
                    customerEmail: null, // Will be collected at checkout
                    billingAddressCollection: 'auto',
                    paymentMethodTypes: ['card'],
                    metadata: {
                        courseId: course.id,
                        courseName: course.name,
                        paymentPlan: paymentPlan,
                        source: 'techstep-website',
                        originalPrice: course.selfPrice.toString(),
                        finalPrice: (finalPrice || 'subscription').toString()
                    }
                });
                
                if (error) {
                    console.error('❌ Stripe Checkout error:', error);
                    alert('Payment initialization failed: ' + error.message);
                }
                
            } catch (error) {
                console.error('❌ Checkout error:', error);
                alert('Payment processing error: ' + error.message);
            } finally {
                // Reset button state
                const button = document.getElementById('stripe-checkout-button');
                if (button) {
                    button.disabled = false;
                    const buttonText = document.getElementById('stripe-button-text');
                    if (buttonText && selectedCourses.length > 0) {
                        buttonText.textContent = `Complete Purchase - ${selectedCourses[0].name}`;
                    }
                }
            }
        }
        
        async function createMonthlyPlanCheckout(course, successUrl, cancelUrl) {
            try {
                // For the monthly plan, we need to create a more complex checkout
                // This would typically require a backend endpoint to create the session
                // For now, we'll redirect to Stripe Checkout with the down payment
                // and handle the subscription setup in webhooks
                
                const downPaymentPriceId = course.dataset.stripeDownPrice; // price_1S5j8SHdhxmQz9FjK5KQc0HG
                const monthlyPriceId = course.dataset.stripeMonthlyPrice; // price_1S5j8SHdhxmQz9FjxZR4DjJS
                
                // Create checkout session with down payment and subscription
                const { error } = await stripe.redirectToCheckout({
                    lineItems: [
                        {
                            price: downPaymentPriceId, // $750 down payment
                            quantity: 1,
                        },
                        {
                            price: monthlyPriceId, // $375/month for 6 cycles
                            quantity: 1,
                        }
                    ],
                    mode: 'subscription',
                    successUrl: successUrl + '?session_id={CHECKOUT_SESSION_ID}&plan=monthly',
                    cancelUrl: cancelUrl,
                    customerEmail: null,
                    billingAddressCollection: 'auto',
                    paymentMethodTypes: ['card', 'apple_pay', 'google_pay'],
                    subscriptionData: {
                        metadata: {
                            course: 'soc-analyst-foundations',
                            paymentPlan: 'monthly',
                            source: 'techstep-website',
                            downPayment: '750',
                            monthlyAmount: '375',
                            totalCycles: '6'
                        }
                    }
                });
                
                if (error) {
                    throw error;
                }
                
            } catch (error) {
                console.error('Monthly plan checkout error:', error);
                alert('Monthly plan setup failed. Please try again or contact support@techstepfoundation.org');
                throw error;
            }
        }
        
        function getSelectedCourses() {
            console.log('🔍 Getting selected courses...');
            const allCheckboxes = document.querySelectorAll('.course-checkbox');
            const checkedBoxes = document.querySelectorAll('.course-checkbox:checked');
            
            console.log('📊 Checkbox stats:', {
                total: allCheckboxes.length,
                checked: checkedBoxes.length
            });
            
            allCheckboxes.forEach((cb, i) => {
                const courseCard = cb.closest('.course-selection');
                console.log(`  📋 Checkbox ${i}:`, {
                    checked: cb.checked,
                    course: courseCard?.dataset?.course || 'unknown'
                });
            });
            
            const selectedCourses = Array.from(checkedBoxes).map(checkbox => {
                const courseCard = checkbox.closest('.course-selection');
                console.log('✅ Found selected course card:', courseCard?.dataset?.course || 'none');
                return courseCard;
            }).filter(course => course !== null);
            
            console.log('🎯 Total selected courses:', selectedCourses.length);
            return selectedCourses;
        }
        
        function updateStripeButtonText() {
            const selectedCourses = getSelectedCourses();
            const paymentPlan = document.querySelector('input[name="payment-plan"]:checked')?.value || 'full';
            const agreementCheckbox = document.getElementById('payment-agreement');
            const button = document.getElementById('stripe-checkout-button');
            const buttonText = document.getElementById('stripe-button-text');
            
            if (!button || !buttonText) return;
            
            if (selectedCourses.length === 0) {
                button.disabled = true;
                buttonText.textContent = 'Select SOC Analyst Course to Continue';
                return;
            }
            
            // Check if SOC Analyst is selected (only course with Stripe integration)
            const socCourse = selectedCourses.find(course => course.dataset.course === 'soc-analyst');
            if (!socCourse) {
                button.disabled = true;
                buttonText.textContent = 'Stripe Available for SOC Analyst Only';
                return;
            }
            
            // Check if agreement is checked
            if (!agreementCheckbox || !agreementCheckbox.checked) {
                button.disabled = true;
                buttonText.textContent = 'Accept Agreement to Continue';
                return;
            }
            
            button.disabled = false;
            
            if (paymentPlan === 'full') {
                buttonText.textContent = 'Pay $2,849 Now - Best Value 🚀';
            } else if (paymentPlan === 'monthly') {
                buttonText.textContent = 'Start Today - $750 Down Payment 💳';
            }
        }
        
        // SIMPLIFIED updateCartTotal function
        function updateCartTotal() {
            console.log('🔄 updateCartTotal called');
            
            // Get elements with error checking
            const totalElement = document.getElementById('total-price');
            const paymentSelector = document.getElementById('payment-plan-selector');
            const paymentButtons = document.getElementById('payment-buttons-container');
            const cartItems = document.getElementById('cart-items');
            const noCoursesMessage = document.getElementById('no-courses-message');
            
            console.log('🔍 Elements found:', {
                totalElement: !!totalElement,
                paymentSelector: !!paymentSelector,
                paymentButtons: !!paymentButtons,
                cartItems: !!cartItems,
                noCoursesMessage: !!noCoursesMessage
            });
            
            // Check for SOC Analyst selection directly
            const socCheckbox = document.querySelector('[data-course="soc-analyst"] .course-checkbox');
            const isSocSelected = socCheckbox?.checked || false;
            
            console.log('🎯 SOC Analyst status:', {
                checkboxFound: !!socCheckbox,
                isChecked: isSocSelected
            });
            
            if (!isSocSelected) {
                // No courses selected
                console.log('❌ No courses selected - hiding payment options');
                if (totalElement) totalElement.textContent = '$0';
                if (paymentSelector) paymentSelector.classList.add('hidden');
                if (paymentButtons) paymentButtons.classList.add('hidden');
                if (noCoursesMessage) noCoursesMessage.style.display = 'block';
                return;
            }
            
            // SOC Analyst is selected
            console.log('✅ SOC Analyst selected - showing payment options');
            
            // Hide "no courses" message
            if (noCoursesMessage) {
                noCoursesMessage.style.display = 'none';
                console.log('✅ Hidden no-courses message');
            }
            
            // Show payment options
            if (paymentSelector) {
                paymentSelector.classList.remove('hidden');
                console.log('✅ Showed payment selector');
            }
            if (paymentButtons) {
                paymentButtons.classList.remove('hidden');
                console.log('✅ Showed payment buttons');
            }
            
            // Update cart items
            if (cartItems) {
                cartItems.innerHTML = `
                    <div class="flex justify-between items-center py-2">
                        <span class="text-white">SOC Analyst Foundations</span>
                        <span class="text-blue-400 font-semibold">Selected</span>
                    </div>
                `;
                console.log('✅ Updated cart items');
            }
            
            // Update total based on payment plan
            const paymentPlan = document.querySelector('input[name="payment-plan"]:checked')?.value || 'full';
            if (totalElement) {
                if (paymentPlan === 'full') {
                    totalElement.textContent = '$2,849';
                } else if (paymentPlan === 'monthly') {
                    totalElement.textContent = '$750 down + $375/mo';
                }
                console.log('✅ Updated total:', totalElement.textContent);
            }
            
            // Update Stripe button
            updateStripeButtonText();
            console.log('🚀 Cart update complete!');
        }
        
        // Demo Completion Modal and Enrollment Flow
        function showDemoCompletionModal() {
            const modalHTML = `
                <div id="demo-completion-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
                    <div class="bg-gray-800 border border-gray-700 rounded-lg max-w-md w-full mx-4 p-6">
                        <div class="text-center">
                            <div class="w-16 h-16 bg-green-600 rounded-full flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-check text-white text-2xl"></i>
                            </div>
                            <h3 class="text-xl font-bold text-white mb-2">Demo Complete!</h3>
                            <p class="text-gray-300 mb-6">Great job completing the knowledge check. Ready for the full experience?</p>
                            
                            <div class="space-y-3">
                                <button onclick="continueToEnrollment()" class="w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                                    <i class="fas fa-arrow-right mr-2"></i>Continue My Journey
                                </button>
                                <button onclick="closeDemoModal()" class="w-full border border-gray-600 text-gray-300 hover:text-white hover:bg-gray-700 font-medium py-3 px-6 rounded-lg transition duration-300">
                                    Maybe Later
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            
            // Analytics event
            if (typeof gtag !== 'undefined') {
                gtag('event', 'demo_complete', {
                    event_category: 'engagement',
                    event_label: 'demo_completion'
                });
            }
            
            // Show modal with animation
            setTimeout(() => {
                const modal = document.getElementById('demo-completion-modal');
                if (modal) {
                    modal.classList.add('opacity-100');
                }
            }, 100);
        }
        
        function continueToEnrollment() {
            // Analytics event
            if (typeof gtag !== 'undefined') {
                gtag('event', 'enroll_clicked', {
                    event_category: 'conversion',
                    event_label: 'demo_to_enrollment'
                });
            }
            
            closeDemoModal();
            
            // Scroll to enrollment section
            const enrollmentSection = document.getElementById('courses-section');
            if (enrollmentSection) {
                enrollmentSection.scrollIntoView({ behavior: 'smooth' });
            }
            
            // Auto-select SOC Analyst course for demo users
            setTimeout(() => {
                const socButton = document.querySelector('[data-course="soc-analyst"] .enroll-btn');
                if (socButton) {
                    socButton.click();
                }
            }, 1000);
        }
        
        function closeDemoModal() {
            const modal = document.getElementById('demo-completion-modal');
            if (modal) {
                modal.remove();
            }
        }
        
        // Enrollment Flow Functions
        function startEnrollment(courseId, courseName, price) {
            console.log('🎓 Starting enrollment for:', courseName);
            
            // Analytics event
            if (typeof gtag !== 'undefined') {
                gtag('event', 'enrollment_start', {
                    event_category: 'conversion',
                    course_name: courseName,
                    course_price: price
                });
            }
            
            showRegistrationForm(courseId, courseName, price);
        }
        
        function showRegistrationForm(courseId, courseName, price) {
            const registrationHTML = `
                <div id="registration-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
                    <div class="bg-gray-800 border border-gray-700 rounded-lg max-w-lg w-full mx-4 p-6 max-h-[90vh] overflow-y-auto sm:p-6 p-4">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-2xl font-bold text-blue-400">Start Your Journey</h3>
                            <button onclick="closeRegistrationModal()" class="text-gray-400 hover:text-white text-2xl">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <div class="mb-6 p-4 bg-gray-700 rounded-lg">
                            <h4 class="text-white font-semibold">${courseName}</h4>
                            <p class="text-gray-300 text-sm">Starting at $${price.toLocaleString()}</p>
                        </div>
                        
                        <form id="registration-form" class="space-y-4">
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-gray-300 text-sm font-medium mb-2">First Name *</label>
                                    <input type="text" name="firstName" required class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                                <div>
                                    <label class="block text-gray-300 text-sm font-medium mb-2">Last Name *</label>
                                    <input type="text" name="lastName" required class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-gray-300 text-sm font-medium mb-2">Email Address *</label>
                                <input type="email" name="email" required class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            
                            <div>
                                <label class="block text-gray-300 text-sm font-medium mb-2">Phone Number</label>
                                <input type="tel" name="phone" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            
                            <div class="flex items-start space-x-3">
                                <input type="checkbox" id="email-consent" name="emailConsent" required class="mt-1 w-5 h-5 text-blue-600">
                                <label for="email-consent" class="text-sm text-gray-300">
                                    I agree to receive course updates and educational content via email. I can unsubscribe at any time. *
                                </label>
                            </div>
                            
                            <div class="text-center p-3 bg-gray-700 border border-gray-600 rounded-lg">
                                <p class="text-xs text-gray-400 mb-1">Questions about enrollment?</p>
                                <a href="mailto:support@techstepfoundation.org" class="text-blue-400 hover:text-blue-300 text-sm font-medium">
                                    <i class="fas fa-envelope mr-1"></i>support@techstepfoundation.org
                                </a>
                            </div>
                            
                            <div class="flex space-x-3">
                                <button type="button" onclick="closeRegistrationModal()" class="flex-1 border border-gray-600 text-gray-300 hover:text-white hover:bg-gray-700 font-medium py-3 px-6 rounded-lg transition duration-300">
                                    Cancel
                                </button>
                                <button type="submit" class="flex-1 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                                    Continue to Order Summary
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', registrationHTML);
            
            // Add form submit handler
            document.getElementById('registration-form').addEventListener('submit', (e) => {
                e.preventDefault();
                
                // Analytics event
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'registration_submit', {
                        event_category: 'conversion',
                        course_name: courseName
                    });
                }
                
                const formData = new FormData(e.target);
                const userData = {
                    firstName: formData.get('firstName'),
                    lastName: formData.get('lastName'),
                    email: formData.get('email'),
                    phone: formData.get('phone'),
                    emailConsent: formData.get('emailConsent') === 'on'
                };
                
                closeRegistrationModal();
                showOrderSummary(courseId, courseName, price, userData);
            });
        }
        
        function closeRegistrationModal() {
            const modal = document.getElementById('registration-modal');
            if (modal) {
                modal.remove();
            }
        }
        
        function showOrderSummary(courseId, courseName, price, userData) {
            const orderHTML = `
                <div id="order-summary-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
                    <div class="bg-gray-800 border border-gray-700 rounded-lg max-w-lg w-full mx-4 p-6 sm:p-6 p-4">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-2xl font-bold text-blue-400">Order Summary</h3>
                            <button onclick="closeOrderSummary()" class="text-gray-400 hover:text-white text-2xl">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <div class="space-y-6">
                            <!-- Course Details -->
                            <div class="bg-gray-700 rounded-lg p-4">
                                <h4 class="text-white font-semibold mb-2">${courseName}</h4>
                                <div class="text-gray-300 text-sm space-y-1">
                                    <p>• Live mentorship sessions</p>
                                    <p>• Interactive lab exercises</p>
                                    <p>• Career placement assistance</p>
                                    <p>• Industry certifications prep</p>
                                </div>
                            </div>
                            
                            <!-- Student Info -->
                            <div class="bg-gray-700 rounded-lg p-4">
                                <h5 class="text-white font-medium mb-2">Student Information</h5>
                                <p class="text-gray-300 text-sm">${userData.firstName} ${userData.lastName}</p>
                                <p class="text-gray-300 text-sm">${userData.email}</p>
                            </div>
                            
                            <!-- Payment Plans -->
                            <div class="space-y-3">
                                <h5 class="text-white font-medium">Select Payment Plan</h5>
                                
                                <label class="flex items-center space-x-3 p-4 border border-gray-600 rounded-lg cursor-pointer hover:border-blue-500 transition duration-300">
                                    <input type="radio" name="order-payment-plan" value="full" checked class="text-blue-600">
                                    <div class="flex-1">
                                        <div class="text-white font-medium">Pay Once (Save 5%)</div>
                                        <div class="text-2xl font-bold text-green-400">$${Math.round(price * 0.95).toLocaleString()}</div>
                                        <div class="text-gray-400 text-sm">One-time payment</div>
                                    </div>
                                </label>
                                
                                <label class="flex items-center space-x-3 p-4 border border-gray-600 rounded-lg cursor-pointer hover:border-blue-500 transition duration-300">
                                    <input type="radio" name="order-payment-plan" value="monthly" class="text-blue-600">
                                    <div class="flex-1">
                                        <div class="text-white font-medium">Monthly Plan</div>
                                        <div class="text-2xl font-bold text-blue-400">$750 <span class="text-sm">down</span> + $375<span class="text-sm">/month</span></div>
                                        <div class="text-gray-400 text-sm">6-month payment plan</div>
                                    </div>
                                </label>
                            </div>
                            
                            <!-- Support Contact -->
                            <div class="text-center p-3 bg-gray-700 border border-gray-600 rounded-lg">
                                <p class="text-xs text-gray-400 mb-1">Questions before checkout?</p>
                                <a href="mailto:support@techstepfoundation.org" class="text-blue-400 hover:text-blue-300 text-sm font-medium">
                                    <i class="fas fa-envelope mr-1"></i>support@techstepfoundation.org
                                </a>
                            </div>
                            
                            <!-- Legal Links -->
                            <div class="text-center text-xs text-gray-400 space-x-4">
                                <a href="#" onclick="showPaymentTerms()" class="hover:text-blue-400 underline">Payment Terms</a>
                                <a href="#" onclick="showPrivacyPolicy()" class="hover:text-blue-400 underline">Privacy Policy</a>
                            </div>
                            
                            <!-- Action Buttons -->
                            <div class="flex space-x-3">
                                <button type="button" onclick="closeOrderSummary()" class="flex-1 border border-gray-600 text-gray-300 hover:text-white hover:bg-gray-700 font-medium py-3 px-6 rounded-lg transition duration-300">
                                    Back
                                </button>
                                <button type="button" onclick="proceedToCheckout('${courseId}', '${courseName}', ${price}, '${JSON.stringify(userData).replace(/'/g, "&apos;")}')" class="flex-1 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                                    Secure Checkout
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', orderHTML);
            
            // Analytics event
            if (typeof gtag !== 'undefined') {
                gtag('event', 'order_summary_view', {
                    event_category: 'conversion',
                    course_name: courseName,
                    value: price
                });
            }
        }
        
        function closeOrderSummary() {
            const modal = document.getElementById('order-summary-modal');
            if (modal) {
                modal.remove();
            }
        }
        
        function proceedToCheckout(courseId, courseName, price, userDataStr) {
            const userData = JSON.parse(userDataStr);
            const paymentPlan = document.querySelector('input[name="order-payment-plan"]:checked')?.value || 'full';
            
            // Analytics event
            if (typeof gtag !== 'undefined') {
                gtag('event', 'checkout_start', {
                    event_category: 'conversion',
                    course_name: courseName,
                    payment_plan: paymentPlan,
                    value: price
                });
            }
            
            closeOrderSummary();
            
            // Use existing Stripe checkout flow
            if (stripe) {
                handleStripeCheckout();
            } else {
                alert('Payment system is initializing. Please wait a moment and try again.');
            }
        }
        
        // Legal modals
        function showPaymentTerms() {
            const modalHTML = `
                <div id="payment-terms-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
                    <div class="bg-gray-800 border border-gray-700 rounded-lg max-w-2xl w-full mx-4 p-6 max-h-[80vh] overflow-y-auto">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-2xl font-bold text-blue-400">Payment Terms</h3>
                            <button onclick="closePaymentTerms()" class="text-gray-400 hover:text-white text-2xl">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <div class="text-gray-300 space-y-4">
                            <h4 class="text-white font-semibold">Payment Policy</h4>
                            <p>All payments are processed securely through Stripe and are subject to the following terms:</p>
                            
                            <h5 class="text-white font-medium">Full Payment Option</h5>
                            <ul class="list-disc list-inside space-y-1 text-sm">
                                <li>5% discount applied to total course price</li>
                                <li>Immediate access to all course materials</li>
                                <li>Full mentorship program included</li>
                            </ul>
                            
                            <h5 class="text-white font-medium">Monthly Payment Plan</h5>
                            <ul class="list-disc list-inside space-y-1 text-sm">
                                <li>$750 down payment required</li>
                                <li>$375/month for 6 months</li>
                                <li>Access granted after down payment</li>
                                <li>Automatic billing on same date monthly</li>
                            </ul>
                            
                            <h5 class="text-white font-medium">Refund Policy</h5>
                            <p class="text-sm">7-day money-back guarantee from enrollment date. Contact <a href="mailto:support@techstepfoundation.org" class="text-blue-400 hover:underline">support@techstepfoundation.org</a> for refund requests.</p>
                            
                            <div class="text-center pt-4">
                                <button onclick="closePaymentTerms()" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg transition duration-300">
                                    Close
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }
        
        function closePaymentTerms() {
            const modal = document.getElementById('payment-terms-modal');
            if (modal) {
                modal.remove();
            }
        }
        
        function showPrivacyPolicy() {
            const modalHTML = `
                <div id="privacy-policy-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
                    <div class="bg-gray-800 border border-gray-700 rounded-lg max-w-2xl w-full mx-4 p-6 max-h-[80vh] overflow-y-auto">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-2xl font-bold text-blue-400">Privacy Policy</h3>
                            <button onclick="closePrivacyPolicy()" class="text-gray-400 hover:text-white text-2xl">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <div class="text-gray-300 space-y-4">
                            <h4 class="text-white font-semibold">Information We Collect</h4>
                            <p class="text-sm">We collect information you provide directly, including name, email, phone number, and payment information for course enrollment and delivery.</p>
                            
                            <h4 class="text-white font-semibold">How We Use Information</h4>
                            <ul class="list-disc list-inside space-y-1 text-sm">
                                <li>Provide course access and mentorship services</li>
                                <li>Send course updates and educational content</li>
                                <li>Process payments and manage subscriptions</li>
                                <li>Improve our services and user experience</li>
                            </ul>
                            
                            <h4 class="text-white font-semibold">Email Communications</h4>
                            <p class="text-sm">You may receive course-related updates, educational content, and service notifications. You can unsubscribe from marketing emails at any time using the link provided in each email.</p>
                            
                            <h4 class="text-white font-semibold">Data Security</h4>
                            <p class="text-sm">We use industry-standard security measures including SSL encryption and secure payment processing through Stripe. Your payment information is never stored on our servers.</p>
                            
                            <p class="text-sm">For questions, contact <a href="mailto:support@techstepfoundation.org" class="text-blue-400 hover:underline">support@techstepfoundation.org</a></p>
                            
                            <div class="text-center pt-4">
                                <button onclick="closePrivacyPolicy()" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg transition duration-300">
                                    Close
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }
        
        function closePrivacyPolicy() {
            const modal = document.getElementById('privacy-policy-modal');
            if (modal) {
                modal.remove();
            }
        }
        
        // Expose demo completion function globally for demo pages
        window.showDemoCompletionModal = showDemoCompletionModal;
        
    </script>
</body>
</html>






